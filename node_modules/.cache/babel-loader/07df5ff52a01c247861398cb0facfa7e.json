{"ast":null,"code":"import _toConsumableArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef,forwardRef,useImperativeHandle}from\"react\";import{Modal,Button}from\"react-bootstrap\";import Cookies from\"universal-cookie\";import{Spinner}from\"react-bootstrap\";import DividentView from\"./view.js\";import{Typeahead}from\"react-bootstrap-typeahead\";import StoreCreate from\"../store/create.js\";import Resizer from\"react-image-file-resizer\";import DatePicker from\"react-datepicker\";import{format}from\"date-fns\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var DividentCreate=/*#__PURE__*/forwardRef(function(props,ref){//Store Auto Suggestion\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedStores=_useState2[0],setSelectedStores=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isStoresLoading=_useState4[0],setIsStoresLoading=_useState4[1];useImperativeHandle(ref,function(){return{open:function open(id){formData={images_content:[]};setFormData({formData:formData});if(id){getDivident(id);}SetShow(true);}};});useEffect(function(){var listener=function listener(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){console.log(\"Enter key was pressed. Run your function-divident.\");// event.preventDefault();\nvar form=event.target.form;if(form&&event.target){var index=Array.prototype.indexOf.call(form,event.target);if(form&&form.elements[index+1]){if(event.target.getAttribute(\"class\").includes(\"description\")){form.elements[index].focus();form.elements[index].value+='\\r\\n';}else{form.elements[index+1].focus();}event.preventDefault();}}}};document.addEventListener(\"keydown\",listener);return function(){document.removeEventListener(\"keydown\",listener);};},[]);function resizeFIle(file,w,h,cb){Resizer.imageFileResizer(file,w,h,\"JPEG\",100,0,function(uri){cb(uri);},\"base64\");}var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),selectedImage=_useState6[0],setSelectedImage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),storeOptions=_useState8[0],setStoreOptions=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),selectedCategories=_useState10[0],setSelectedCategories=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),categoryOptions=_useState12[0],setCategoryOptions=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),errors=_useState14[0],setErrors=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isProcessing=_useState16[0],setProcessing=_useState16[1];var cookies=new Cookies();//fields\nvar _useState17=useState({images_content:[]}),_useState18=_slicedToArray(_useState17,2),formData=_useState18[0],setFormData=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),show=_useState20[0],SetShow=_useState20[1];function handleClose(){SetShow(false);}function getDivident(id){console.log(\"inside get Divident\");var requestOptions={method:'GET',headers:{'Content-Type':'application/json','Authorization':cookies.get('access_token')}};fetch('/v1/divident/'+id,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var _response$headers$get;var isJson,data,error,selectedWithdrawnByUsers,selectedStores;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isJson=(_response$headers$get=response.headers.get('content-type'))===null||_response$headers$get===void 0?void 0:_response$headers$get.includes('application/json');_context.t0=isJson;if(!_context.t0){_context.next=6;break;}_context.next=5;return response.json();case 5:_context.t0=_context.sent;case 6:data=_context.t0;if(response.ok){_context.next=10;break;}error=data&&data.errors;return _context.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});console.log(\"Response:\");console.log(data);formData=data.result;selectedWithdrawnByUsers=[{id:formData.withdrawn_by_user_id,name:formData.withdrawn_by_user_name}];setSelectedWithdrawnByUsers([].concat(selectedWithdrawnByUsers));selectedStores=[{id:formData.store_id,name:formData.store_name}];setSelectedStores([].concat(selectedStores));formData.images_content=[];setFormData(_objectSpread({},formData));case 20:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function suggestStores(_x2){return _suggestStores.apply(this,arguments);}function _suggestStores(){_suggestStores=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Inside handle suggest Stores\");console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context3.next=4;break;}return _context3.abrupt(\"return\");case 4:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";_context3.next=11;return fetch(\"/v1/store?\"+Select+queryString,requestOptions);case 11:result=_context3.sent;_context3.next=14;return result.json();case 14:data=_context3.sent;setStoreOptions(data.result);case 16:case\"end\":return _context3.stop();}}},_callee3);}));return _suggestStores.apply(this,arguments);}useEffect(function(){var at=cookies.get(\"access_token\");if(!at){window.location=\"/\";}});function ObjectToSearchQueryParams(object){return Object.keys(object).map(function(key){return\"search[\".concat(key,\"]=\").concat(object[key]);}).join(\"&\");}//WithdrawnByUser Auto Suggestion\nvar _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),withdrawnbyuserOptions=_useState22[0],setWithdrawnByUserOptions=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),selectedWithdrawnByUsers=_useState24[0],setSelectedWithdrawnByUsers=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),isWithdrawnByUsersLoading=_useState26[0],setIsWithdrawnByUsersLoading=_useState26[1];function suggestUsers(_x3){return _suggestUsers.apply(this,arguments);}function _suggestUsers(){_suggestUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"Inside handle suggestWithdrawnByUsers\");setWithdrawnByUserOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context4.next=5;break;}return _context4.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";setIsWithdrawnByUsersLoading(true);_context4.next=13;return fetch(\"/v1/user?\"+Select+queryString,requestOptions);case 13:result=_context4.sent;_context4.next=16;return result.json();case 16:data=_context4.sent;setWithdrawnByUserOptions(data.result);setIsWithdrawnByUsersLoading(false);case 19:case\"end\":return _context4.stop();}}},_callee4);}));return _suggestUsers.apply(this,arguments);}function handleCreate(event){event.preventDefault();console.log(\"Inside handle Create\");if(cookies.get(\"store_id\")){formData.store_id=cookies.get(\"store_id\");}var endPoint=\"/v1/divident\";var method=\"POST\";if(formData.id){endPoint=\"/v1/divident/\"+formData.id;method=\"PUT\";}var requestOptions={method:method,headers:{'Accept':'application/json',\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")},body:JSON.stringify(formData)};console.log(\"formData:\",formData);setProcessing(true);fetch(endPoint,requestOptions).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var _response$headers$get2;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isJson=(_response$headers$get2=response.headers.get(\"content-type\"))===null||_response$headers$get2===void 0?void 0:_response$headers$get2.includes(\"application/json\");_context2.t0=isJson;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return response.json();case 5:_context2.t0=_context2.sent;case 6:data=_context2.t0;if(response.ok){_context2.next=10;break;}// get error message from body or default to response status\nerror=data&&data.errors;//const error = data.errors\nreturn _context2.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});setProcessing(false);console.log(\"Response:\");console.log(data);props.showToastMessage(\"Divident Created Successfully!\",\"success\");if(props.refreshList){props.refreshList();}handleClose();if(props.openDetailsView){props.openDetailsView(data.result.id);}case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x4){return _ref2.apply(this,arguments);};}()).catch(function(error){setProcessing(false);console.log(\"Inside catch\");console.log(error);setErrors(_objectSpread({},error));console.error(\"There was an error!\",error);props.showToastMessage(\"Error Creating Divident!\",\"danger\");});}function getTargetDimension(originaleWidth,originalHeight,targetWidth,targetHeight){var ratio=parseFloat(originaleWidth/originalHeight);targetWidth=parseInt(targetHeight*ratio);targetHeight=parseInt(targetWidth*ratio);return{targetWidth:targetWidth,targetHeight:targetHeight};}/*\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        console.log(\"id:\", id);\n        DetailsViewRef.current.open(id);\n    }\n    */var StoreCreateFormRef=useRef();function openStoreCreateForm(){StoreCreateFormRef.current.open();}var DividentCategoryDetailsViewRef=useRef();function openDividentCategoryDetailsView(id){DividentCategoryDetailsViewRef.current.open(id);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(StoreCreate,{ref:StoreCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsxs(Modal,{show:show,size:\"xl\",onHide:handleClose,animation:false,backdrop:\"static\",scrollable:true,children:[/*#__PURE__*/_jsxs(Modal.Header,{children:[/*#__PURE__*/_jsx(Modal.Title,{children:formData.id?\"Update WithdrawnByUser Divident #\"+formData.description:\"Create New Divident Withdrawal\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"col align-self-end text-end\",children:[formData.id?/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:function onClick(){handleClose();props.openDetailsView(formData.id);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-eye\"}),\" View Detail\"]}):\"\",\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreate,children:[isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":\"\",formData.id?\"Update\":\"Create\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:handleClose,\"aria-label\":\"Close\"})]})]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 needs-validation\",onSubmit:handleCreate,children:[!cookies.get('store_name')?/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Store*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(Typeahead,{id:\"store_id\",labelKey:\"name\",isLoading:isStoresLoading,isInvalid:errors.store_id?true:false,onChange:function onChange(selectedItems){errors.store_id=\"\";errors[\"product_id\"]=\"\";setErrors(errors);if(selectedItems.length===0){errors.store_id=\"Invalid Store selected\";setErrors(errors);setFormData(_objectSpread({},formData));setSelectedStores([]);return;}formData.store_id=selectedItems[0].id;setFormData(_objectSpread({},formData));console.log(\"formData.store_id:\",formData.store_id);selectedStores=selectedItems;setSelectedStores(_toConsumableArray(selectedItems));},options:storeOptions,placeholder:\"Select Store\",selected:selectedStores,highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestStores(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:openStoreCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi x-lg\",children:\" \"}),errors.store_id]})]})]}):\"\",/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Withdrawn By User*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(Typeahead,{id:\"withdrawn_by_user_id\",labelKey:\"name\",isLoading:isWithdrawnByUsersLoading,isInvalid:errors.withdrawn_by_user_id?true:false,onChange:function onChange(selectedItems){errors.withdrawn_by_user_id=\"\";setErrors(errors);if(selectedItems.length===0){errors.withdrawn_by_user_id=\"Invalid User selected\";setErrors(errors);formData.withdrawn_by_user_id=\"\";setFormData(_objectSpread({},formData));setSelectedWithdrawnByUsers([]);return;}formData.withdrawn_by_user_id=selectedItems[0].id;setFormData(_objectSpread({},formData));setSelectedWithdrawnByUsers(selectedItems);},options:withdrawnbyuserOptions,placeholder:\"Select WithdrawnByUser\",selected:selectedWithdrawnByUsers,highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestUsers(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:props.openUserCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),errors.withdrawn_by_user_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.withdrawn_by_user_id]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Amount*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.amount?formData.amount:\"\",type:\"number\",onChange:function onChange(e){errors[\"amount\"]=\"\";setErrors(_objectSpread({},errors));formData.amount=parseFloat(e.target.value);setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"amount\",placeholder:\"Amount\"}),errors.amount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.amount]}),formData.amount&&!errors.amount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Description*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:formData.description?formData.description:\"\",type:\"string\",onChange:function onChange(e){errors[\"description\"]=\"\";setErrors(_objectSpread({},errors));formData.description=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control description\",id:\"description\",placeholder:\"Description\"}),errors.description&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.description]}),formData.description&&!errors.description&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Date Time*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(DatePicker,{id:\"date_str\",selected:formData.date_str?new Date(formData.date_str):null,value:formData.date_str?format(new Date(formData.date_str),\"MMMM d, yyyy h:mm aa\"):null,className:\"form-control\",dateFormat:\"MMMM d, yyyy h:mm aa\",showTimeSelect:true,timeIntervals:\"1\",onChange:function onChange(value){console.log(\"Value\",value);formData.date_str=value;// formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\nsetFormData(_objectSpread({},formData));}}),errors.date_str&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.date_str]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Payment method*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:formData.payment_method,onChange:function onChange(e){console.log(\"Inside onchange payment method\");if(!e.target.value){formData.payment_method=\"\";errors[\"status\"]=\"Invalid Payment Method\";setErrors(_objectSpread({},errors));return;}errors[\"payment_method\"]=\"\";setErrors(_objectSpread({},errors));formData.payment_method=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",SELECTED:true}),/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_account\",children:\"Bank Account / Debit / Credit Card\"})]}),errors.payment_method&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.payment_method]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Image(Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:selectedImage?selectedImage:\"\",type:\"file\",onChange:function onChange(e){errors[\"image\"]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){errors[\"image\"]=\"Invalid Image File\";setErrors(_objectSpread({},errors));return;}selectedImage=e.target.value;setSelectedImage(selectedImage);var file=document.querySelector('#image').files[0];var targetHeight=400;var targetWidth=400;var url=URL.createObjectURL(file);var img=new Image();img.onload=function(){var originaleWidth=img.width;var originalHeight=img.height;var targetDimensions=getTargetDimension(originaleWidth,originalHeight,targetWidth,targetHeight);targetWidth=targetDimensions.targetWidth;targetHeight=targetDimensions.targetHeight;resizeFIle(file,targetWidth,targetHeight,function(result){formData.images_content=[];formData.images_content[0]=result;setFormData(_objectSpread({},formData));console.log(\"formData.images_content[0]:\",formData.images_content[0]);});};img.src=url;/*\n                                        resizeFIle(file, (result) => {\n                                            if (!formData.images_content) {\n                                                formData.images_content = [];\n                                            }\n                                            formData.images_content[0] = result;\n                                            setFormData({ ...formData });\n    \n                                            console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                        });\n                                        */},className:\"form-control\",id:\"image\"}),errors.image&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.image]}),formData.image&&!errors.image&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleCreate,children:isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"bdivident\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Processing...\":formData.id?\"Update\":\"Create\"})]})]})})]})]});});export default DividentCreate;","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/divident/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","Modal","Button","Cookies","Spinner","DividentView","Typeahead","StoreCreate","Resizer","DatePicker","format","DividentCreate","props","ref","selectedStores","setSelectedStores","isStoresLoading","setIsStoresLoading","open","id","formData","images_content","setFormData","getDivident","SetShow","listener","event","code","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","value","preventDefault","document","addEventListener","removeEventListener","resizeFIle","file","w","h","cb","imageFileResizer","uri","selectedImage","setSelectedImage","storeOptions","setStoreOptions","selectedCategories","setSelectedCategories","categoryOptions","setCategoryOptions","errors","setErrors","isProcessing","setProcessing","cookies","show","handleClose","requestOptions","method","headers","get","fetch","then","response","isJson","json","data","ok","error","Promise","reject","result","selectedWithdrawnByUsers","withdrawn_by_user_id","name","withdrawn_by_user_name","setSelectedWithdrawnByUsers","store_id","store_name","catch","suggestStores","searchTerm","params","queryString","ObjectToSearchQueryParams","Authorization","Select","at","window","location","object","Object","keys","map","key","join","withdrawnbyuserOptions","setWithdrawnByUserOptions","isWithdrawnByUsersLoading","setIsWithdrawnByUsersLoading","suggestUsers","handleCreate","endPoint","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","getTargetDimension","originaleWidth","originalHeight","targetWidth","targetHeight","ratio","parseFloat","parseInt","StoreCreateFormRef","openStoreCreateForm","current","DividentCategoryDetailsViewRef","openDividentCategoryDetailsView","description","selectedItems","length","e","toString","color","openUserCreateForm","amount","date_str","Date","payment_method","querySelector","files","url","URL","createObjectURL","img","Image","onload","width","height","targetDimensions","src","image"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport Cookies from \"universal-cookie\";\nimport { Spinner } from \"react-bootstrap\";\nimport DividentView from \"./view.js\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport StoreCreate from \"../store/create.js\";\nimport Resizer from \"react-image-file-resizer\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\n\nconst DividentCreate = forwardRef((props, ref) => {\n\n    //Store Auto Suggestion\n    let [selectedStores, setSelectedStores] = useState([]);\n    const [isStoresLoading, setIsStoresLoading] = useState(false);\n\n\n    useImperativeHandle(ref, () => ({\n        open(id) {\n\n            formData = {\n                images_content: [],\n            };\n            setFormData({ formData });\n\n            if (id) {\n                getDivident(id);\n            }\n\n            SetShow(true);\n        },\n\n    }));\n\n    useEffect(() => {\n        const listener = event => {\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n                console.log(\"Enter key was pressed. Run your function-divident.\");\n                // event.preventDefault();\n\n                var form = event.target.form;\n                if (form && event.target) {\n                    var index = Array.prototype.indexOf.call(form, event.target);\n                    if (form && form.elements[index + 1]) {\n                        if (event.target.getAttribute(\"class\").includes(\"description\")) {\n                            form.elements[index].focus();\n                            form.elements[index].value += '\\r\\n';\n                        } else {\n                            form.elements[index + 1].focus();\n                        }\n                        event.preventDefault();\n                    }\n                }\n            }\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => {\n            document.removeEventListener(\"keydown\", listener);\n        };\n    }, []);\n\n\n    function resizeFIle(file, w, h, cb) {\n        Resizer.imageFileResizer(\n            file,\n            w,\n            h,\n            \"JPEG\",\n            100,\n            0,\n            (uri) => {\n                cb(uri);\n            },\n            \"base64\"\n        );\n    }\n\n    let [selectedImage, setSelectedImage] = useState(\"\");\n\n\n    let [storeOptions, setStoreOptions] = useState([]);\n\n    let [selectedCategories, setSelectedCategories] = useState([]);\n    let [categoryOptions, setCategoryOptions] = useState([]);\n\n    let [errors, setErrors] = useState({});\n    const [isProcessing, setProcessing] = useState(false);\n    const cookies = new Cookies();\n\n    //fields\n    let [formData, setFormData] = useState({\n        images_content: [],\n    });\n\n    const [show, SetShow] = useState(false);\n\n    function handleClose() {\n        SetShow(false);\n    }\n\n\n    function getDivident(id) {\n        console.log(\"inside get Divident\");\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n\n        fetch('/v1/divident/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n                console.log(\"Response:\");\n                console.log(data);\n\n                formData = data.result;\n\n                let selectedWithdrawnByUsers = [\n                    {\n                        id: formData.withdrawn_by_user_id,\n                        name: formData.withdrawn_by_user_name,\n                    }\n                ];\n\n                setSelectedWithdrawnByUsers([...selectedWithdrawnByUsers]);\n\n                let selectedStores = [\n                    {\n                        id: formData.store_id,\n                        name: formData.store_name,\n                    }\n                ];\n                setSelectedStores([...selectedStores]);\n\n                formData.images_content = [];\n                setFormData({ ...formData });\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n    async function suggestStores(searchTerm) {\n        console.log(\"Inside handle suggest Stores\");\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        let result = await fetch(\n            \"/v1/store?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setStoreOptions(data.result);\n    }\n\n    useEffect(() => {\n        let at = cookies.get(\"access_token\");\n        if (!at) {\n            window.location = \"/\";\n        }\n    });\n\n\n    function ObjectToSearchQueryParams(object) {\n        return Object.keys(object)\n            .map(function (key) {\n                return `search[${key}]=${object[key]}`;\n            })\n            .join(\"&\");\n    }\n\n    //WithdrawnByUser Auto Suggestion\n    const [withdrawnbyuserOptions, setWithdrawnByUserOptions] = useState([]);\n    const [selectedWithdrawnByUsers, setSelectedWithdrawnByUsers] = useState([]);\n    const [isWithdrawnByUsersLoading, setIsWithdrawnByUsersLoading] = useState(false);\n\n    async function suggestUsers(searchTerm) {\n        console.log(\"Inside handle suggestWithdrawnByUsers\");\n        setWithdrawnByUserOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsWithdrawnByUsersLoading(true);\n        let result = await fetch(\n            \"/v1/user?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setWithdrawnByUserOptions(data.result);\n        setIsWithdrawnByUsersLoading(false);\n    }\n\n    function handleCreate(event) {\n        event.preventDefault();\n        console.log(\"Inside handle Create\");\n\n        if (cookies.get(\"store_id\")) {\n            formData.store_id = cookies.get(\"store_id\");\n        }\n\n        let endPoint = \"/v1/divident\";\n        let method = \"POST\";\n        if (formData.id) {\n            endPoint = \"/v1/divident/\" + formData.id;\n            method = \"PUT\";\n        }\n\n        const requestOptions = {\n            method: method,\n            headers: {\n                'Accept': 'application/json',\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n            body: JSON.stringify(formData),\n        };\n\n        console.log(\"formData:\", formData);\n\n        setProcessing(true);\n        fetch(endPoint, requestOptions)\n            .then(async (response) => {\n                const isJson = response.headers\n                    .get(\"content-type\")\n                    ?.includes(\"application/json\");\n                const data = isJson && (await response.json());\n\n                // check for error response\n                if (!response.ok) {\n                    // get error message from body or default to response status\n                    const error = data && data.errors;\n                    //const error = data.errors\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n                setProcessing(false);\n\n                console.log(\"Response:\");\n                console.log(data);\n                props.showToastMessage(\"Divident Created Successfully!\", \"success\");\n                if (props.refreshList) {\n                    props.refreshList();\n                }\n\n                handleClose();\n                if (props.openDetailsView) {\n                    props.openDetailsView(data.result.id);\n                }\n\n            })\n            .catch((error) => {\n                setProcessing(false);\n                console.log(\"Inside catch\");\n                console.log(error);\n                setErrors({ ...error });\n                console.error(\"There was an error!\", error);\n                props.showToastMessage(\"Error Creating Divident!\", \"danger\");\n            });\n    }\n\n\n    function getTargetDimension(originaleWidth, originalHeight, targetWidth, targetHeight) {\n\n        let ratio = parseFloat(originaleWidth / originalHeight);\n\n        targetWidth = parseInt(targetHeight * ratio);\n        targetHeight = parseInt(targetWidth * ratio);\n\n        return { targetWidth: targetWidth, targetHeight: targetHeight };\n    }\n\n    /*\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        console.log(\"id:\", id);\n        DetailsViewRef.current.open(id);\n    }\n    */\n\n    const StoreCreateFormRef = useRef();\n    function openStoreCreateForm() {\n        StoreCreateFormRef.current.open();\n    }\n\n\n    const DividentCategoryDetailsViewRef = useRef();\n    function openDividentCategoryDetailsView(id) {\n        DividentCategoryDetailsViewRef.current.open(id);\n    }\n\n\n    return (\n        <>\n            <StoreCreate ref={StoreCreateFormRef} showToastMessage={props.showToastMessage} />\n\n            <Modal show={show} size=\"xl\" onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n                <Modal.Header>\n                    <Modal.Title>\n                        {formData.id ? \"Update WithdrawnByUser Divident #\" + formData.description : \"Create New Divident Withdrawal\"}\n                    </Modal.Title>\n\n\n                    <div className=\"col align-self-end text-end\">\n                        {formData.id ? <Button variant=\"primary\" onClick={() => {\n                            handleClose();\n                            props.openDetailsView(formData.id);\n                        }}>\n                            <i className=\"bi bi-eye\"></i> View Detail\n                        </Button> : \"\"}\n                        &nbsp;&nbsp;\n                        <Button variant=\"primary\" onClick={handleCreate} >\n                            {isProcessing ?\n                                <Spinner\n                                    as=\"span\"\n                                    animation=\"border\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden={true}\n                                /> + \" Creating...\"\n\n                                : \"\"\n                            }\n                            {formData.id ? \"Update\" : \"Create\"}\n\n                        </Button>\n                        <button\n                            type=\"button\"\n                            className=\"btn-close\"\n                            onClick={handleClose}\n                            aria-label=\"Close\"\n                        ></button>\n                    </div>\n                </Modal.Header>\n                <Modal.Body>\n                    <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n                        {!cookies.get('store_name') ? <div className=\"col-md-6\">\n                            <label className=\"form-label\">Store*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"store_id\"\n                                    labelKey=\"name\"\n                                    isLoading={isStoresLoading}\n                                    isInvalid={errors.store_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.store_id = \"\";\n                                        errors[\"product_id\"] = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.store_id = \"Invalid Store selected\";\n                                            setErrors(errors);\n                                            setFormData({ ...formData });\n                                            setSelectedStores([]);\n                                            return;\n                                        }\n                                        formData.store_id = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        console.log(\"formData.store_id:\", formData.store_id);\n                                        selectedStores = selectedItems;\n                                        setSelectedStores([...selectedItems]);\n                                    }\n                                    }\n                                    options={storeOptions}\n                                    placeholder=\"Select Store\"\n                                    selected={selectedStores}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestStores(searchTerm);\n                                    }}\n                                />\n\n                                <Button hide={true.toString()} onClick={openStoreCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi x-lg\"> </i>\n                                    {errors.store_id}\n                                </div>\n                            </div>\n                        </div> : \"\"}\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Withdrawn By User*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"withdrawn_by_user_id\"\n                                    labelKey=\"name\"\n                                    isLoading={isWithdrawnByUsersLoading}\n                                    isInvalid={errors.withdrawn_by_user_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.withdrawn_by_user_id = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.withdrawn_by_user_id = \"Invalid User selected\";\n                                            setErrors(errors);\n                                            formData.withdrawn_by_user_id = \"\";\n                                            setFormData({ ...formData });\n                                            setSelectedWithdrawnByUsers([]);\n                                            return;\n                                        }\n                                        formData.withdrawn_by_user_id = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        setSelectedWithdrawnByUsers(selectedItems);\n                                    }}\n                                    options={withdrawnbyuserOptions}\n                                    placeholder=\"Select WithdrawnByUser\"\n                                    selected={selectedWithdrawnByUsers}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestUsers(searchTerm);\n                                    }}\n                                />\n                                <Button hide={true.toString()} onClick={props.openUserCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                {errors.withdrawn_by_user_id && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.withdrawn_by_user_id}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Amount*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.amount ? formData.amount : \"\"}\n                                    type='number'\n                                    onChange={(e) => {\n                                        errors[\"amount\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.amount = parseFloat(e.target.value);\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"amount\"\n                                    placeholder=\"Amount\"\n                                />\n                                {errors.amount && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.amount}\n                                    </div>\n                                )}\n                                {formData.amount && !errors.amount && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Description*</label>\n                            <div className=\"input-group mb-3\">\n                                <textarea\n                                    value={formData.description ? formData.description : \"\"}\n                                    type='string'\n                                    onChange={(e) => {\n                                        errors[\"description\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.description = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control description\"\n                                    id=\"description\"\n                                    placeholder=\"Description\"\n                                />\n                                {errors.description && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.description}\n                                    </div>\n                                )}\n                                {formData.description && !errors.description && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Date Time*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    selected={formData.date_str ? new Date(formData.date_str) : null}\n                                    value={formData.date_str ? format(\n                                        new Date(formData.date_str),\n                                        \"MMMM d, yyyy h:mm aa\"\n                                    ) : null}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                    showTimeSelect\n                                    timeIntervals=\"1\"\n                                    onChange={(value) => {\n                                        console.log(\"Value\", value);\n                                        formData.date_str = value;\n                                        // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-2\">\n                            <label className=\"form-label\">Payment method*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <select\n                                    value={formData.payment_method}\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange payment method\");\n                                        if (!e.target.value) {\n                                            formData.payment_method = \"\";\n                                            errors[\"status\"] = \"Invalid Payment Method\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        errors[\"payment_method\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.payment_method = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                >\n                                    <option value=\"\" SELECTED></option>\n                                    <option value=\"cash\">Cash</option>\n                                    <option value=\"bank_account\">Bank Account / Debit / Credit Card</option>\n                                </select>\n                                {errors.payment_method && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.payment_method}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Image(Optional)</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={selectedImage ? selectedImage : \"\"}\n                                    type='file'\n                                    onChange={(e) => {\n                                        errors[\"image\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        if (!e.target.value) {\n                                            errors[\"image\"] = \"Invalid Image File\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        selectedImage = e.target.value;\n                                        setSelectedImage(selectedImage);\n\n                                        let file = document.querySelector('#image').files[0];\n\n\n                                        let targetHeight = 400;\n                                        let targetWidth = 400;\n\n\n                                        let url = URL.createObjectURL(file);\n                                        let img = new Image();\n\n                                        img.onload = function () {\n                                            let originaleWidth = img.width;\n                                            let originalHeight = img.height;\n\n                                            let targetDimensions = getTargetDimension(originaleWidth, originalHeight, targetWidth, targetHeight);\n                                            targetWidth = targetDimensions.targetWidth;\n                                            targetHeight = targetDimensions.targetHeight;\n\n                                            resizeFIle(file, targetWidth, targetHeight, (result) => {\n                                                formData.images_content = [];\n                                                formData.images_content[0] = result;\n                                                setFormData({ ...formData });\n\n                                                console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                            });\n                                        };\n                                        img.src = url;\n\n\n                                        /*\n                                        resizeFIle(file, (result) => {\n                                            if (!formData.images_content) {\n                                                formData.images_content = [];\n                                            }\n                                            formData.images_content[0] = result;\n                                            setFormData({ ...formData });\n    \n                                            console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                        });\n                                        */\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"image\"\n                                />\n                                {errors.image && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.image}\n                                    </div>\n                                )}\n                                {formData.image && !errors.image && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n\n\n                        <Modal.Footer>\n                            <Button variant=\"secondary\" onClick={handleClose}>\n                                Close\n                            </Button>\n                            <Button variant=\"primary\" onClick={handleCreate} >\n                                {isProcessing ?\n                                    <Spinner\n                                        as=\"span\"\n                                        animation=\"bdivident\"\n                                        size=\"sm\"\n                                        role=\"status\"\n                                        aria-hidden={true}\n                                    /> + \" Processing...\"\n\n                                    : formData.id ? \"Update\" : \"Create\"\n                                }\n                            </Button>\n                        </Modal.Footer>\n                    </form>\n                </Modal.Body>\n\n            </Modal>\n\n\n        </>\n    );\n});\n\nexport default DividentCreate;\n"]},"metadata":{},"sourceType":"module"}