{"ast":null,"code":"var _jsxFileName = \"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/purchase/create.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport PurchasePreview from \"./preview.js\";\nimport { Modal, Button, Form } from \"react-bootstrap\";\nimport StoreCreate from \"../store/create.js\";\nimport VendorCreate from \"./../vendor/create.js\";\nimport ProductCreate from \"./../product/create.js\";\nimport UserCreate from \"./../user/create.js\";\nimport SignatureCreate from \"./../signature/create.js\";\nimport Cookies from \"universal-cookie\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport NumberFormat from \"react-number-format\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\nimport { Spinner } from \"react-bootstrap\";\nimport PurchaseView from \"./view.js\";\nimport ProductView from \"./../product/view.js\";\nimport { DebounceInput } from 'react-debounce-input';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PurchaseCreate = /*#__PURE__*/forwardRef(_c = _s((props, ref) => {\n  var _totalPaymentAmount, _balanceAmount;\n\n  _s();\n\n  useImperativeHandle(ref, () => ({\n    open(id) {\n      selectedProducts = [];\n      setSelectedProducts([]);\n      selectedStores = [];\n      setSelectedStores([]);\n      selectedVendors = [];\n      setSelectedVendors([]);\n      selectedOrderPlacedByUsers = [];\n      setSelectedOrderPlacedByUsers([]);\n      selectedOrderPlacedBySignatures = [];\n      setSelectedOrderPlacedBySignatures([]);\n      formData = {\n        vat_percent: 15.0,\n        discount: 0.0,\n        discountValue: 0.0,\n        discount_percent: 0.0,\n        shipping_handling_fees: 0.00,\n        partial_payment_amount: 0.00,\n        is_discount_percent: false,\n        date_str: new Date(),\n        signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n        status: \"delivered\",\n        payment_method: \"\",\n        payment_status: \"paid\"\n      };\n      formData.payments_input = [{\n        \"date_str\": formData.date_str,\n        // \"amount\": \"\",\n        \"amount\": 0.00,\n        \"method\": \"\",\n        \"deleted\": false\n      }];\n      formData.cash_discount = 0.00;\n\n      if (cookies.get('store_id')) {\n        formData.store_id = cookies.get('store_id');\n        formData.store_name = cookies.get('store_name');\n      }\n\n      if (cookies.get(\"user_id\")) {\n        selectedOrderPlacedByUsers = [{\n          id: cookies.get(\"user_id\"),\n          name: cookies.get(\"user_name\")\n        }];\n        formData.order_placed_by = cookies.get(\"user_id\");\n        formData.vat_percent = parseFloat(cookies.get('vat_percent'));\n        setFormData({ ...formData\n        });\n        setSelectedOrderPlacedByUsers([...selectedOrderPlacedByUsers]);\n      }\n\n      setFormData({ ...formData\n      });\n\n      if (id) {\n        getPurchase(id);\n      }\n\n      reCalculate();\n      setShow(true);\n    }\n\n  }));\n  useEffect(() => {\n    const listener = event => {\n      if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n        console.log(\"Enter key was pressed. Run your function-purchase.\"); // event.preventDefault();\n\n        var form = event.target.form;\n\n        if (form && event.target) {\n          var index = Array.prototype.indexOf.call(form, event.target);\n\n          if (form && form.elements[index + 1]) {\n            if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n              form.elements[index].focus();\n            } else {\n              form.elements[index + 1].focus();\n            }\n\n            event.preventDefault();\n          }\n        }\n      }\n    };\n\n    document.addEventListener(\"keydown\", listener);\n    return () => {\n      document.removeEventListener(\"keydown\", listener);\n    };\n  }, []);\n  useEffect(() => {\n    console.log(\"inside change on formData:\", formData); // localStorage\n  });\n  const selectedDate = new Date(); //const history = useHistory();\n\n  let [errors, setErrors] = useState({});\n  const [isProcessing, setProcessing] = useState(false);\n  const cookies = new Cookies(); //fields\n\n  let [formData, setFormData] = useState({\n    vat_percent: 10.0,\n    discount: 0.0,\n    discountValue: 0.0,\n    discount_percent: 0.0,\n    is_discount_percent: false,\n    date_str: format(new Date(), \"MMM dd yyyy\"),\n    signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n    status: \"created\"\n  }); //Store Auto Suggestion\n\n  const [storeOptions, setStoreOptions] = useState([]);\n  let [selectedStores, setSelectedStores] = useState([]);\n  const [isStoresLoading, setIsStoresLoading] = useState(false); //Vendor Auto Suggestion\n\n  const [vendorOptions, setVendorOptions] = useState([]);\n  let [selectedVendors, setSelectedVendors] = useState([]);\n  const [isVendorsLoading, setIsVendorsLoading] = useState(false); //Product Auto Suggestion\n\n  const [productOptions, setProductOptions] = useState([]);\n  let [selectedProduct, setSelectedProduct] = useState([]);\n  let [selectedProducts, setSelectedProducts] = useState([]);\n  const [isProductsLoading, setIsProductsLoading] = useState(false); //Order Placed By Auto Suggestion\n\n  const [orderPlacedByUserOptions, setOrderPlacedByUserOptions] = useState([]);\n  let [selectedOrderPlacedByUsers, setSelectedOrderPlacedByUsers] = useState([]);\n  const [isOrderPlacedByUsersLoading, setIsOrderPlacedByUsersLoading] = useState(false); //Order Placed By Signature Auto Suggestion\n\n  const [orderPlacedBySignatureOptions, setOrderPlacedBySignatureOptions] = useState([]);\n  let [selectedOrderPlacedBySignatures, setSelectedOrderPlacedBySignatures] = useState([]);\n  const [isOrderPlacedBySignaturesLoading, setIsOrderPlacedBySignaturesLoading] = useState(false);\n  const [show, setShow] = useState(false);\n\n  function handleClose() {\n    setShow(false);\n  }\n\n  useEffect(() => {\n    let at = cookies.get(\"access_token\");\n\n    if (!at) {\n      // history.push(\"/dashboard/purchases\");\n      window.location = \"/\";\n    }\n  });\n\n  function getPurchase(id) {\n    console.log(\"inside get Purchase\");\n    const requestOptions = {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': cookies.get('access_token')\n      }\n    };\n    fetch('/v1/purchase/' + id, requestOptions).then(async response => {\n      var _response$headers$get;\n\n      const isJson = (_response$headers$get = response.headers.get('content-type')) === null || _response$headers$get === void 0 ? void 0 : _response$headers$get.includes('application/json');\n      const data = isJson && (await response.json()); // check for error response\n\n      if (!response.ok) {\n        const error = data && data.errors;\n        return Promise.reject(error);\n      }\n\n      setErrors({});\n      console.log(\"Response:\");\n      console.log(data);\n      let purchase = data.result;\n      formData = {\n        id: purchase.id,\n        code: purchase.code,\n        store_id: purchase.store_id,\n        vendor_id: purchase.vendor_id,\n        date_str: purchase.date,\n        // date: purchase.date,\n        vat_percent: purchase.vat_percent,\n        discount: purchase.discount,\n        cash_discount: purchase.cash_discount,\n        discount_percent: purchase.discount_percent,\n        status: purchase.status,\n        order_placed_by: purchase.order_placed_by,\n        order_placed_by_signature_id: purchase.order_placed_by_signature_id,\n        is_discount_percent: purchase.is_discount_percent,\n        partial_payment_amount: purchase.partial_payment_amount,\n        payment_method: purchase.payment_method,\n        payment_status: purchase.payment_status,\n        shipping_handling_fees: purchase.shipping_handling_fees\n      };\n\n      if (data.result.payments) {\n        console.log(\"data.result.payments:\", data.result.payments);\n        formData.payments_input = data.result.payments;\n\n        for (var i = 0; i < ((_formData$payments_in = formData.payments_input) === null || _formData$payments_in === void 0 ? void 0 : _formData$payments_in.length); i++) {\n          var _formData$payments_in;\n\n          formData.payments_input[i].date_str = formData.payments_input[i].date;\n        }\n      }\n\n      if (formData.is_discount_percent) {\n        formData.discountValue = formData.discount_percent;\n      } else {\n        formData.discountValue = formData.discount;\n      }\n\n      selectedProducts = purchase.products;\n      setSelectedProducts([...selectedProducts]);\n      let selectedStores = [{\n        id: purchase.store_id,\n        name: purchase.store_name\n      }];\n      let selectedVendors = [{\n        id: purchase.vendor_id,\n        name: purchase.vendor_name,\n        search_label: purchase.vendor_name\n      }];\n      let selectedOrderPlacedByUsers = [{\n        id: purchase.order_placed_by,\n        name: purchase.order_placed_by_name\n      }];\n\n      if (purchase.order_placed_by_signature_id) {\n        let selectedOrderPlacedBySignatures = [{\n          id: purchase.order_placed_by_signature_id,\n          name: purchase.order_placed_by_signature_name\n        }];\n        setSelectedOrderPlacedBySignatures([...selectedOrderPlacedBySignatures]);\n      }\n\n      setSelectedOrderPlacedByUsers([...selectedOrderPlacedByUsers]);\n      setSelectedStores([...selectedStores]);\n      setSelectedVendors([...selectedVendors]);\n      reCalculate();\n      setFormData({ ...formData\n      });\n    }).catch(error => {\n      setProcessing(false);\n      setErrors(error);\n    });\n  }\n\n  function ObjectToSearchQueryParams(object) {\n    return Object.keys(object).map(function (key) {\n      return `search[${key}]=` + encodeURIComponent(object[key]);\n    }).join(\"&\");\n  }\n\n  async function suggestStores(searchTerm) {\n    console.log(\"Inside handle suggestStores\");\n    setStoreOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name\";\n    setIsStoresLoading(true);\n    let result = await fetch(\"/v1/store?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setStoreOptions(data.result);\n    setIsStoresLoading(false);\n  }\n\n  async function suggestVendors(searchTerm) {\n    console.log(\"Inside handle suggestVendors\");\n    setVendorOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name,phone,name_in_arabic,phone_in_arabic,search_label\";\n    setIsVendorsLoading(true);\n    let result = await fetch(\"/v1/vendor?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setVendorOptions(data.result);\n    setIsVendorsLoading(false);\n  }\n\n  function GetProductUnitPriceInStore(storeId, productStores) {\n    console.log(\"Inside GetProductUnitPriceInStore\");\n\n    if (!productStores) {\n      return \"\";\n    }\n\n    console.log(\"Cool\");\n\n    for (var i = 0; i < productStores.length; i++) {\n      console.log(\"productStores[i]:\", productStores[i]);\n      console.log(\"store_id:\", storeId);\n\n      if (productStores[i].store_id === storeId) {\n        console.log(\"macthed\");\n        console.log(\"unitPrice.retail_unit_price:\", productStores[i].purchase_unit_price);\n        return productStores[i];\n      }\n    }\n\n    console.log(\"not matched\");\n    return \"\";\n  }\n\n  let [openProductSearchResult, setOpenProductSearchResult] = useState(false);\n\n  async function suggestProducts(searchTerm) {\n    console.log(\"Inside handle suggestProducts\");\n    setProductOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      openProductSearchResult = false;\n      setOpenProductSearchResult(false);\n      setIsProductsLoading(false);\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n\n    if (cookies.get(\"store_id\")) {\n      params.store_id = cookies.get(\"store_id\");\n    }\n\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,item_code,bar_code,name,product_stores,unit,part_number,name_in_arabic\";\n    setIsProductsLoading(true);\n    let result = await fetch(\"/v1/product?\" + Select + queryString + \"&limit=200\", requestOptions);\n    let data = await result.json();\n    let products = data.result;\n\n    if (!products || products.length === 0) {\n      openProductSearchResult = false;\n      setOpenProductSearchResult(false);\n      setIsProductsLoading(false);\n      return;\n    }\n\n    openProductSearchResult = true;\n    setOpenProductSearchResult(true);\n    setProductOptions(products);\n    setIsProductsLoading(false);\n  }\n\n  async function getProductByBarCode(barcode) {\n    formData.barcode = barcode;\n    setFormData({ ...formData\n    });\n    console.log(\"Inside getProductByBarCode\");\n    errors[\"bar_code\"] = \"\";\n    setErrors({ ...errors\n    });\n    console.log(\"barcode:\" + formData.barcode);\n\n    if (!formData.barcode) {\n      return;\n    }\n\n    if (formData.barcode.length === 13) {\n      formData.barcode = formData.barcode.slice(0, -1);\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,item_code,bar_code,part_number,name,product_stores,unit,part_number,name_in_arabic\";\n    let result = await fetch(\"/v1/product/barcode/\" + formData.barcode + \"?\" + Select, requestOptions);\n    let data = await result.json();\n    let product = data.result;\n\n    if (product) {\n      addProduct(product);\n    } else {\n      errors[\"bar_code\"] = \"Invalid Barcode:\" + formData.barcode;\n      setErrors({ ...errors\n      });\n    }\n\n    formData.barcode = \"\";\n    setFormData({ ...formData\n    });\n  }\n\n  async function suggestUsers(searchTerm) {\n    console.log(\"Inside handle suggestUsers\");\n    setOrderPlacedByUserOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name\";\n    setIsOrderPlacedByUsersLoading(true);\n    let result = await fetch(\"/v1/user?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setOrderPlacedByUserOptions(data.result);\n    setIsOrderPlacedByUsersLoading(false);\n  }\n\n  async function suggestSignatures(searchTerm) {\n    console.log(\"Inside handle suggestSignatures\");\n    setOrderPlacedBySignatureOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name\";\n    setIsOrderPlacedBySignaturesLoading(true);\n    let result = await fetch(\"/v1/signature?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setOrderPlacedBySignatureOptions(data.result);\n    setIsOrderPlacedBySignaturesLoading(false);\n  }\n\n  function handleCreate(event) {\n    event.preventDefault();\n    console.log(\"Inside handle Create\");\n    console.log(\"selectedProducts:\", selectedProducts);\n\n    if (!formData.cash_discount) {\n      formData.cash_discount = 0.00;\n    }\n\n    formData.products = [];\n\n    for (var i = 0; i < selectedProducts.length; i++) {\n      formData.products.push({\n        product_id: selectedProducts[i].product_id,\n        quantity: parseFloat(selectedProducts[i].quantity),\n        unit: selectedProducts[i].unit,\n        purchase_unit_price: parseFloat(selectedProducts[i].purchase_unit_price),\n        retail_unit_price: parseFloat(selectedProducts[i].retail_unit_price),\n        wholesale_unit_price: parseFloat(selectedProducts[i].wholesale_unit_price)\n      });\n    }\n\n    formData.discount = parseFloat(formData.discount);\n    formData.discount_percent = parseFloat(formData.discount_percent);\n    formData.vat_percent = parseFloat(formData.vat_percent);\n    formData.net_total = parseFloat(netTotal);\n    console.log(\"formData.discount:\", formData.discount);\n    console.log(\"formData.discount_percent:\", formData.discount_percent);\n\n    if (!formData.shipping_handling_fees && formData.shipping_handling_fees !== 0) {\n      errors[\"shipping_handling_fees\"] = \"Invalid shipping / handling fees\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (!formData.discount && formData.discount !== 0) {\n      errors[\"discount\"] = \"Invalid discount\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (!formData.discount_percent && formData.discount_percent !== 0) {\n      errors[\"discount_percent\"] = \"Invalid discount percent\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (parseFloat(formData.discount_percent) > 100) {\n      errors[\"discount_percent\"] = \"Discount percent cannot be > 100\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (!formData.vat_percent && formData.vat_percent !== 0) {\n      errors[\"vat_percent\"] = \"Invalid vat percent\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (cookies.get('store_id')) {\n      formData.store_id = cookies.get('store_id');\n    }\n\n    let endPoint = \"/v1/purchase\";\n    let method = \"POST\";\n\n    if (formData.id) {\n      endPoint = \"/v1/purchase/\" + formData.id;\n      method = \"PUT\";\n    }\n\n    const requestOptions = {\n      method: method,\n      headers: {\n        'Accept': 'application/json',\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      },\n      body: JSON.stringify(formData)\n    };\n    setProcessing(true);\n    fetch(endPoint, requestOptions).then(async response => {\n      var _response$headers$get2;\n\n      const isJson = (_response$headers$get2 = response.headers.get(\"content-type\")) === null || _response$headers$get2 === void 0 ? void 0 : _response$headers$get2.includes(\"application/json\");\n      const data = isJson && (await response.json()); // check for error response\n\n      if (!response.ok) {\n        // get error message from body or default to response status\n        const error = data && data.errors; //const error = data.errors\n\n        return Promise.reject(error);\n      }\n\n      setErrors({});\n      setProcessing(false);\n      console.log(\"Response:\");\n      console.log(data);\n      props.showToastMessage(\"Purchase Created Successfully!\", \"success\");\n\n      if (props.refreshList) {\n        props.refreshList();\n      }\n\n      handleClose();\n      props.openDetailsView(data.result.id);\n    }).catch(error => {\n      setProcessing(false);\n      console.log(\"Inside catch\");\n      console.log(error);\n      setErrors({ ...error\n      });\n      console.error(\"There was an error!\", error);\n      props.showToastMessage(\"Error Creating Purchase!\", \"danger\");\n    });\n  }\n\n  function isProductAdded(productID) {\n    for (var i = 0; i < selectedProducts.length; i++) {\n      if (selectedProducts[i].product_id === productID) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function addProduct(product) {\n    console.log(\"Inside Add product\");\n\n    if (!formData.store_id) {\n      errors.product_id = \"Please Select a Store and try again\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    errors.product_id = \"\";\n\n    if (!product) {\n      errors.product_id = \"Invalid Product\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    let productStore = {};\n\n    if (product.product_stores) {\n      /*\n      productStore = GetProductUnitPriceInStore(\n          formData.store_id,\n          product.stores\n      );\n      */\n      if (product.product_stores[formData.store_id]) {\n        product.retail_unit_price = product.product_stores[formData.store_id].retail_unit_price;\n      }\n\n      if (product.product_stores[formData.store_id]) {\n        //product.purchase_unit_price = productStore.purchase_unit_price;\n        product.purchase_unit_price = product.product_stores[formData.store_id].purchase_unit_price;\n      }\n\n      if (product.product_stores[formData.store_id]) {\n        // product.wholesale_unit_price = productStore.wholesale_unit_price;\n        product.wholesale_unit_price = product.product_stores[formData.store_id].wholesale_unit_price;\n      }\n    }\n\n    let alreadyAdded = false;\n    let index = -1;\n    let quantity = 0.00;\n    product.quantity = 1.00;\n\n    if (isProductAdded(product.id)) {\n      alreadyAdded = true;\n      index = getProductIndex(product.id);\n      quantity = parseFloat(selectedProducts[index].quantity + product.quantity);\n    } else {\n      quantity = parseFloat(product.quantity);\n    }\n\n    console.log(\"quantity:\", quantity);\n    errors.quantity = \"\";\n\n    if (alreadyAdded) {\n      selectedProducts[index].quantity = parseFloat(quantity); // setSelectedProducts([...selectedProducts]);\n    }\n\n    if (!alreadyAdded) {\n      let item = {\n        product_id: product.id,\n        code: product.item_code,\n        part_number: product.part_number,\n        name: product.name,\n        quantity: product.quantity,\n        product_stores: product.product_stores,\n        unit: product.unit\n      };\n\n      if (product.purchase_unit_price) {\n        item.purchase_unit_price = parseFloat(product.purchase_unit_price).toFixed(2);\n      }\n\n      if (product.retail_unit_price) {\n        item.retail_unit_price = parseFloat(product.retail_unit_price).toFixed(2);\n      }\n\n      if (product.wholesale_unit_price) {\n        item.wholesale_unit_price = parseFloat(product.wholesale_unit_price).toFixed(2);\n      }\n\n      selectedProducts.push(item);\n    }\n\n    setSelectedProducts([...selectedProducts]);\n    reCalculate();\n    formData.products = [];\n\n    for (var i = 0; i < selectedProducts.length; i++) {\n      formData.products.push({\n        product_id: selectedProducts[i].product_id,\n        quantity: parseFloat(selectedProducts[i].quantity),\n        unit: selectedProducts[i].unit,\n        purchase_unit_price: parseFloat(selectedProducts[i].purchase_unit_price),\n        retail_unit_price: parseFloat(selectedProducts[i].retail_unit_price),\n        wholesale_unit_price: parseFloat(selectedProducts[i].wholesale_unit_price)\n      });\n    }\n\n    setFormData({ ...formData\n    });\n  }\n\n  function getProductIndex(productID) {\n    for (var i = 0; i < selectedProducts.length; i++) {\n      if (selectedProducts[i].product_id === productID) {\n        return i;\n      }\n    }\n\n    return false;\n  }\n\n  function removeProduct(product) {\n    if (product.quantity_returned > 0) {\n      errors[\"product_\" + index] = \"This product cannot be removed as it is returned, Note: Please remove the product from purchase return and try again\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    const index = selectedProducts.indexOf(product);\n\n    if (index > -1) {\n      selectedProducts.splice(index, 1);\n    }\n\n    setSelectedProducts([...selectedProducts]);\n    reCalculate();\n  }\n\n  let [totalPrice, setTotalPrice] = useState(0.0);\n\n  function findTotalPrice() {\n    totalPrice = 0.00;\n\n    for (var i = 0; i < selectedProducts.length; i++) {\n      totalPrice += parseFloat(selectedProducts[i].purchase_unit_price) * parseFloat(selectedProducts[i].quantity);\n    }\n\n    totalPrice = totalPrice.toFixed(2);\n    setTotalPrice(totalPrice);\n  }\n\n  let [vatPrice, setVatPrice] = useState(0.00);\n\n  function findVatPrice() {\n    vatPrice = 0.00;\n\n    if (totalPrice > 0) {\n      vatPrice = (parseFloat(parseFloat(formData.vat_percent) / 100) * (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount))).toFixed(2);\n      ;\n      console.log(\"vatPrice:\", vatPrice);\n    }\n\n    setVatPrice(vatPrice);\n  }\n\n  let [netTotal, setNetTotal] = useState(0.00);\n\n  function findNetTotal() {\n    netTotal = 0.00;\n\n    if (totalPrice > 0) {\n      netTotal = parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount) + parseFloat(vatPrice);\n      netTotal = parseFloat(netTotal);\n    }\n\n    netTotal = RoundFloat(netTotal, 2); // netTotal = Math.round(netTotal * 100) / 100;\n\n    setNetTotal(netTotal);\n\n    if (!formData.id) {\n      let method = \"\";\n\n      if (formData.payments_input[0]) {\n        method = formData.payments_input[0].method;\n      }\n\n      formData.payments_input = [{\n        \"date_str\": formData.date_str,\n        \"amount\": 0.00,\n        \"method\": method,\n        \"deleted\": false\n      }];\n\n      if (netTotal > 0) {\n        formData.payments_input[0].amount = parseFloat(netTotal.toFixed(2));\n\n        if (formData.cash_discount) {\n          var _formData$cash_discou;\n\n          formData.payments_input[0].amount = formData.payments_input[0].amount - parseFloat((_formData$cash_discou = formData.cash_discount) === null || _formData$cash_discou === void 0 ? void 0 : _formData$cash_discou.toFixed(2));\n        }\n\n        formData.payments_input[0].amount = parseFloat(formData.payments_input[0].amount.toFixed(2));\n      }\n    }\n\n    setFormData({ ...formData\n    });\n    validatePaymentAmounts();\n  }\n\n  function RoundFloat(val, precision) {\n    var ratio = Math.pow(10, precision);\n    return Math.round(val * ratio) / ratio;\n  }\n\n  let [discountPercent, setDiscountPercent] = useState(0.00);\n\n  function findDiscountPercent() {\n    if (formData.discount >= 0 && totalPrice > 0) {\n      discountPercent = parseFloat(parseFloat(formData.discount / totalPrice) * 100).toFixed(2);\n      setDiscountPercent(discountPercent);\n      formData.discount_percent = discountPercent;\n      setFormData({ ...formData\n      });\n    }\n  }\n\n  function findDiscount() {\n    if (formData.discount_percent >= 0 && totalPrice > 0) {\n      formData.discount = parseFloat(totalPrice * parseFloat(formData.discount_percent / 100)).toFixed(2);\n      setFormData({ ...formData\n      });\n    }\n  }\n\n  function reCalculate() {\n    findTotalPrice();\n\n    if (formData.is_discount_percent) {\n      findDiscount();\n    } else {\n      findDiscountPercent();\n    }\n\n    findVatPrice();\n    findNetTotal();\n  }\n\n  function addNewPayment() {\n    let date = new Date();\n\n    if (!formData.id) {\n      date = formData.date_str;\n    }\n\n    if (!formData.payments_input) {\n      formData.payments_input = [];\n    }\n\n    formData.payments_input.push({\n      \"date_str\": date,\n      // \"amount\": \"\",\n      \"amount\": 0.00,\n      \"method\": \"\",\n      \"deleted\": false\n    });\n    setFormData({ ...formData\n    });\n    validatePaymentAmounts(); //validatePaymentAmounts((formData.payments_input.filter(payment => !payment.deleted).length - 1));\n  }\n\n  function findTotalPayments() {\n    var _parseFloat, _parseFloat2;\n\n    let totalPayment = 0.00;\n\n    for (var i = 0; i < ((_formData$payments_in2 = formData.payments_input) === null || _formData$payments_in2 === void 0 ? void 0 : _formData$payments_in2.length); i++) {\n      var _formData$payments_in2;\n\n      if (formData.payments_input[i].amount && !formData.payments_input[i].deleted) {\n        totalPayment += formData.payments_input[i].amount;\n      }\n    }\n\n    totalPaymentAmount = totalPayment;\n    console.log(\"totalPaymentAmount:\", totalPaymentAmount);\n    setTotalPaymentAmount(totalPaymentAmount);\n    console.log(\"totalPayment:\", totalPayment);\n    balanceAmount = parseFloat(netTotal.toFixed(2)) - parseFloat((_parseFloat = parseFloat(formData.cash_discount)) === null || _parseFloat === void 0 ? void 0 : _parseFloat.toFixed(2)) - parseFloat(totalPayment.toFixed(2));\n    balanceAmount = parseFloat(balanceAmount.toFixed(2));\n    setBalanceAmount(balanceAmount);\n\n    if (balanceAmount === parseFloat((parseFloat(netTotal.toFixed(2)) - parseFloat((_parseFloat2 = parseFloat(formData.cash_discount)) === null || _parseFloat2 === void 0 ? void 0 : _parseFloat2.toFixed(2))).toFixed(2))) {\n      paymentStatus = \"not_paid\";\n    } else if (balanceAmount <= 0) {\n      paymentStatus = \"paid\";\n    } else if (balanceAmount > 0) {\n      paymentStatus = \"paid_partially\";\n    }\n\n    setPaymentStatus(paymentStatus);\n    return totalPayment;\n  }\n\n  let [totalPaymentAmount, setTotalPaymentAmount] = useState(0.00);\n  let [balanceAmount, setBalanceAmount] = useState(0.00);\n  let [paymentStatus, setPaymentStatus] = useState(\"\");\n\n  function removePayment(key, validatePayments = false) {\n    formData.payments_input.splice(key, 1); //formData.payments_input[key][\"deleted\"] = true;\n\n    setFormData({ ...formData\n    });\n\n    if (validatePayments) {\n      validatePaymentAmounts();\n    }\n\n    findTotalPayments();\n  }\n\n  function validatePaymentAmounts() {\n    console.log(\"validatePaymentAmount: netTotal:\", netTotal);\n    errors[\"cash_discount\"] = \"\";\n    setErrors({ ...errors\n    });\n    let haveErrors = false;\n\n    if (!netTotal) {\n      /*\n      removePayment(0, false);\n      totalPaymentAmount = 0.0;\n      setTotalPaymentAmount(0.00);\n      balanceAmount = 0.00;\n      setBalanceAmount(0.00);\n      paymentStatus = \"\";\n      setPaymentStatus(paymentStatus);\n      */\n      return true;\n    }\n\n    if (formData.cash_discount > 0 && formData.cash_discount >= netTotal) {\n      errors[\"cash_discount\"] = \"Cash discount should not be >= \" + netTotal.toFixed(2).toString();\n      setErrors({ ...errors\n      });\n      haveErrors = true;\n      return false;\n    }\n\n    let totalPayment = findTotalPayments(); // errors[\"payment_date\"] = [];\n    //errors[\"payment_method\"] = [];\n    //errors[\"payment_amount\"] = [];\n\n    for (var key = 0; key < formData.payments_input.length; key++) {\n      errors[\"payment_amount_\" + key] = \"\";\n      errors[\"payment_date_\" + key] = \"\";\n      errors[\"payment_method_\" + key] = \"\";\n      setErrors({ ...errors\n      });\n\n      if (!formData.payments_input[key].amount) {\n        errors[\"payment_amount_\" + key] = \"Payment amount is required\";\n        setErrors({ ...errors\n        });\n        haveErrors = true;\n      } else if (formData.payments_input[key].amount === 0) {\n        errors[\"payment_amount_\" + key] = \"Amount should be greater than zero\";\n        setErrors({ ...errors\n        });\n        haveErrors = true;\n      }\n\n      if (!formData.payments_input[key].date_str) {\n        errors[\"payment_date_\" + key] = \"Payment date is required\";\n        setErrors({ ...errors\n        });\n        haveErrors = true;\n      } else if (new Date(formData.payments_input[key].date_str) < new Date(formData.date_str)) {\n        errors[\"payment_date_\" + key] = \"Payment date time should be greater than or equal to order date time\";\n        setErrors({ ...errors\n        });\n        haveErrors = true;\n      }\n\n      if (!formData.payments_input[key].method) {\n        errors[\"payment_method_\" + key] = \"Payment method is required\";\n        setErrors({ ...errors\n        });\n        haveErrors = true;\n      }\n\n      if ((formData.payments_input[key].amount || formData.payments_input[key].amount === 0) && !formData.payments_input[key].deleted) {\n        let maxAllowedAmount = netTotal - formData.cash_discount - (totalPayment - formData.payments_input[key].amount);\n\n        if (maxAllowedAmount < 0) {\n          maxAllowedAmount = 0;\n        }\n        /*\n        \n        if (maxAllowedAmount === 0) {\n            errors[\"payment_amount_\" + key] = \"Total amount should not exceed \" + (netTotal - formData.cash_discount).toFixed(2).toString() + \", Please delete this payment\";\n            setErrors({ ...errors });\n            haveErrors = true;\n        } else if (formData.payments_input[key].amount > parseFloat(maxAllowedAmount.toFixed(2))) {\n            errors[\"payment_amount_\" + key] = \"Amount should not be greater than \" + maxAllowedAmount.toFixed(2);\n            setErrors({ ...errors });\n            haveErrors = true;\n        }\n        */\n\n      }\n    }\n\n    if (haveErrors) {\n      return false;\n    }\n\n    return true;\n  }\n\n  const StoreCreateFormRef = useRef();\n\n  function openStoreCreateForm() {\n    StoreCreateFormRef.current.open();\n  }\n\n  const ProductCreateFormRef = useRef();\n\n  function openProductCreateForm() {\n    ProductCreateFormRef.current.open();\n  }\n\n  function openProductUpdateForm(id) {\n    ProductCreateFormRef.current.open(id);\n  }\n\n  const VendorCreateFormRef = useRef();\n\n  function openVendorCreateForm() {\n    VendorCreateFormRef.current.open();\n  }\n\n  const UserCreateFormRef = useRef();\n\n  function openUserCreateForm() {\n    UserCreateFormRef.current.open();\n  }\n\n  const SignatureCreateFormRef = useRef();\n\n  function openSignatureCreateForm() {\n    SignatureCreateFormRef.current.open();\n  }\n\n  const ProductDetailsViewRef = useRef();\n\n  function openProductDetailsView(id) {\n    ProductDetailsViewRef.current.open(id);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(ProductView, {\n      ref: ProductDetailsViewRef,\n      openUpdateForm: openProductUpdateForm,\n      openCreateForm: openProductCreateForm\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1153,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ProductCreate, {\n      ref: ProductCreateFormRef,\n      showToastMessage: props.showToastMessage,\n      openDetailsView: openProductDetailsView\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1154,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(StoreCreate, {\n      ref: StoreCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1156,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(UserCreate, {\n      ref: UserCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1158,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SignatureCreate, {\n      ref: SignatureCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1159,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(VendorCreate, {\n      ref: VendorCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1160,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      show: show,\n      size: \"xl\",\n      fullscreen: true,\n      onHide: handleClose,\n      animation: false,\n      backdrop: \"static\",\n      scrollable: true,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        children: [/*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: formData.id ? \"Update Purchase #\" + formData.code : \"Create New Purchase\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1163,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col align-self-end text-end\",\n          children: [/*#__PURE__*/_jsxDEV(PurchasePreview, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1168,\n            columnNumber: 25\n          }, this), formData.id ? /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            onClick: () => {\n              handleClose();\n              props.openDetailsView(formData.id);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"bi bi-eye\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1173,\n              columnNumber: 29\n            }, this), \" View Detail\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1169,\n            columnNumber: 40\n          }, this) : \"\", \"\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            onClick: handleCreate,\n            children: [isProcessing ? /*#__PURE__*/_jsxDEV(Spinner, {\n              as: \"span\",\n              animation: \"border\",\n              size: \"sm\",\n              role: \"status\",\n              \"aria-hidden\": true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1178,\n              columnNumber: 33\n            }, this) + \" Creating...\" : \"\", formData.id ? \"Update\" : \"Create\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1176,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn-close\",\n            onClick: handleClose,\n            \"aria-label\": \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1192,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1167,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1162,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: [Object.keys(errors).length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: errors && Object.keys(errors).map((key, index) => {\n              return errors[key] ? /*#__PURE__*/_jsxDEV(\"li\", {\n                style: {\n                  color: \"red\"\n                },\n                children: errors[key]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1206,\n                columnNumber: 59\n              }, this) : \"\";\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1203,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1202,\n          columnNumber: 25\n        }, this) : \"\", /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"row g-3 needs-validation\",\n          onSubmit: handleCreate,\n          children: [!cookies.get('store_name') ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Purchase to Store*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1211,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(Typeahead, {\n                id: \"store_id\",\n                labelKey: \"name\",\n                isLoading: isStoresLoading,\n                isInvalid: errors.store_id ? true : false,\n                onChange: selectedItems => {\n                  errors.store_id = \"\";\n                  setErrors(errors);\n\n                  if (selectedItems.length === 0) {\n                    errors.store_id = \"Invalid Store selected\";\n                    setErrors(errors);\n                    setFormData({ ...formData\n                    });\n                    setSelectedStores([]);\n                    return;\n                  }\n\n                  formData.store_id = selectedItems[0].id;\n                  setFormData({ ...formData\n                  });\n                  setSelectedStores(selectedItems); //SetPriceOfAllProducts(selectedItems[0].id);\n                },\n                options: storeOptions,\n                placeholder: \"Select Store\",\n                selected: selectedStores,\n                highlightOnlyResult: true,\n                onInputChange: (searchTerm, e) => {\n                  suggestStores(searchTerm);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1214,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                hide: true.toString(),\n                onClick: openStoreCreateForm,\n                className: \"btn btn-outline-secondary btn-primary btn-sm\",\n                type: \"button\",\n                id: \"button-addon1\",\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-plus-lg\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1242,\n                  columnNumber: 185\n                }, this), \" New\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1242,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1245,\n                  columnNumber: 37\n                }, this), errors.store_id]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1244,\n                columnNumber: 33\n              }, this), formData.store_id && !errors.store_id && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"green\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-check-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1250,\n                  columnNumber: 41\n                }, this), \"Looks good!\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1249,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1213,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1210,\n            columnNumber: 55\n          }, this) : \"\", /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Purchase From Vendor*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1257,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Typeahead, {\n              id: \"vendor_id\",\n              labelKey: \"search_label\",\n              isLoading: isVendorsLoading,\n              isInvalid: errors.vendor_id ? true : false,\n              onChange: selectedItems => {\n                errors.vendor_id = \"\";\n                setErrors(errors);\n\n                if (selectedItems.length === 0) {\n                  errors.vendor_id = \"Invalid Vendor selected\";\n                  setErrors(errors);\n                  formData.vendor_id = \"\";\n                  setFormData({ ...formData\n                  });\n                  setSelectedVendors([]);\n                  return;\n                }\n\n                formData.vendor_id = selectedItems[0].id;\n                setFormData({ ...formData\n                });\n                setSelectedVendors(selectedItems);\n              },\n              options: vendorOptions,\n              placeholder: \"Type name or mob\",\n              selected: selectedVendors,\n              highlightOnlyResult: true,\n              onInputChange: (searchTerm, e) => {\n                suggestVendors(searchTerm);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1258,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              hide: true.toString(),\n              onClick: openVendorCreateForm,\n              className: \"btn btn-outline-secondary btn-primary btn-sm\",\n              type: \"button\",\n              id: \"button-addon1\",\n              children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-plus-lg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1286,\n                columnNumber: 182\n              }, this), \" New\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1286,\n              columnNumber: 29\n            }, this), errors.vendor_id && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: \"red\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-x-lg\",\n                children: \" \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1289,\n                columnNumber: 37\n              }, this), errors.vendor_id]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1288,\n              columnNumber: 33\n            }, this), formData.vendor_id && !errors.vendor_id && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: \"green\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-check-lg\",\n                children: \" \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1295,\n                columnNumber: 37\n              }, this), \"Looks good!\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1294,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1256,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Vendor Invoice No. (Optional)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1329,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                value: formData.vendor_invoice_no ? formData.vendor_invoice_no : \"\",\n                type: \"string\",\n                onChange: e => {\n                  errors[\"vendor_invoice_no\"] = \"\";\n                  setErrors({ ...errors\n                  });\n                  formData.vendor_invoice_no = e.target.value;\n                  setFormData({ ...formData\n                  });\n                  console.log(formData);\n                },\n                className: \"form-control\",\n                id: \"vendor_invoice_no\",\n                placeholder: \"Vendor Invoice No.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1332,\n                columnNumber: 33\n              }, this), errors.vendor_invoice_no && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1348,\n                  columnNumber: 41\n                }, this), errors.vendor_invoice_no]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1347,\n                columnNumber: 37\n              }, this), formData.vendor_invoice_no && !errors.rack && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"green\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-check-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1354,\n                  columnNumber: 41\n                }, this), \"Looks good!\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1353,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1331,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1328,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Date Time*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1362,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(DatePicker, {\n                id: \"date_str\",\n                selected: formData.date_str ? new Date(formData.date_str) : null,\n                value: formData.date_str ? format(new Date(formData.date_str), \"MMMM d, yyyy h:mm aa\") : null,\n                className: \"form-control\",\n                dateFormat: \"MMMM d, yyyy h:mm aa\",\n                showTimeSelect: true,\n                timeIntervals: \"1\",\n                onChange: value => {\n                  console.log(\"Value\", value);\n                  formData.date_str = value; // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n\n                  setFormData({ ...formData\n                  });\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1365,\n                columnNumber: 33\n              }, this), errors.date_str && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1386,\n                  columnNumber: 41\n                }, this), errors.date_str]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1385,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1364,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1361,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-12\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Product*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1394,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Typeahead, {\n              id: \"product_id\",\n              size: \"lg\",\n              labelKey: \"search_label\",\n              emptyLabel: \"\",\n              clearButton: true,\n              open: openProductSearchResult,\n              isLoading: isProductsLoading,\n              isInvalid: errors.product_id ? true : false,\n              onChange: selectedItems => {\n                if (selectedItems.length === 0) {\n                  errors[\"product_id\"] = \"Invalid Product selected\";\n                  setErrors(errors);\n                  return;\n                }\n\n                errors[\"product_id\"] = \"\";\n                setErrors({ ...errors\n                });\n\n                if (formData.store_id) {\n                  addProduct(selectedItems[0]);\n                }\n\n                setOpenProductSearchResult(false);\n              },\n              options: productOptions,\n              selected: selectedProduct,\n              placeholder: \"Search By Part No. / Name / Name in Arabic\",\n              highlightOnlyResult: true,\n              onInputChange: (searchTerm, e) => {\n                suggestProducts(searchTerm);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1397,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              hide: true.toString(),\n              onClick: openProductCreateForm,\n              className: \"btn btn-outline-secondary btn-primary btn-sm\",\n              type: \"button\",\n              id: \"button-addon1\",\n              children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-plus-lg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1429,\n                columnNumber: 183\n              }, this), \" New\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1429,\n              columnNumber: 29\n            }, this), errors.product_id ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: \"red\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-x-lg\",\n                children: \" \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1432,\n                columnNumber: 37\n              }, this), errors.product_id]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1431,\n              columnNumber: 33\n            }, this) : \"\", selectedProduct[0] && selectedProduct[0].id && !errors.product_id && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: \"green\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-check-lg\",\n                children: \" \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1440,\n                columnNumber: 41\n              }, this), \"Looks good!\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1439,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1393,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"table-responsive\",\n            style: {\n              overflowX: \"auto\",\n              maxHeight: \"400px\",\n              overflowY: \"auto\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"table table-striped table-sm table-bordered\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"text-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"2%\"\n                    },\n                    children: \"Remove\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1451,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"5%\"\n                    },\n                    children: \"SI No.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1452,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"8%\"\n                    },\n                    children: \"Part No.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1453,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"26%\"\n                    },\n                    className: \"text-start\",\n                    children: \"Name\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1454,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"11%\"\n                    },\n                    children: \"Qty\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1455,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"11%\"\n                    },\n                    children: \"Purchase Unit Price\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1456,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"11%\"\n                    },\n                    children: \"Wholesale Unit Price\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1457,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"11%\"\n                    },\n                    children: \"Retail Unit Price\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1458,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"15%\"\n                    },\n                    children: \"Purchase Price\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1459,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1450,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1449,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: selectedProducts.map((product, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"text-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\",\n                        cursor: \"pointer\"\n                      },\n                      onClick: () => {\n                        removeProduct(product);\n                      },\n                      children: /*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-x-lg\",\n                        children: \" \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1473,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1467,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1466,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: index + 1\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1476,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: product.part_number\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1477,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      textDecoration: \"underline\",\n                      color: \"blue\",\n                      cursor: \"pointer\"\n                    },\n                    className: \"text-start\",\n                    onClick: () => {\n                      openProductDetailsView(product.product_id);\n                      console.log(\"okk,id:\", product.product_id);\n                    },\n                    children: product.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1478,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"155px\"\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"input-group mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"number\",\n                        value: product.quantity,\n                        className: \"form-control\",\n                        placeholder: \"Quantity\",\n                        onChange: e => {\n                          errors[\"quantity_\" + index] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            errors[\"quantity_\" + index] = \"Invalid Quantity\";\n                            selectedProducts[index].quantity = e.target.value;\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          if (e.target.value === 0) {\n                            errors[\"quantity_\" + index] = \"Invalid Quantity should be > 0\";\n                            selectedProducts[index].quantity = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          product.quantity = parseFloat(e.target.value);\n                          reCalculate();\n                          selectedProducts[index].quantity = parseFloat(e.target.value);\n                          console.log(\"selectedProducts[index].quantity:\", selectedProducts[index].quantity);\n                          setSelectedProducts([...selectedProducts]);\n                          reCalculate();\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1492,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"input-group-text\",\n                        id: \"basic-addon2\",\n                        children: selectedProducts[index].unit ? selectedProducts[index].unit : \"Units\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1525,\n                        columnNumber: 53\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1491,\n                      columnNumber: 49\n                    }, this), errors[\"quantity_\" + index] && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-x-lg\",\n                        children: \" \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1529,\n                        columnNumber: 57\n                      }, this), errors[\"quantity_\" + index]]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1528,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1489,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"180px\"\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"input-group mb-3\",\n                      children: /*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"number\",\n                        value: product.purchase_unit_price,\n                        className: \"form-control\",\n                        placeholder: \"Purchase Unit Price\",\n                        onChange: e => {\n                          errors[\"purchase_unit_price_\" + index] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            errors[\"purchase_unit_price_\" + index] = \"Invalid Purchase Unit Price\";\n                            selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          if (e.target.value === 0) {\n                            errors[\"purchase_unit_price_\" + index] = \"Purchase Unit Price should be > 0\";\n                            selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                          console.log(\"selectedProducts[index].purchase_unit_price:\", selectedProducts[index].purchase_unit_price);\n                          setSelectedProducts([...selectedProducts]);\n                          reCalculate();\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1536,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1535,\n                      columnNumber: 49\n                    }, this), errors[\"purchase_unit_price_\" + index] && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-x-lg\",\n                        children: \" \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1570,\n                        columnNumber: 57\n                      }, this), errors[\"purchase_unit_price_\" + index]]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1569,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1534,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"180px\"\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"input-group mb-3\",\n                      children: /*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"number\",\n                        value: product.wholesale_unit_price,\n                        className: \"form-control\",\n                        placeholder: \"Wholesale Unit Price\",\n                        onChange: e => {\n                          errors[\"wholesale_unit_price_\" + index] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            errors[\"wholesale_unit_price_\" + index] = \"Invalid Wholesale Unit Price\";\n                            selectedProducts[index].wholesale_unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          if (e.target.value === 0) {\n                            errors[\"wholesale_unit_price_\" + index] = \"Wholesale Unit Price should be > 0\";\n                            selectedProducts[index].wholesale_unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          selectedProducts[index].wholesale_unit_price = parseFloat(e.target.value);\n                          console.log(\"selectedProducts[index].wholesale_unit_price:\", selectedProducts[index].wholesale_unit_price);\n                          setSelectedProducts([...selectedProducts]);\n                          reCalculate();\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1578,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1577,\n                      columnNumber: 49\n                    }, this), errors[\"wholesale_unit_price_\" + index] && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-x-lg\",\n                        children: \" \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1612,\n                        columnNumber: 57\n                      }, this), errors[\"wholesale_unit_price_\" + index]]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1611,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1576,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"180px\"\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"input-group mb-3\",\n                      children: /*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"number\",\n                        value: product.retail_unit_price,\n                        className: \"form-control\",\n                        placeholder: \"Retail Unit Price\",\n                        onChange: e => {\n                          errors[\"retail_unit_price_\" + index] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            errors[\"retail_unit_price_\" + index] = \"Invalid Retail Unit Price\";\n                            selectedProducts[index].retail_unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          if (e.target.value === 0) {\n                            errors[\"retail_unit_price_\" + index] = \"Retail Unit Price should be > 0\";\n                            selectedProducts[index].retail_unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          selectedProducts[index].retail_unit_price = parseFloat(e.target.value);\n                          console.log(\"selectedProducts[index].retail_unit_price:\", selectedProducts[index].retail_unit_price);\n                          setSelectedProducts([...selectedProducts]);\n                          reCalculate();\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1620,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1619,\n                      columnNumber: 49\n                    }, this), errors[\"retail_unit_price_\" + index] && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-x-lg\",\n                        children: \" \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1655,\n                        columnNumber: 57\n                      }, this), errors[\"retail_unit_price_\" + index]]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1654,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1618,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: (product.purchase_unit_price * product.quantity).toFixed(2),\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \"\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1662,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1661,\n                    columnNumber: 45\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1465,\n                  columnNumber: 41\n                }, this)).reverse()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1463,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1448,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1447,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"table-responsive\",\n            style: {\n              overflowX: \"auto\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"table table-striped table-sm table-bordered\",\n              children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"90%\"\n                    },\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1681,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"10%\"\n                    },\n                    className: \"text-end\",\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: totalPrice,\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \"\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1683,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1682,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1680,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: \"Shipping & Handling Fees\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1693,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      style: {\n                        width: \"150px\"\n                      },\n                      className: \"text-start\",\n                      value: formData.shipping_handling_fees,\n                      onChange: e => {\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.shipping_handling_fees = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"shipping_handling_fees\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.shipping_handling_fees = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"shipping_handling_fees\"] = \"Shipping / Handling Fees should be > 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.shipping_handling_fees = \"\";\n                          errors[\"shipping_handling_fees\"] = \"Invalid Shipping / Handling Fees\";\n                          setFormData({ ...formData\n                          });\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"shipping_handling_fees\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.shipping_handling_fees = parseFloat(e.target.value);\n                        setFormData({ ...formData\n                        });\n                        reCalculate();\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1697,\n                      columnNumber: 45\n                    }, this), \"\", errors.shipping_handling_fees && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.shipping_handling_fees\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1734,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1696,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1692,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: [\"Discount  \", /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      style: {\n                        width: \"50px\"\n                      },\n                      className: \"text-start\",\n                      value: formData.discount_percent,\n                      onChange: e => {\n                        formData.is_discount_percent = true;\n\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.discount_percent = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount_percent\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.discount_percent = parseFloat(e.target.value);\n                          formData.discount = 0.00;\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount_percent\"] = \"Discount percent should be >= 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.discount_percent = \"\";\n                          formData.discount = 0.00;\n                          errors[\"discount_percent\"] = \"Invalid Discount Percent\";\n                          setFormData({ ...formData\n                          });\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"discount_percent\"] = \"\";\n                        errors[\"discount\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.discount_percent = parseFloat(e.target.value);\n                        setFormData({ ...formData\n                        });\n                        reCalculate();\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1742,\n                      columnNumber: 55\n                    }, this), \"%\", errors.discount_percent && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.discount_percent\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1781,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1741,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      style: {\n                        width: \"150px\"\n                      },\n                      className: \"text-start\",\n                      value: formData.discount,\n                      onChange: e => {\n                        formData.is_discount_percent = false;\n\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.discount = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.discount = parseFloat(e.target.value);\n                          formData.discount_percent = 0.00;\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount\"] = \"Discount should be >= 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.discount = \"\";\n                          formData.discount_percent = 0.00;\n                          errors[\"discount\"] = \"Invalid Discount\";\n                          setFormData({ ...formData\n                          });\n                          reCalculate();\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"discount\"] = \"\";\n                        errors[\"discount_percent\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.discount = parseFloat(e.target.value);\n                        setFormData({ ...formData\n                        });\n                        reCalculate();\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1787,\n                      columnNumber: 45\n                    }, this), \"\", errors.discount && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.discount\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1828,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1786,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1740,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: [\" VAT  \", /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      className: \"text-center\",\n                      style: {\n                        width: \"50px\"\n                      },\n                      value: formData.vat_percent,\n                      onChange: e => {\n                        console.log(\"Inside onchange vat percent\");\n\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.vat_percent = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"vat_percent\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.vat_percent = parseFloat(e.target.value);\n                          vatPrice = 0.00;\n                          setVatPrice(vatPrice);\n                          setFormData({ ...formData\n                          });\n                          errors[\"vat_percent\"] = \"Vat percent should be >= 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.vat_percent = \"\";\n                          vatPrice = 0.00;\n                          setVatPrice(vatPrice); //formData.discount_percent = 0.00;\n\n                          errors[\"vat_percent\"] = \"Invalid vat percent\";\n                          setFormData({ ...formData\n                          });\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"vat_percent\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.vat_percent = e.target.value;\n                        reCalculate();\n                        setFormData({ ...formData\n                        });\n                        console.log(formData);\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1836,\n                      columnNumber: 84\n                    }, this), \"%\", errors.vat_percent && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.vat_percent\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1877,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1836,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: vatPrice,\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \"\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1883,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1882,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1834,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: \"Net Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1894,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"text-end\",\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: netTotal,\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \"\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1896,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1895,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1892,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1679,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1678,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1677,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Cash discount\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1910,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: formData.cash_discount,\n              className: \"form-control \",\n              onChange: e => {\n                errors[\"cash_discount\"] = \"\";\n                setErrors({ ...errors\n                });\n\n                if (!e.target.value) {\n                  formData.cash_discount = e.target.value;\n                  setFormData({ ...formData\n                  });\n                  validatePaymentAmounts();\n                  return;\n                }\n\n                formData.cash_discount = parseFloat(e.target.value);\n\n                if (formData.cash_discount > 0 && formData.cash_discount >= netTotal) {\n                  errors[\"cash_discount\"] = \"Cash discount should not be >= \" + netTotal.toString();\n                  setErrors({ ...errors\n                  });\n                  return;\n                }\n\n                setFormData({ ...formData\n                });\n                validatePaymentAmounts();\n                console.log(formData);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1911,\n              columnNumber: 29\n            }, this), errors.cash_discount && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: \"red\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-x-lg\",\n                children: \" \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1935,\n                columnNumber: 37\n              }, this), errors.cash_discount]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1934,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1909,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Payments Paid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1942,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"table-responsive\",\n              style: {\n                maxWidth: \"900px\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                variant: \"secondary\",\n                style: {\n                  alignContent: \"right\",\n                  marginBottom: \"10px\"\n                },\n                onClick: addNewPayment,\n                children: \"Create new payment\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1945,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n                class: \"table table-striped table-sm table-bordered\",\n                children: [formData.payments_input && formData.payments_input.length > 0 && /*#__PURE__*/_jsxDEV(\"thead\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Date\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1951,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Amount\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1954,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Payment method\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1957,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    children: \"Action\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1960,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1950,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                  children: [formData.payments_input && formData.payments_input.filter(payment => !payment.deleted).map((payment, key) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                      style: {\n                        minWidth: \"220px\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(DatePicker, {\n                        id: \"payment_date_str\",\n                        selected: formData.payments_input[key].date_str ? new Date(formData.payments_input[key].date_str) : null,\n                        value: formData.payments_input[key].date_str ? format(new Date(formData.payments_input[key].date_str), \"MMMM d, yyyy h:mm aa\") : null,\n                        className: \"form-control\",\n                        dateFormat: \"MMMM d, yyyy h:mm aa\",\n                        showTimeSelect: true,\n                        timeIntervals: \"1\",\n                        onChange: value => {\n                          console.log(\"Value\", value);\n                          formData.payments_input[key].date_str = value;\n                          setFormData({ ...formData\n                          });\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1970,\n                        columnNumber: 57\n                      }, this), errors[\"payment_date_\" + key] && /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          color: \"red\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                          className: \"bi bi-x-lg\",\n                          children: \" \"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1989,\n                          columnNumber: 65\n                        }, this), errors[\"payment_date_\" + key]]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1988,\n                        columnNumber: 61\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1968,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      style: {\n                        width: \"300px\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"number\",\n                        value: formData.payments_input[key].amount,\n                        className: \"form-control \",\n                        onChange: e => {\n                          errors[\"payment_amount_\" + key] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            formData.payments_input[key].amount = e.target.value;\n                            setFormData({ ...formData\n                            });\n                            validatePaymentAmounts();\n                            return;\n                          }\n\n                          formData.payments_input[key].amount = parseFloat(e.target.value);\n                          validatePaymentAmounts();\n                          setFormData({ ...formData\n                          });\n                          console.log(formData);\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1995,\n                        columnNumber: 57\n                      }, this), errors[\"payment_amount_\" + key] && /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          color: \"red\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                          className: \"bi bi-x-lg\",\n                          children: \" \"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2016,\n                          columnNumber: 65\n                        }, this), errors[\"payment_amount_\" + key]]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2015,\n                        columnNumber: 61\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1994,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      style: {\n                        width: \"200px\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                        value: formData.payments_input[key].method,\n                        className: \"form-control \",\n                        onChange: e => {\n                          // errors[\"payment_method\"] = [];\n                          errors[\"payment_method_\" + key] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            errors[\"payment_method_\" + key] = \"Payment method is required\";\n                            setErrors({ ...errors\n                            });\n                            formData.payments_input[key].method = \"\";\n                            setFormData({ ...formData\n                            });\n                            return;\n                          } // errors[\"payment_method\"] = \"\";\n                          //setErrors({ ...errors });\n\n\n                          formData.payments_input[key].method = e.target.value;\n                          setFormData({ ...formData\n                          });\n                          console.log(formData);\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"\",\n                          children: \"Select\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2045,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"cash\",\n                          children: \"Cash\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2046,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"bank_account\",\n                          children: \"Bank Account / Debit / Credit Card\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2047,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: \"vendor_account\",\n                          children: \"Vendor Account\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2048,\n                          columnNumber: 61\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2022,\n                        columnNumber: 57\n                      }, this), errors[\"payment_method_\" + key] && /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          color: \"red\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                          className: \"bi bi-x-lg\",\n                          children: \" \"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2052,\n                          columnNumber: 65\n                        }, this), errors[\"payment_method_\" + key]]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2051,\n                        columnNumber: 61\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2021,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      style: {\n                        width: \"200px\"\n                      },\n                      children: /*#__PURE__*/_jsxDEV(Button, {\n                        variant: \"danger\",\n                        onClick: event => {\n                          removePayment(key);\n                        },\n                        children: \"Remove\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2058,\n                        columnNumber: 57\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2057,\n                      columnNumber: 53\n                    }, this)]\n                  }, key, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1967,\n                    columnNumber: 49\n                  }, this)), /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                      class: \"text-end\",\n                      children: /*#__PURE__*/_jsxDEV(\"b\", {\n                        children: \"Total\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2069,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2068,\n                      columnNumber: 45\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: /*#__PURE__*/_jsxDEV(\"b\", {\n                        style: {\n                          marginLeft: \"14px\"\n                        },\n                        children: (_totalPaymentAmount = totalPaymentAmount) === null || _totalPaymentAmount === void 0 ? void 0 : _totalPaymentAmount.toFixed(2)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2071,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2071,\n                      columnNumber: 45\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      children: /*#__PURE__*/_jsxDEV(\"b\", {\n                        style: {\n                          marginLeft: \"12px\",\n                          alignSelf: \"end\"\n                        },\n                        children: [\"Balance: \", (_balanceAmount = balanceAmount) === null || _balanceAmount === void 0 ? void 0 : _balanceAmount.toFixed(2)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2075,\n                        columnNumber: 49\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2074,\n                      columnNumber: 45\n                    }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                      colSpan: 1,\n                      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                        children: \"Payment status: \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2078,\n                        columnNumber: 49\n                      }, this), paymentStatus == \"paid\" ? /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"badge bg-success\",\n                        children: \"Paid\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2080,\n                        columnNumber: 53\n                      }, this) : \"\", paymentStatus == \"paid_partially\" ? /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"badge bg-warning\",\n                        children: \"Paid Partially\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2084,\n                        columnNumber: 53\n                      }, this) : \"\", paymentStatus == \"not_paid\" ? /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"badge bg-danger\",\n                        children: \"Not Paid\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2088,\n                        columnNumber: 53\n                      }, this) : \"\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2077,\n                      columnNumber: 45\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2067,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1964,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1948,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1944,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1941,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              variant: \"secondary\",\n              onClick: handleClose,\n              children: \"Close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2101,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"primary\",\n              onClick: handleCreate,\n              children: isProcessing ? /*#__PURE__*/_jsxDEV(Spinner, {\n                as: \"span\",\n                animation: \"border\",\n                size: \"sm\",\n                role: \"status\",\n                \"aria-hidden\": true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2106,\n                columnNumber: 37\n              }, this) + \" Creating...\" : formData.id ? \"Update\" : \"Create\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2104,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2100,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1209,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1200,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1161,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}, \"oP6mk8DVEDD6+DLiB9xpLwsIErA=\", false, function () {\n  return [useImperativeHandle];\n}));\n_c2 = PurchaseCreate;\nexport default PurchaseCreate;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"PurchaseCreate$forwardRef\");\n$RefreshReg$(_c2, \"PurchaseCreate\");","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/purchase/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","PurchasePreview","Modal","Button","Form","StoreCreate","VendorCreate","ProductCreate","UserCreate","SignatureCreate","Cookies","Typeahead","NumberFormat","DatePicker","format","Spinner","PurchaseView","ProductView","DebounceInput","PurchaseCreate","props","ref","open","id","selectedProducts","setSelectedProducts","selectedStores","setSelectedStores","selectedVendors","setSelectedVendors","selectedOrderPlacedByUsers","setSelectedOrderPlacedByUsers","selectedOrderPlacedBySignatures","setSelectedOrderPlacedBySignatures","formData","vat_percent","discount","discountValue","discount_percent","shipping_handling_fees","partial_payment_amount","is_discount_percent","date_str","Date","signature_date_str","status","payment_method","payment_status","payments_input","cash_discount","cookies","get","store_id","store_name","name","order_placed_by","parseFloat","setFormData","getPurchase","reCalculate","setShow","listener","event","code","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","preventDefault","document","addEventListener","removeEventListener","selectedDate","errors","setErrors","isProcessing","setProcessing","storeOptions","setStoreOptions","isStoresLoading","setIsStoresLoading","vendorOptions","setVendorOptions","isVendorsLoading","setIsVendorsLoading","productOptions","setProductOptions","selectedProduct","setSelectedProduct","isProductsLoading","setIsProductsLoading","orderPlacedByUserOptions","setOrderPlacedByUserOptions","isOrderPlacedByUsersLoading","setIsOrderPlacedByUsersLoading","orderPlacedBySignatureOptions","setOrderPlacedBySignatureOptions","isOrderPlacedBySignaturesLoading","setIsOrderPlacedBySignaturesLoading","show","handleClose","at","window","location","requestOptions","method","headers","fetch","then","response","isJson","data","json","ok","error","Promise","reject","purchase","result","vendor_id","date","order_placed_by_signature_id","payments","i","length","products","vendor_name","search_label","order_placed_by_name","order_placed_by_signature_name","catch","ObjectToSearchQueryParams","object","Object","keys","map","key","encodeURIComponent","join","suggestStores","searchTerm","params","queryString","Authorization","Select","suggestVendors","GetProductUnitPriceInStore","storeId","productStores","purchase_unit_price","openProductSearchResult","setOpenProductSearchResult","suggestProducts","getProductByBarCode","barcode","slice","product","addProduct","suggestUsers","suggestSignatures","handleCreate","push","product_id","quantity","unit","retail_unit_price","wholesale_unit_price","net_total","netTotal","endPoint","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","isProductAdded","productID","productStore","product_stores","alreadyAdded","getProductIndex","item","item_code","part_number","toFixed","removeProduct","quantity_returned","splice","totalPrice","setTotalPrice","findTotalPrice","vatPrice","setVatPrice","findVatPrice","setNetTotal","findNetTotal","RoundFloat","amount","validatePaymentAmounts","val","precision","ratio","Math","pow","round","discountPercent","setDiscountPercent","findDiscountPercent","findDiscount","addNewPayment","findTotalPayments","totalPayment","deleted","totalPaymentAmount","setTotalPaymentAmount","balanceAmount","setBalanceAmount","paymentStatus","setPaymentStatus","removePayment","validatePayments","haveErrors","toString","maxAllowedAmount","StoreCreateFormRef","openStoreCreateForm","current","ProductCreateFormRef","openProductCreateForm","openProductUpdateForm","VendorCreateFormRef","openVendorCreateForm","UserCreateFormRef","openUserCreateForm","SignatureCreateFormRef","openSignatureCreateForm","ProductDetailsViewRef","openProductDetailsView","color","selectedItems","e","vendor_invoice_no","value","rack","overflowX","maxHeight","overflowY","width","cursor","textDecoration","reverse","maxWidth","alignContent","marginBottom","filter","payment","minWidth","marginLeft","alignSelf"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport PurchasePreview from \"./preview.js\";\nimport { Modal, Button, Form } from \"react-bootstrap\";\nimport StoreCreate from \"../store/create.js\";\nimport VendorCreate from \"./../vendor/create.js\";\nimport ProductCreate from \"./../product/create.js\";\nimport UserCreate from \"./../user/create.js\";\nimport SignatureCreate from \"./../signature/create.js\";\nimport Cookies from \"universal-cookie\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport NumberFormat from \"react-number-format\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\nimport { Spinner } from \"react-bootstrap\";\nimport PurchaseView from \"./view.js\";\nimport ProductView from \"./../product/view.js\";\nimport { DebounceInput } from 'react-debounce-input';\n\n\nconst PurchaseCreate = forwardRef((props, ref) => {\n\n    useImperativeHandle(ref, () => ({\n        open(id) {\n\n            selectedProducts = [];\n            setSelectedProducts([]);\n\n            selectedStores = [];\n            setSelectedStores([]);\n\n            selectedVendors = [];\n            setSelectedVendors([]);\n\n            selectedOrderPlacedByUsers = [];\n            setSelectedOrderPlacedByUsers([]);\n\n            selectedOrderPlacedBySignatures = [];\n            setSelectedOrderPlacedBySignatures([]);\n\n\n            formData = {\n                vat_percent: 15.0,\n                discount: 0.0,\n                discountValue: 0.0,\n                discount_percent: 0.0,\n                shipping_handling_fees: 0.00,\n                partial_payment_amount: 0.00,\n                is_discount_percent: false,\n                date_str: new Date(),\n                signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n                status: \"delivered\",\n                payment_method: \"\",\n                payment_status: \"paid\",\n\n            };\n\n            formData.payments_input = [\n                {\n                    \"date_str\": formData.date_str,\n                    // \"amount\": \"\",\n                    \"amount\": 0.00,\n                    \"method\": \"\",\n                    \"deleted\": false,\n                }\n            ];\n            formData.cash_discount = 0.00;\n\n\n            if (cookies.get('store_id')) {\n                formData.store_id = cookies.get('store_id');\n                formData.store_name = cookies.get('store_name');\n            }\n\n            if (cookies.get(\"user_id\")) {\n                selectedOrderPlacedByUsers = [{\n                    id: cookies.get(\"user_id\"),\n                    name: cookies.get(\"user_name\"),\n                }];\n                formData.order_placed_by = cookies.get(\"user_id\");\n                formData.vat_percent = parseFloat(cookies.get('vat_percent'));\n                setFormData({ ...formData });\n                setSelectedOrderPlacedByUsers([...selectedOrderPlacedByUsers]);\n            }\n\n            setFormData({ ...formData });\n\n            if (id) {\n                getPurchase(id);\n            }\n            reCalculate();\n            setShow(true);\n        },\n\n    }));\n\n    useEffect(() => {\n        const listener = event => {\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n                console.log(\"Enter key was pressed. Run your function-purchase.\");\n                // event.preventDefault();\n\n                var form = event.target.form;\n                if (form && event.target) {\n                    var index = Array.prototype.indexOf.call(form, event.target);\n                    if (form && form.elements[index + 1]) {\n                        if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n                            form.elements[index].focus();\n                        } else {\n                            form.elements[index + 1].focus();\n                        }\n                        event.preventDefault();\n                    }\n                }\n            }\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => {\n            document.removeEventListener(\"keydown\", listener);\n        };\n    }, []);\n\n\n    useEffect(() => {\n        console.log(\"inside change on formData:\", formData);\n        // localStorage\n\n    });\n\n\n    const selectedDate = new Date();\n\n    //const history = useHistory();\n    let [errors, setErrors] = useState({});\n    const [isProcessing, setProcessing] = useState(false);\n    const cookies = new Cookies();\n\n    //fields\n    let [formData, setFormData] = useState({\n        vat_percent: 10.0,\n        discount: 0.0,\n        discountValue: 0.0,\n        discount_percent: 0.0,\n        is_discount_percent: false,\n        date_str: format(new Date(), \"MMM dd yyyy\"),\n        signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n        status: \"created\",\n    });\n\n    //Store Auto Suggestion\n    const [storeOptions, setStoreOptions] = useState([]);\n    let [selectedStores, setSelectedStores] = useState([]);\n    const [isStoresLoading, setIsStoresLoading] = useState(false);\n\n    //Vendor Auto Suggestion\n    const [vendorOptions, setVendorOptions] = useState([]);\n    let [selectedVendors, setSelectedVendors] = useState([]);\n    const [isVendorsLoading, setIsVendorsLoading] = useState(false);\n\n    //Product Auto Suggestion\n    const [productOptions, setProductOptions] = useState([]);\n    let [selectedProduct, setSelectedProduct] = useState([]);\n    let [selectedProducts, setSelectedProducts] = useState([]);\n    const [isProductsLoading, setIsProductsLoading] = useState(false);\n\n    //Order Placed By Auto Suggestion\n    const [orderPlacedByUserOptions, setOrderPlacedByUserOptions] = useState([]);\n    let [selectedOrderPlacedByUsers, setSelectedOrderPlacedByUsers] = useState([]);\n    const [isOrderPlacedByUsersLoading, setIsOrderPlacedByUsersLoading] = useState(false);\n\n    //Order Placed By Signature Auto Suggestion\n    const [orderPlacedBySignatureOptions, setOrderPlacedBySignatureOptions] =\n        useState([]);\n    let [selectedOrderPlacedBySignatures, setSelectedOrderPlacedBySignatures] =\n        useState([]);\n    const [isOrderPlacedBySignaturesLoading, setIsOrderPlacedBySignaturesLoading] =\n        useState(false);\n\n    const [show, setShow] = useState(false);\n\n    function handleClose() {\n        setShow(false);\n    }\n\n    useEffect(() => {\n        let at = cookies.get(\"access_token\");\n        if (!at) {\n            // history.push(\"/dashboard/purchases\");\n            window.location = \"/\";\n        }\n    });\n\n\n    function getPurchase(id) {\n        console.log(\"inside get Purchase\");\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n\n        fetch('/v1/purchase/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n                console.log(\"Response:\");\n                console.log(data);\n\n                let purchase = data.result;\n                formData = {\n                    id: purchase.id,\n                    code: purchase.code,\n                    store_id: purchase.store_id,\n                    vendor_id: purchase.vendor_id,\n                    date_str: purchase.date,\n                    // date: purchase.date,\n                    vat_percent: purchase.vat_percent,\n                    discount: purchase.discount,\n                    cash_discount: purchase.cash_discount,\n                    discount_percent: purchase.discount_percent,\n                    status: purchase.status,\n                    order_placed_by: purchase.order_placed_by,\n                    order_placed_by_signature_id: purchase.order_placed_by_signature_id,\n                    is_discount_percent: purchase.is_discount_percent,\n                    partial_payment_amount: purchase.partial_payment_amount,\n                    payment_method: purchase.payment_method,\n                    payment_status: purchase.payment_status,\n                    shipping_handling_fees: purchase.shipping_handling_fees,\n                };\n\n                if (data.result.payments) {\n                    console.log(\"data.result.payments:\", data.result.payments);\n                    formData.payments_input = data.result.payments;\n                    for (var i = 0; i < formData.payments_input?.length; i++) {\n                        formData.payments_input[i].date_str = formData.payments_input[i].date\n                    }\n                }\n\n                if (formData.is_discount_percent) {\n                    formData.discountValue = formData.discount_percent;\n                } else {\n                    formData.discountValue = formData.discount;\n                }\n\n                selectedProducts = purchase.products;\n                setSelectedProducts([...selectedProducts]);\n\n\n                let selectedStores = [\n                    {\n                        id: purchase.store_id,\n                        name: purchase.store_name,\n                    }\n                ];\n\n                let selectedVendors = [\n                    {\n                        id: purchase.vendor_id,\n                        name: purchase.vendor_name,\n                        search_label: purchase.vendor_name,\n                    }\n                ];\n\n                let selectedOrderPlacedByUsers = [\n                    {\n                        id: purchase.order_placed_by,\n                        name: purchase.order_placed_by_name\n                    }\n                ];\n\n                if (purchase.order_placed_by_signature_id) {\n                    let selectedOrderPlacedBySignatures = [\n                        {\n                            id: purchase.order_placed_by_signature_id,\n                            name: purchase.order_placed_by_signature_name,\n                        }\n                    ];\n\n                    setSelectedOrderPlacedBySignatures([...selectedOrderPlacedBySignatures]);\n                }\n\n                setSelectedOrderPlacedByUsers([...selectedOrderPlacedByUsers]);\n\n                setSelectedStores([...selectedStores]);\n                setSelectedVendors([...selectedVendors]);\n\n                reCalculate();\n                setFormData({ ...formData });\n\n\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n    function ObjectToSearchQueryParams(object) {\n        return Object.keys(object)\n            .map(function (key) {\n                return `search[${key}]=` + encodeURIComponent(object[key]);\n            })\n            .join(\"&\");\n    }\n\n    async function suggestStores(searchTerm) {\n        console.log(\"Inside handle suggestStores\");\n        setStoreOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsStoresLoading(true);\n        let result = await fetch(\n            \"/v1/store?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setStoreOptions(data.result);\n        setIsStoresLoading(false);\n    }\n\n    async function suggestVendors(searchTerm) {\n        console.log(\"Inside handle suggestVendors\");\n        setVendorOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name,phone,name_in_arabic,phone_in_arabic,search_label\";\n        setIsVendorsLoading(true);\n        let result = await fetch(\n            \"/v1/vendor?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setVendorOptions(data.result);\n        setIsVendorsLoading(false);\n    }\n\n    function GetProductUnitPriceInStore(storeId, productStores) {\n        console.log(\"Inside GetProductUnitPriceInStore\");\n        if (!productStores) {\n            return \"\";\n        }\n        console.log(\"Cool\")\n\n        for (var i = 0; i < productStores.length; i++) {\n            console.log(\"productStores[i]:\", productStores[i]);\n            console.log(\"store_id:\", storeId);\n\n            if (productStores[i].store_id === storeId) {\n                console.log(\"macthed\");\n                console.log(\n                    \"unitPrice.retail_unit_price:\",\n                    productStores[i].purchase_unit_price\n                );\n                return productStores[i];\n            }\n        }\n        console.log(\"not matched\");\n        return \"\";\n    }\n\n    let [openProductSearchResult, setOpenProductSearchResult] = useState(false);\n\n    async function suggestProducts(searchTerm) {\n        console.log(\"Inside handle suggestProducts\");\n        setProductOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            openProductSearchResult = false;\n            setOpenProductSearchResult(false);\n            setIsProductsLoading(false);\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n\n        if (cookies.get(\"store_id\")) {\n            params.store_id = cookies.get(\"store_id\");\n        }\n\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,item_code,bar_code,name,product_stores,unit,part_number,name_in_arabic\";\n        setIsProductsLoading(true);\n        let result = await fetch(\n            \"/v1/product?\" + Select + queryString + \"&limit=200\",\n            requestOptions\n        );\n        let data = await result.json();\n\n        let products = data.result;\n        if (!products || products.length === 0) {\n            openProductSearchResult = false;\n            setOpenProductSearchResult(false);\n            setIsProductsLoading(false);\n            return;\n        }\n\n\n\n        openProductSearchResult = true;\n        setOpenProductSearchResult(true);\n        setProductOptions(products);\n        setIsProductsLoading(false);\n    }\n\n    async function getProductByBarCode(barcode) {\n        formData.barcode = barcode;\n        setFormData({ ...formData });\n        console.log(\"Inside getProductByBarCode\");\n        errors[\"bar_code\"] = \"\";\n        setErrors({ ...errors });\n\n        console.log(\"barcode:\" + formData.barcode);\n        if (!formData.barcode) {\n            return;\n        }\n\n        if (formData.barcode.length === 13) {\n            formData.barcode = formData.barcode.slice(0, -1);\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n\n        let Select = \"select=id,item_code,bar_code,part_number,name,product_stores,unit,part_number,name_in_arabic\";\n        let result = await fetch(\n            \"/v1/product/barcode/\" + formData.barcode + \"?\" + Select,\n            requestOptions\n        );\n        let data = await result.json();\n\n\n        let product = data.result;\n        if (product) {\n            addProduct(product);\n        } else {\n            errors[\"bar_code\"] = \"Invalid Barcode:\" + formData.barcode\n            setErrors({ ...errors });\n        }\n\n        formData.barcode = \"\";\n        setFormData({ ...formData });\n\n    }\n\n    async function suggestUsers(searchTerm) {\n        console.log(\"Inside handle suggestUsers\");\n        setOrderPlacedByUserOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsOrderPlacedByUsersLoading(true);\n        let result = await fetch(\n            \"/v1/user?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setOrderPlacedByUserOptions(data.result);\n        setIsOrderPlacedByUsersLoading(false);\n    }\n\n    async function suggestSignatures(searchTerm) {\n        console.log(\"Inside handle suggestSignatures\");\n        setOrderPlacedBySignatureOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsOrderPlacedBySignaturesLoading(true);\n        let result = await fetch(\n            \"/v1/signature?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setOrderPlacedBySignatureOptions(data.result);\n        setIsOrderPlacedBySignaturesLoading(false);\n    }\n\n    function handleCreate(event) {\n        event.preventDefault();\n        console.log(\"Inside handle Create\");\n        console.log(\"selectedProducts:\", selectedProducts);\n\n        if (!formData.cash_discount) {\n            formData.cash_discount = 0.00;\n        }\n\n        formData.products = [];\n        for (var i = 0; i < selectedProducts.length; i++) {\n            formData.products.push({\n                product_id: selectedProducts[i].product_id,\n                quantity: parseFloat(selectedProducts[i].quantity),\n                unit: selectedProducts[i].unit,\n                purchase_unit_price: parseFloat(selectedProducts[i].purchase_unit_price),\n                retail_unit_price: parseFloat(selectedProducts[i].retail_unit_price),\n                wholesale_unit_price: parseFloat(selectedProducts[i].wholesale_unit_price),\n            });\n        }\n\n        formData.discount = parseFloat(formData.discount);\n        formData.discount_percent = parseFloat(formData.discount_percent);\n        formData.vat_percent = parseFloat(formData.vat_percent);\n        formData.net_total = parseFloat(netTotal);\n        console.log(\"formData.discount:\", formData.discount);\n        console.log(\"formData.discount_percent:\", formData.discount_percent);\n\n        if (!formData.shipping_handling_fees && formData.shipping_handling_fees !== 0) {\n            errors[\"shipping_handling_fees\"] = \"Invalid shipping / handling fees\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (!formData.discount && formData.discount !== 0) {\n            errors[\"discount\"] = \"Invalid discount\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (!formData.discount_percent && formData.discount_percent !== 0) {\n            errors[\"discount_percent\"] = \"Invalid discount percent\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (parseFloat(formData.discount_percent) > 100) {\n            errors[\"discount_percent\"] = \"Discount percent cannot be > 100\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (!formData.vat_percent && formData.vat_percent !== 0) {\n            errors[\"vat_percent\"] = \"Invalid vat percent\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (cookies.get('store_id')) {\n            formData.store_id = cookies.get('store_id');\n        }\n\n        let endPoint = \"/v1/purchase\";\n        let method = \"POST\";\n        if (formData.id) {\n            endPoint = \"/v1/purchase/\" + formData.id;\n            method = \"PUT\";\n        }\n\n\n        const requestOptions = {\n            method: method,\n            headers: {\n                'Accept': 'application/json',\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n            body: JSON.stringify(formData),\n        };\n\n        setProcessing(true);\n        fetch(endPoint, requestOptions)\n            .then(async (response) => {\n                const isJson = response.headers\n                    .get(\"content-type\")\n                    ?.includes(\"application/json\");\n                const data = isJson && (await response.json());\n\n                // check for error response\n                if (!response.ok) {\n                    // get error message from body or default to response status\n                    const error = data && data.errors;\n                    //const error = data.errors\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n                setProcessing(false);\n\n                console.log(\"Response:\");\n                console.log(data);\n                props.showToastMessage(\"Purchase Created Successfully!\", \"success\");\n                if (props.refreshList) {\n                    props.refreshList();\n                }\n                handleClose();\n                props.openDetailsView(data.result.id);\n            })\n            .catch((error) => {\n                setProcessing(false);\n                console.log(\"Inside catch\");\n                console.log(error);\n                setErrors({ ...error });\n                console.error(\"There was an error!\", error);\n                props.showToastMessage(\"Error Creating Purchase!\", \"danger\");\n            });\n    }\n\n    function isProductAdded(productID) {\n        for (var i = 0; i < selectedProducts.length; i++) {\n            if (selectedProducts[i].product_id === productID) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    function addProduct(product) {\n        console.log(\"Inside Add product\");\n        if (!formData.store_id) {\n            errors.product_id = \"Please Select a Store and try again\";\n            setErrors({ ...errors });\n            return;\n        }\n\n\n        errors.product_id = \"\";\n        if (!product) {\n            errors.product_id = \"Invalid Product\";\n            setErrors({ ...errors });\n            return;\n        }\n        let productStore = {};\n\n        if (product.product_stores) {\n            /*\n            productStore = GetProductUnitPriceInStore(\n                formData.store_id,\n                product.stores\n            );\n            */\n            if (product.product_stores[formData.store_id]) {\n                product.retail_unit_price = product.product_stores[formData.store_id].retail_unit_price;\n            }\n\n            if (product.product_stores[formData.store_id]) {\n                //product.purchase_unit_price = productStore.purchase_unit_price;\n                product.purchase_unit_price = product.product_stores[formData.store_id].purchase_unit_price;\n            }\n\n            if (product.product_stores[formData.store_id]) {\n                // product.wholesale_unit_price = productStore.wholesale_unit_price;\n                product.wholesale_unit_price = product.product_stores[formData.store_id].wholesale_unit_price;\n            }\n        }\n\n\n\n\n        let alreadyAdded = false;\n        let index = -1;\n        let quantity = 0.00;\n        product.quantity = 1.00;\n\n        if (isProductAdded(product.id)) {\n            alreadyAdded = true;\n            index = getProductIndex(product.id);\n            quantity = parseFloat(selectedProducts[index].quantity + product.quantity);\n        } else {\n            quantity = parseFloat(product.quantity);\n        }\n\n        console.log(\"quantity:\", quantity);\n\n        errors.quantity = \"\";\n\n        if (alreadyAdded) {\n            selectedProducts[index].quantity = parseFloat(quantity);\n            // setSelectedProducts([...selectedProducts]);\n        }\n\n        if (!alreadyAdded) {\n            let item = {\n                product_id: product.id,\n                code: product.item_code,\n                part_number: product.part_number,\n                name: product.name,\n                quantity: product.quantity,\n                product_stores: product.product_stores,\n                unit: product.unit,\n            };\n\n            if (product.purchase_unit_price) {\n                item.purchase_unit_price = parseFloat(product.purchase_unit_price).toFixed(2);\n            }\n\n            if (product.retail_unit_price) {\n                item.retail_unit_price = parseFloat(product.retail_unit_price).toFixed(2);\n            }\n\n            if (product.wholesale_unit_price) {\n                item.wholesale_unit_price = parseFloat(product.wholesale_unit_price).toFixed(2);\n            }\n\n            selectedProducts.push(item);\n\n        }\n        setSelectedProducts([...selectedProducts]);\n        reCalculate();\n\n        formData.products = [];\n        for (var i = 0; i < selectedProducts.length; i++) {\n            formData.products.push({\n                product_id: selectedProducts[i].product_id,\n                quantity: parseFloat(selectedProducts[i].quantity),\n                unit: selectedProducts[i].unit,\n                purchase_unit_price: parseFloat(selectedProducts[i].purchase_unit_price),\n                retail_unit_price: parseFloat(selectedProducts[i].retail_unit_price),\n                wholesale_unit_price: parseFloat(selectedProducts[i].wholesale_unit_price),\n            });\n        }\n        setFormData({ ...formData });\n    }\n\n    function getProductIndex(productID) {\n        for (var i = 0; i < selectedProducts.length; i++) {\n            if (selectedProducts[i].product_id === productID) {\n                return i;\n            }\n        }\n        return false;\n    }\n\n    function removeProduct(product) {\n        if (product.quantity_returned > 0) {\n            errors[\"product_\" + index] = \"This product cannot be removed as it is returned, Note: Please remove the product from purchase return and try again\"\n            setErrors({ ...errors });\n            return;\n        }\n\n        const index = selectedProducts.indexOf(product);\n        if (index > -1) {\n            selectedProducts.splice(index, 1);\n        }\n        setSelectedProducts([...selectedProducts]);\n        reCalculate();\n    }\n\n    let [totalPrice, setTotalPrice] = useState(0.0);\n\n    function findTotalPrice() {\n        totalPrice = 0.00;\n        for (var i = 0; i < selectedProducts.length; i++) {\n            totalPrice +=\n                parseFloat(selectedProducts[i].purchase_unit_price) *\n                parseFloat(selectedProducts[i].quantity);\n        }\n        totalPrice = totalPrice.toFixed(2);\n        setTotalPrice(totalPrice);\n    }\n\n    let [vatPrice, setVatPrice] = useState(0.00);\n\n    function findVatPrice() {\n        vatPrice = 0.00;\n        if (totalPrice > 0) {\n            vatPrice = (parseFloat((parseFloat(formData.vat_percent) / 100)) * (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount))).toFixed(2);;\n            console.log(\"vatPrice:\", vatPrice);\n        }\n        setVatPrice(vatPrice);\n    }\n\n    let [netTotal, setNetTotal] = useState(0.00);\n\n    function findNetTotal() {\n        netTotal = 0.00;\n        if (totalPrice > 0) {\n            netTotal = (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount) + parseFloat(vatPrice));\n            netTotal = parseFloat(netTotal);\n        }\n        netTotal = RoundFloat(netTotal, 2);\n        // netTotal = Math.round(netTotal * 100) / 100;\n        setNetTotal(netTotal);\n\n        if (!formData.id) {\n            let method = \"\";\n            if (formData.payments_input[0]) {\n                method = formData.payments_input[0].method;\n            }\n\n            formData.payments_input = [{\n                \"date_str\": formData.date_str,\n                \"amount\": 0.00,\n                \"method\": method,\n                \"deleted\": false,\n            }];\n\n            if (netTotal > 0) {\n                formData.payments_input[0].amount = parseFloat(netTotal.toFixed(2));\n                if (formData.cash_discount) {\n                    formData.payments_input[0].amount = formData.payments_input[0].amount - parseFloat(formData.cash_discount?.toFixed(2));\n                }\n                formData.payments_input[0].amount = parseFloat(formData.payments_input[0].amount.toFixed(2));\n            }\n        }\n\n        setFormData({ ...formData });\n        validatePaymentAmounts();\n\n    }\n\n    function RoundFloat(val, precision) {\n        var ratio = Math.pow(10, precision);\n        return Math.round(val * ratio) / ratio;\n    }\n\n    let [discountPercent, setDiscountPercent] = useState(0.00);\n\n    function findDiscountPercent() {\n        if (formData.discount >= 0 && totalPrice > 0) {\n            discountPercent = parseFloat(parseFloat(formData.discount / totalPrice) * 100).toFixed(2);\n            setDiscountPercent(discountPercent);\n            formData.discount_percent = discountPercent;\n            setFormData({ ...formData });\n        }\n    }\n\n    function findDiscount() {\n        if (formData.discount_percent >= 0 && totalPrice > 0) {\n            formData.discount = parseFloat(totalPrice * parseFloat(formData.discount_percent / 100)).toFixed(2);\n            setFormData({ ...formData });\n        }\n    }\n\n\n    function reCalculate() {\n        findTotalPrice();\n\n        if (formData.is_discount_percent) {\n            findDiscount();\n        } else {\n            findDiscountPercent();\n        }\n        findVatPrice();\n        findNetTotal();\n    }\n\n    function addNewPayment() {\n        let date = new Date();\n        if (!formData.id) {\n            date = formData.date_str;\n        }\n\n        if(!formData.payments_input){\n            formData.payments_input=[];\n        }\n\n        formData.payments_input.push({\n            \"date_str\": date,\n            // \"amount\": \"\",\n            \"amount\": 0.00,\n            \"method\": \"\",\n            \"deleted\": false,\n        });\n        setFormData({ ...formData });\n        validatePaymentAmounts();\n        //validatePaymentAmounts((formData.payments_input.filter(payment => !payment.deleted).length - 1));\n    }\n\n\n    function findTotalPayments() {\n        let totalPayment = 0.00;\n        for (var i = 0; i < formData.payments_input?.length; i++) {\n            if (formData.payments_input[i].amount && !formData.payments_input[i].deleted) {\n                totalPayment += formData.payments_input[i].amount;\n            }\n        }\n\n        totalPaymentAmount = totalPayment;\n        console.log(\"totalPaymentAmount:\", totalPaymentAmount);\n        setTotalPaymentAmount(totalPaymentAmount);\n        console.log(\"totalPayment:\", totalPayment)\n        balanceAmount = (parseFloat(netTotal.toFixed(2)) - parseFloat(parseFloat(formData.cash_discount)?.toFixed(2))) - parseFloat(totalPayment.toFixed(2));\n        balanceAmount = parseFloat(balanceAmount.toFixed(2));\n        setBalanceAmount(balanceAmount);\n\n        if (balanceAmount === parseFloat((parseFloat(netTotal.toFixed(2)) - parseFloat(parseFloat(formData.cash_discount)?.toFixed(2))).toFixed(2))) {\n            paymentStatus = \"not_paid\"\n        } else if (balanceAmount <= 0) {\n            paymentStatus = \"paid\"\n        } else if (balanceAmount > 0) {\n            paymentStatus = \"paid_partially\"\n        }\n\n        setPaymentStatus(paymentStatus);\n\n        return totalPayment;\n    }\n\n    let [totalPaymentAmount, setTotalPaymentAmount] = useState(0.00);\n    let [balanceAmount, setBalanceAmount] = useState(0.00);\n    let [paymentStatus, setPaymentStatus] = useState(\"\");\n\n\n\n    function removePayment(key, validatePayments = false) {\n        formData.payments_input.splice(key, 1);\n        //formData.payments_input[key][\"deleted\"] = true;\n        setFormData({ ...formData });\n        if (validatePayments) {\n            validatePaymentAmounts();\n        }\n        findTotalPayments()\n    }\n\n\n    function validatePaymentAmounts() {\n        console.log(\"validatePaymentAmount: netTotal:\", netTotal)\n        errors[\"cash_discount\"] = \"\";\n        setErrors({ ...errors });\n\n        let haveErrors = false;\n        if (!netTotal) {\n            /*\n            removePayment(0, false);\n            totalPaymentAmount = 0.0;\n            setTotalPaymentAmount(0.00);\n            balanceAmount = 0.00;\n            setBalanceAmount(0.00);\n            paymentStatus = \"\";\n            setPaymentStatus(paymentStatus);\n            */\n            return true;\n        }\n\n\n        if (formData.cash_discount > 0 && formData.cash_discount >= netTotal) {\n            errors[\"cash_discount\"] = \"Cash discount should not be >= \" + netTotal.toFixed(2).toString();\n            setErrors({ ...errors });\n            haveErrors = true\n            return false;\n        }\n\n        let totalPayment = findTotalPayments();\n\n        // errors[\"payment_date\"] = [];\n        //errors[\"payment_method\"] = [];\n        //errors[\"payment_amount\"] = [];\n        for (var key = 0; key < formData.payments_input.length; key++) {\n            errors[\"payment_amount_\" + key] = \"\";\n            errors[\"payment_date_\" + key] = \"\";\n            errors[\"payment_method_\" + key] = \"\";\n            setErrors({ ...errors });\n\n            if (!formData.payments_input[key].amount) {\n                errors[\"payment_amount_\" + key] = \"Payment amount is required\";\n                setErrors({ ...errors });\n                haveErrors = true;\n            } else if (formData.payments_input[key].amount === 0) {\n                errors[\"payment_amount_\" + key] = \"Amount should be greater than zero\";\n                setErrors({ ...errors });\n                haveErrors = true;\n            }\n\n            if (!formData.payments_input[key].date_str) {\n                errors[\"payment_date_\" + key] = \"Payment date is required\";\n                setErrors({ ...errors });\n                haveErrors = true;\n            } else if ((new Date(formData.payments_input[key].date_str)) < (new Date(formData.date_str))) {\n                errors[\"payment_date_\" + key] = \"Payment date time should be greater than or equal to order date time\";\n                setErrors({ ...errors });\n                haveErrors = true;\n            }\n\n            if (!formData.payments_input[key].method) {\n                errors[\"payment_method_\" + key] = \"Payment method is required\";\n                setErrors({ ...errors });\n                haveErrors = true;\n            }\n\n\n            if ((formData.payments_input[key].amount || formData.payments_input[key].amount === 0) && !formData.payments_input[key].deleted) {\n                let maxAllowedAmount = (netTotal - formData.cash_discount) - (totalPayment - formData.payments_input[key].amount);\n\n                if (maxAllowedAmount < 0) {\n                    maxAllowedAmount = 0;\n                }\n\n                /*\n                \n                if (maxAllowedAmount === 0) {\n                    errors[\"payment_amount_\" + key] = \"Total amount should not exceed \" + (netTotal - formData.cash_discount).toFixed(2).toString() + \", Please delete this payment\";\n                    setErrors({ ...errors });\n                    haveErrors = true;\n                } else if (formData.payments_input[key].amount > parseFloat(maxAllowedAmount.toFixed(2))) {\n                    errors[\"payment_amount_\" + key] = \"Amount should not be greater than \" + maxAllowedAmount.toFixed(2);\n                    setErrors({ ...errors });\n                    haveErrors = true;\n                }\n                */\n\n\n            }\n        }\n\n        if (haveErrors) {\n            return false;\n        }\n\n        return true;\n    }\n\n\n    const StoreCreateFormRef = useRef();\n    function openStoreCreateForm() {\n        StoreCreateFormRef.current.open();\n    }\n\n    const ProductCreateFormRef = useRef();\n    function openProductCreateForm() {\n        ProductCreateFormRef.current.open();\n    }\n\n    function openProductUpdateForm(id) {\n        ProductCreateFormRef.current.open(id);\n    }\n\n    const VendorCreateFormRef = useRef();\n    function openVendorCreateForm() {\n        VendorCreateFormRef.current.open();\n    }\n\n    const UserCreateFormRef = useRef();\n    function openUserCreateForm() {\n        UserCreateFormRef.current.open();\n    }\n\n\n    const SignatureCreateFormRef = useRef();\n    function openSignatureCreateForm() {\n        SignatureCreateFormRef.current.open();\n    }\n\n    const ProductDetailsViewRef = useRef();\n    function openProductDetailsView(id) {\n        ProductDetailsViewRef.current.open(id);\n    }\n\n    return (\n        <>\n            <ProductView ref={ProductDetailsViewRef} openUpdateForm={openProductUpdateForm} openCreateForm={openProductCreateForm} />\n            <ProductCreate ref={ProductCreateFormRef} showToastMessage={props.showToastMessage} openDetailsView={openProductDetailsView} />\n\n            <StoreCreate ref={StoreCreateFormRef} showToastMessage={props.showToastMessage} />\n\n            <UserCreate ref={UserCreateFormRef} showToastMessage={props.showToastMessage} />\n            <SignatureCreate ref={SignatureCreateFormRef} showToastMessage={props.showToastMessage} />\n            <VendorCreate ref={VendorCreateFormRef} showToastMessage={props.showToastMessage} />\n            <Modal show={show} size=\"xl\" fullscreen onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n                <Modal.Header>\n                    <Modal.Title>\n                        {formData.id ? \"Update Purchase #\" + formData.code : \"Create New Purchase\"}\n                    </Modal.Title>\n\n                    <div className=\"col align-self-end text-end\">\n                        <PurchasePreview />\n                        {formData.id ? <Button variant=\"primary\" onClick={() => {\n                            handleClose();\n                            props.openDetailsView(formData.id);\n                        }}>\n                            <i className=\"bi bi-eye\"></i> View Detail\n                        </Button> : \"\"}\n                        &nbsp;&nbsp;\n                        <Button variant=\"primary\" onClick={handleCreate} >\n                            {isProcessing ?\n                                <Spinner\n                                    as=\"span\"\n                                    animation=\"border\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden={true}\n                                /> + \" Creating...\"\n\n                                : \"\"\n                            }\n                            {formData.id ? \"Update\" : \"Create\"}\n\n                        </Button>\n\n                        <button\n                            type=\"button\"\n                            className=\"btn-close\"\n                            onClick={handleClose}\n                            aria-label=\"Close\"\n                        ></button>\n                    </div>\n                </Modal.Header>\n                <Modal.Body>\n                    {Object.keys(errors).length > 0 ?\n                        <div>\n                            <ul>\n\n                                {errors && Object.keys(errors).map((key, index) => {\n                                    return (errors[key] ? <li style={{ color: \"red\" }}>{errors[key]}</li> : \"\");\n                                })}\n                            </ul></div> : \"\"}\n                    <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n                        {!cookies.get('store_name') ? <div className=\"col-md-6\">\n                            <label className=\"form-label\">Purchase to Store*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"store_id\"\n                                    labelKey=\"name\"\n                                    isLoading={isStoresLoading}\n                                    isInvalid={errors.store_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.store_id = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.store_id = \"Invalid Store selected\";\n                                            setErrors(errors);\n                                            setFormData({ ...formData });\n                                            setSelectedStores([]);\n                                            return;\n                                        }\n                                        formData.store_id = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        setSelectedStores(selectedItems);\n                                        //SetPriceOfAllProducts(selectedItems[0].id);\n                                    }}\n                                    options={storeOptions}\n                                    placeholder=\"Select Store\"\n                                    selected={selectedStores}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestStores(searchTerm);\n                                    }}\n                                />\n                                <Button hide={true.toString()} onClick={openStoreCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi x-lg\"> </i>\n                                    {errors.store_id}\n                                </div>\n                                {formData.store_id && !errors.store_id && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div> : \"\"}\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Purchase From Vendor*</label>\n                            <Typeahead\n                                id=\"vendor_id\"\n                                labelKey=\"search_label\"\n                                isLoading={isVendorsLoading}\n                                isInvalid={errors.vendor_id ? true : false}\n                                onChange={(selectedItems) => {\n                                    errors.vendor_id = \"\";\n                                    setErrors(errors);\n                                    if (selectedItems.length === 0) {\n                                        errors.vendor_id = \"Invalid Vendor selected\";\n                                        setErrors(errors);\n                                        formData.vendor_id = \"\";\n                                        setFormData({ ...formData });\n                                        setSelectedVendors([]);\n                                        return;\n                                    }\n                                    formData.vendor_id = selectedItems[0].id;\n                                    setFormData({ ...formData });\n                                    setSelectedVendors(selectedItems);\n                                }}\n                                options={vendorOptions}\n                                placeholder=\"Type name or mob\"\n                                selected={selectedVendors}\n                                highlightOnlyResult={true}\n                                onInputChange={(searchTerm, e) => {\n                                    suggestVendors(searchTerm);\n                                }}\n                            />\n                            <Button hide={true.toString()} onClick={openVendorCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                            {errors.vendor_id && (\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi bi-x-lg\"> </i>\n                                    {errors.vendor_id}\n                                </div>\n                            )}\n                            {formData.vendor_id && !errors.vendor_id && (\n                                <div style={{ color: \"green\" }}>\n                                    <i className=\"bi bi-check-lg\"> </i>\n                                    Looks good!\n                                </div>\n                            )}\n                        </div>\n                        {/*\n                        <div className=\"col-md-3\">\n                            <label className=\"form-label\">Product Barcode Scan</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DebounceInput\n                                    minLength={12}\n                                    debounceTimeout={500}\n                                    placeholder=\"Scan Barcode\"\n                                    className=\"form-control barcode\"\n                                    value={formData.barcode}\n                                    onChange={event => getProductByBarCode(event.target.value)} />\n                                {errors.bar_code && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.bar_code}\n                                    </div>\n                                )}\n                                {formData.bar_code && !errors.bar_code && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                                */}\n\n                        <div className=\"col-md-3\">\n                            <label className=\"form-label\">Vendor Invoice No. (Optional)</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.vendor_invoice_no ? formData.vendor_invoice_no : \"\"}\n                                    type='string'\n                                    onChange={(e) => {\n                                        errors[\"vendor_invoice_no\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.vendor_invoice_no = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"vendor_invoice_no\"\n                                    placeholder=\"Vendor Invoice No.\"\n                                />\n                                {errors.vendor_invoice_no && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.vendor_invoice_no}\n                                    </div>\n                                )}\n                                {formData.vendor_invoice_no && !errors.rack && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-3\">\n                            <label className=\"form-label\">Date Time*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    selected={formData.date_str ? new Date(formData.date_str) : null}\n                                    value={formData.date_str ? format(\n                                        new Date(formData.date_str),\n                                        \"MMMM d, yyyy h:mm aa\"\n                                    ) : null}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                    showTimeSelect\n                                    timeIntervals=\"1\"\n                                    onChange={(value) => {\n                                        console.log(\"Value\", value);\n                                        formData.date_str = value;\n                                        // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-12\">\n                            <label className=\"form-label\">Product*</label>\n\n\n                            <Typeahead\n                                id=\"product_id\"\n                                size=\"lg\"\n                                labelKey=\"search_label\"\n                                emptyLabel=\"\"\n                                clearButton={true}\n                                open={openProductSearchResult}\n                                isLoading={isProductsLoading}\n                                isInvalid={errors.product_id ? true : false}\n                                onChange={(selectedItems) => {\n                                    if (selectedItems.length === 0) {\n                                        errors[\"product_id\"] = \"Invalid Product selected\";\n                                        setErrors(errors);\n                                        return;\n                                    }\n                                    errors[\"product_id\"] = \"\";\n                                    setErrors({ ...errors });\n\n                                    if (formData.store_id) {\n                                        addProduct(selectedItems[0]);\n\n                                    }\n                                    setOpenProductSearchResult(false);\n                                }}\n                                options={productOptions}\n                                selected={selectedProduct}\n                                placeholder=\"Search By Part No. / Name / Name in Arabic\"\n                                highlightOnlyResult={true}\n                                onInputChange={(searchTerm, e) => {\n                                    suggestProducts(searchTerm);\n                                }}\n                            />\n                            <Button hide={true.toString()} onClick={openProductCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                            {errors.product_id ? (\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi bi-x-lg\"> </i>\n                                    {errors.product_id}\n                                </div>\n                            ) : \"\"}\n                            {selectedProduct[0] &&\n                                selectedProduct[0].id &&\n                                !errors.product_id && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n\n                        </div>\n\n                        <div className=\"table-responsive\" style={{ overflowX: \"auto\", maxHeight: \"400px\", overflowY: \"auto\" }}>\n                            <table className=\"table table-striped table-sm table-bordered\">\n                                <thead>\n                                    <tr className=\"text-center\">\n                                        <th style={{ width: \"2%\" }}>Remove</th>\n                                        <th style={{ width: \"5%\" }}>SI No.</th>\n                                        <th style={{ width: \"8%\" }}>Part No.</th>\n                                        <th style={{ width: \"26%\" }} className=\"text-start\">Name</th>\n                                        <th style={{ width: \"11%\" }}>Qty</th>\n                                        <th style={{ width: \"11%\" }}>Purchase Unit Price</th>\n                                        <th style={{ width: \"11%\" }}>Wholesale Unit Price</th>\n                                        <th style={{ width: \"11%\" }}>Retail Unit Price</th>\n                                        <th style={{ width: \"15%\" }}>Purchase Price</th>\n\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {selectedProducts.map((product, index) => (\n                                        <tr key={index} className=\"text-center\">\n                                            <td>\n                                                <div\n                                                    style={{ color: \"red\", cursor: \"pointer\" }}\n                                                    onClick={() => {\n                                                        removeProduct(product);\n                                                    }}\n                                                >\n                                                    <i className=\"bi bi-x-lg\"> </i>\n                                                </div>\n                                            </td>\n                                            <td>{index + 1}</td>\n                                            <td>{product.part_number}</td>\n                                            <td style={{\n                                                textDecoration: \"underline\",\n                                                color: \"blue\",\n                                                cursor: \"pointer\",\n                                            }}\n                                                className=\"text-start\"\n                                                onClick={() => {\n                                                    openProductDetailsView(product.product_id);\n                                                    console.log(\"okk,id:\", product.product_id);\n                                                }}>{product.name}\n                                            </td>\n                                            <td style={{ width: \"155px\" }}>\n\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"number\" value={product.quantity} className=\"form-control\"\n\n                                                        placeholder=\"Quantity\" onChange={(e) => {\n                                                            errors[\"quantity_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n                                                            if (!e.target.value) {\n                                                                errors[\"quantity_\" + index] = \"Invalid Quantity\";\n                                                                selectedProducts[index].quantity = e.target.value;\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            if (e.target.value === 0) {\n                                                                errors[\"quantity_\" + index] = \"Invalid Quantity should be > 0\";\n                                                                selectedProducts[index].quantity = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n\n                                                            product.quantity = parseFloat(e.target.value);\n                                                            reCalculate();\n\n                                                            selectedProducts[index].quantity = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].quantity:\", selectedProducts[index].quantity);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                    <span className=\"input-group-text\" id=\"basic-addon2\">{selectedProducts[index].unit ? selectedProducts[index].unit : \"Units\"}</span>\n                                                </div>\n                                                {errors[\"quantity_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        <i className=\"bi bi-x-lg\"> </i>\n                                                        {errors[\"quantity_\" + index]}\n                                                    </div>\n                                                )}\n                                            </td>\n                                            <td style={{ width: \"180px\" }}>\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"number\" value={product.purchase_unit_price} className=\"form-control\"\n\n                                                        placeholder=\"Purchase Unit Price\" onChange={(e) => {\n                                                            errors[\"purchase_unit_price_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n\n                                                            if (!e.target.value) {\n                                                                errors[\"purchase_unit_price_\" + index] = \"Invalid Purchase Unit Price\";\n                                                                selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            if (e.target.value === 0) {\n                                                                errors[\"purchase_unit_price_\" + index] = \"Purchase Unit Price should be > 0\";\n                                                                selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].purchase_unit_price:\", selectedProducts[index].purchase_unit_price);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                </div>\n\n                                                {errors[\"purchase_unit_price_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        <i className=\"bi bi-x-lg\"> </i>\n                                                        {errors[\"purchase_unit_price_\" + index]}\n                                                    </div>\n                                                )}\n\n                                            </td>\n                                            <td style={{ width: \"180px\" }}>\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"number\" value={product.wholesale_unit_price} className=\"form-control\"\n\n                                                        placeholder=\"Wholesale Unit Price\" onChange={(e) => {\n                                                            errors[\"wholesale_unit_price_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n                                                            if (!e.target.value) {\n                                                                errors[\"wholesale_unit_price_\" + index] = \"Invalid Wholesale Unit Price\";\n                                                                selectedProducts[index].wholesale_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            if (e.target.value === 0) {\n                                                                errors[\"wholesale_unit_price_\" + index] = \"Wholesale Unit Price should be > 0\";\n                                                                selectedProducts[index].wholesale_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            selectedProducts[index].wholesale_unit_price = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].wholesale_unit_price:\", selectedProducts[index].wholesale_unit_price);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                   \n                                                </div>\n\n                                                {errors[\"wholesale_unit_price_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        <i className=\"bi bi-x-lg\"> </i>\n                                                        {errors[\"wholesale_unit_price_\" + index]}\n                                                    </div>\n                                                )}\n\n                                            </td>\n                                            <td style={{ width: \"180px\" }}>\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"number\" value={product.retail_unit_price} className=\"form-control\"\n\n                                                        placeholder=\"Retail Unit Price\" onChange={(e) => {\n                                                            errors[\"retail_unit_price_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n                                                            if (!e.target.value) {\n                                                                errors[\"retail_unit_price_\" + index] = \"Invalid Retail Unit Price\";\n                                                                selectedProducts[index].retail_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            if (e.target.value === 0) {\n                                                                errors[\"retail_unit_price_\" + index] = \"Retail Unit Price should be > 0\";\n                                                                selectedProducts[index].retail_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n\n                                                            selectedProducts[index].retail_unit_price = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].retail_unit_price:\", selectedProducts[index].retail_unit_price);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                   \n                                                </div>\n\n                                                {errors[\"retail_unit_price_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        <i className=\"bi bi-x-lg\"> </i>\n                                                        {errors[\"retail_unit_price_\" + index]}\n                                                    </div>\n                                                )}\n\n                                            </td>\n                                            <td className=\"text-end\">\n                                                <NumberFormat\n                                                    value={(product.purchase_unit_price * product.quantity).toFixed(2)}\n                                                    displayType={\"text\"}\n                                                    thousandSeparator={true}\n                                                    suffix={\"\"}\n                                                    renderText={(value, props) => value}\n                                                />\n                                            </td>\n\n                                        </tr>\n                                    )).reverse()}\n                                </tbody>\n                            </table>\n                        </div>\n\n                        <div className=\"table-responsive\" style={{ overflowX: \"auto\" }}>\n                            <table className=\"table table-striped table-sm table-bordered\">\n                                <tbody>\n                                    <tr>\n                                        <th style={{ width: \"90%\" }} colSpan=\"8\" className=\"text-end\">Total</th>\n                                        <td style={{ width: \"10%\" }} className=\"text-end\">\n                                            <NumberFormat\n                                                value={totalPrice}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\"\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <th colSpan=\"8\" className=\"text-end\">\n                                            Shipping & Handling Fees\n                                        </th>\n                                        <td className=\"text-end\">\n                                            <input type=\"number\" style={{ width: \"150px\" }} className=\"text-start\" value={formData.shipping_handling_fees} onChange={(e) => {\n\n                                                if (parseFloat(e.target.value) === 0) {\n                                                    formData.shipping_handling_fees = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"shipping_handling_fees\"] = \"\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (parseFloat(e.target.value) < 0) {\n                                                    formData.shipping_handling_fees = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"shipping_handling_fees\"] = \"Shipping / Handling Fees should be > 0\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (!e.target.value) {\n                                                    formData.shipping_handling_fees = \"\";\n                                                    errors[\"shipping_handling_fees\"] = \"Invalid Shipping / Handling Fees\";\n                                                    setFormData({ ...formData });\n                                                    setErrors({ ...errors });\n                                                    return;\n                                                }\n\n                                                errors[\"shipping_handling_fees\"] = \"\";\n                                                setErrors({ ...errors });\n\n                                                formData.shipping_handling_fees = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                reCalculate();\n                                            }} />\n                                            {\"\"}\n                                            {errors.shipping_handling_fees && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.shipping_handling_fees}\n                                                </div>\n                                            )}\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <th colSpan=\"8\" className=\"text-end\">\n                                            Discount  <input type=\"number\" style={{ width: \"50px\" }} className=\"text-start\" value={formData.discount_percent} onChange={(e) => {\n                                                formData.is_discount_percent = true;\n                                                if (parseFloat(e.target.value) === 0) {\n                                                    formData.discount_percent = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount_percent\"] = \"\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (parseFloat(e.target.value) < 0) {\n                                                    formData.discount_percent = parseFloat(e.target.value);\n                                                    formData.discount = 0.00;\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount_percent\"] = \"Discount percent should be >= 0\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (!e.target.value) {\n                                                    formData.discount_percent = \"\";\n                                                    formData.discount = 0.00;\n                                                    errors[\"discount_percent\"] = \"Invalid Discount Percent\";\n                                                    setFormData({ ...formData });\n                                                    setErrors({ ...errors });\n                                                    return;\n                                                }\n\n                                                errors[\"discount_percent\"] = \"\";\n                                                errors[\"discount\"] = \"\";\n                                                setErrors({ ...errors });\n\n                                                formData.discount_percent = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                reCalculate();\n                                            }} />{\"%\"}\n                                            {errors.discount_percent && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.discount_percent}\n                                                </div>\n                                            )}\n                                        </th>\n                                        <td className=\"text-end\">\n                                            <input type=\"number\" style={{ width: \"150px\" }} className=\"text-start\" value={formData.discount} onChange={(e) => {\n                                                formData.is_discount_percent = false;\n                                                if (parseFloat(e.target.value) === 0) {\n                                                    formData.discount = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount\"] = \"\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (parseFloat(e.target.value) < 0) {\n                                                    formData.discount = parseFloat(e.target.value);\n                                                    formData.discount_percent = 0.00;\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount\"] = \"Discount should be >= 0\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (!e.target.value) {\n                                                    formData.discount = \"\";\n                                                    formData.discount_percent = 0.00;\n                                                    errors[\"discount\"] = \"Invalid Discount\";\n                                                    setFormData({ ...formData });\n                                                    reCalculate();\n                                                    setErrors({ ...errors });\n                                                    return;\n                                                }\n\n                                                errors[\"discount\"] = \"\";\n                                                errors[\"discount_percent\"] = \"\";\n                                                setErrors({ ...errors });\n\n                                                formData.discount = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                reCalculate();\n                                            }} />\n                                            {\"\"}\n                                            {errors.discount && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.discount}\n                                                </div>\n                                            )}\n                                        </td>\n                                    </tr>\n                                    <tr>\n\n                                        <th colSpan=\"8\" className=\"text-end\"> VAT  <input type=\"number\" className=\"text-center\" style={{ width: \"50px\" }} value={formData.vat_percent} onChange={(e) => {\n                                            console.log(\"Inside onchange vat percent\");\n                                            if (parseFloat(e.target.value) === 0) {\n                                                formData.vat_percent = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                errors[\"vat_percent\"] = \"\";\n                                                setErrors({ ...errors });\n                                                reCalculate();\n                                                return;\n                                            }\n                                            if (parseFloat(e.target.value) < 0) {\n                                                formData.vat_percent = parseFloat(e.target.value);\n                                                vatPrice = 0.00;\n                                                setVatPrice(vatPrice);\n                                                setFormData({ ...formData });\n                                                errors[\"vat_percent\"] = \"Vat percent should be >= 0\";\n                                                setErrors({ ...errors });\n                                                reCalculate();\n                                                return;\n                                            }\n\n\n                                            if (!e.target.value) {\n                                                formData.vat_percent = \"\";\n                                                vatPrice = 0.00;\n                                                setVatPrice(vatPrice);\n                                                //formData.discount_percent = 0.00;\n                                                errors[\"vat_percent\"] = \"Invalid vat percent\";\n                                                setFormData({ ...formData });\n                                                setErrors({ ...errors });\n                                                return;\n                                            }\n                                            errors[\"vat_percent\"] = \"\";\n                                            setErrors({ ...errors });\n\n                                            formData.vat_percent = e.target.value;\n                                            reCalculate();\n                                            setFormData({ ...formData });\n                                            console.log(formData);\n                                        }} />{\"%\"}\n                                            {errors.vat_percent && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.vat_percent}\n                                                </div>\n                                            )}\n                                        </th>\n                                        <td className=\"text-end\">\n                                            <NumberFormat\n                                                value={vatPrice}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\"\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </td>\n                                    </tr>\n                                    <tr>\n\n                                        <th colSpan=\"8\" className=\"text-end\">Net Total</th>\n                                        <th className=\"text-end\">\n                                            <NumberFormat\n                                                value={netTotal}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\"\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </th>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n\n                        <div className=\"col-md-2\">\n                            <label className=\"form-label\">Cash discount</label>\n                            <input type='number' value={formData.cash_discount} className=\"form-control \"\n                                onChange={(e) => {\n                                    errors[\"cash_discount\"] = \"\";\n                                    setErrors({ ...errors });\n                                    if (!e.target.value) {\n                                        formData.cash_discount = e.target.value;\n                                        setFormData({ ...formData });\n                                        validatePaymentAmounts();\n                                        return;\n                                    }\n                                    formData.cash_discount = parseFloat(e.target.value);\n                                    if (formData.cash_discount > 0 && formData.cash_discount >= netTotal) {\n                                        errors[\"cash_discount\"] = \"Cash discount should not be >= \" + netTotal.toString();\n                                        setErrors({ ...errors });\n                                        return;\n                                    }\n\n                                    setFormData({ ...formData });\n                                    validatePaymentAmounts();\n                                    console.log(formData);\n                                }}\n                            />\n                            {errors.cash_discount && (\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi bi-x-lg\"> </i>\n                                    {errors.cash_discount}\n                                </div>\n                            )}\n                        </div>\n\n                        <div className=\"col-md-8\">\n                            <label className=\"form-label\">Payments Paid</label>\n\n                            <div class=\"table-responsive\" style={{ maxWidth: \"900px\" }}>\n                                <Button variant=\"secondary\" style={{ alignContent: \"right\", marginBottom: \"10px\" }} onClick={addNewPayment}>\n                                    Create new payment\n                                </Button>\n                                <table class=\"table table-striped table-sm table-bordered\">\n                                    {formData.payments_input && formData.payments_input.length > 0 &&\n                                        <thead>\n                                            <th>\n                                                Date\n                                            </th>\n                                            <th>\n                                                Amount\n                                            </th>\n                                            <th>\n                                                Payment method\n                                            </th>\n                                            <th>\n                                                Action\n                                            </th>\n                                        </thead>}\n                                    <tbody>\n                                        {formData.payments_input &&\n                                            formData.payments_input.filter(payment => !payment.deleted).map((payment, key) => (\n                                                <tr key={key}>\n                                                    <td style={{ minWidth: \"220px\" }}>\n\n                                                        <DatePicker\n                                                            id=\"payment_date_str\"\n                                                            selected={formData.payments_input[key].date_str ? new Date(formData.payments_input[key].date_str) : null}\n                                                            value={formData.payments_input[key].date_str ? format(\n                                                                new Date(formData.payments_input[key].date_str),\n                                                                \"MMMM d, yyyy h:mm aa\"\n                                                            ) : null}\n                                                            className=\"form-control\"\n                                                            dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                                            showTimeSelect\n                                                            timeIntervals=\"1\"\n                                                            onChange={(value) => {\n                                                                console.log(\"Value\", value);\n                                                                formData.payments_input[key].date_str = value;\n                                                                setFormData({ ...formData });\n                                                            }}\n                                                        />\n                                                        {errors[\"payment_date_\" + key] && (\n                                                            <div style={{ color: \"red\" }}>\n                                                                <i className=\"bi bi-x-lg\"> </i>\n                                                                {errors[\"payment_date_\" + key]}\n                                                            </div>\n                                                        )}\n                                                    </td>\n                                                    <td style={{ width: \"300px\" }}>\n                                                        <input type='number' value={formData.payments_input[key].amount} className=\"form-control \"\n                                                            onChange={(e) => {\n                                                                errors[\"payment_amount_\" + key] = \"\";\n                                                                setErrors({ ...errors });\n\n                                                                if (!e.target.value) {\n                                                                    formData.payments_input[key].amount = e.target.value;\n                                                                    setFormData({ ...formData });\n                                                                    validatePaymentAmounts();\n                                                                    return;\n                                                                }\n\n                                                                formData.payments_input[key].amount = parseFloat(e.target.value);\n\n                                                                validatePaymentAmounts();\n                                                                setFormData({ ...formData });\n                                                                console.log(formData);\n                                                            }}\n                                                        />\n                                                        {errors[\"payment_amount_\" + key] && (\n                                                            <div style={{ color: \"red\" }}>\n                                                                <i className=\"bi bi-x-lg\"> </i>\n                                                                {errors[\"payment_amount_\" + key]}\n                                                            </div>\n                                                        )}\n                                                    </td>\n                                                    <td style={{ width: \"200px\" }}>\n                                                        <select value={formData.payments_input[key].method} className=\"form-control \"\n                                                            onChange={(e) => {\n                                                                // errors[\"payment_method\"] = [];\n                                                                errors[\"payment_method_\" + key] = \"\";\n                                                                setErrors({ ...errors });\n\n                                                                if (!e.target.value) {\n                                                                    errors[\"payment_method_\" + key] = \"Payment method is required\";\n                                                                    setErrors({ ...errors });\n\n                                                                    formData.payments_input[key].method = \"\";\n                                                                    setFormData({ ...formData });\n                                                                    return;\n                                                                }\n\n                                                                // errors[\"payment_method\"] = \"\";\n                                                                //setErrors({ ...errors });\n\n                                                                formData.payments_input[key].method = e.target.value;\n                                                                setFormData({ ...formData });\n                                                                console.log(formData);\n                                                            }}\n                                                        >\n                                                            <option value=\"\">Select</option>\n                                                            <option value=\"cash\">Cash</option>\n                                                            <option value=\"bank_account\">Bank Account / Debit / Credit Card</option>\n                                                            <option value=\"vendor_account\">Vendor Account</option>\n                                                        </select>\n                                                        {errors[\"payment_method_\" + key] && (\n                                                            <div style={{ color: \"red\" }}>\n                                                                <i className=\"bi bi-x-lg\"> </i>\n                                                                {errors[\"payment_method_\" + key]}\n                                                            </div>\n                                                        )}\n                                                    </td>\n                                                    <td style={{ width: \"200px\" }}>\n                                                        <Button variant=\"danger\" onClick={(event) => {\n                                                            removePayment(key);\n                                                        }}>\n                                                            Remove\n                                                        </Button>\n\n                                                    </td>\n                                                </tr>\n                                            ))}\n                                        <tr>\n                                            <td class=\"text-end\">\n                                                <b>Total</b>\n                                            </td>\n                                            <td><b style={{ marginLeft: \"14px\" }}>{totalPaymentAmount?.toFixed(2)}</b>\n\n                                            </td>\n                                            <td>\n                                                <b style={{ marginLeft: \"12px\", alignSelf: \"end\" }}>Balance: {balanceAmount?.toFixed(2)}</b>\n                                            </td>\n                                            <td colSpan={1}>\n                                                <b>Payment status: </b>\n                                                {paymentStatus == \"paid\" ?\n                                                    <span className=\"badge bg-success\">\n                                                        Paid\n                                                    </span> : \"\"}\n                                                {paymentStatus == \"paid_partially\" ?\n                                                    <span className=\"badge bg-warning\">\n                                                        Paid Partially\n                                                    </span> : \"\"}\n                                                {paymentStatus == \"not_paid\" ?\n                                                    <span className=\"badge bg-danger\">\n                                                        Not Paid\n                                                    </span> : \"\"}\n                                            </td>\n                                        </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n\n\n\n                        <Modal.Footer>\n                            <Button variant=\"secondary\" onClick={handleClose}>\n                                Close\n                            </Button>\n                            <Button variant=\"primary\" onClick={handleCreate} >\n                                {isProcessing ?\n                                    <Spinner\n                                        as=\"span\"\n                                        animation=\"border\"\n                                        size=\"sm\"\n                                        role=\"status\"\n                                        aria-hidden={true}\n                                    /> + \" Creating...\"\n\n                                    : formData.id ? \"Update\" : \"Create\"\n                                }\n                            </Button>\n                        </Modal.Footer>\n                    </form>\n                </Modal.Body >\n\n            </Modal >\n\n\n        </>\n    );\n});\n\nexport default PurchaseCreate;\n"]},"metadata":{},"sourceType":"module"}