{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _toConsumableArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useState,useEffect,useRef,forwardRef,useImperativeHandle}from\"react\";import PurchaseReturnedPreview from\"./preview.js\";import{Modal,Button,Form}from\"react-bootstrap\";import StoreCreate from\"../store/create.js\";import VendorCreate from\"../vendor/create.js\";import ProductCreate from\"../product/create.js\";import UserCreate from\"../user/create.js\";import SignatureCreate from\"../signature/create.js\";import Cookies from\"universal-cookie\";import{Typeahead}from\"react-bootstrap-typeahead\";import NumberFormat from\"react-number-format\";import DatePicker from\"react-datepicker\";import{format}from\"date-fns\";import{Spinner}from\"react-bootstrap\";import PurchaseReturnedView from\"./view.js\";import ProductView from\"../product/view.js\";import PurchaseView from\"./../purchase/view.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PurchaseReturnedCreate=/*#__PURE__*/forwardRef(function(props,ref){useImperativeHandle(ref,function(){return{open:function open(id,purchaseId){selectedProducts=[];setSelectedProducts([]);selectedPurchaseReturnedByUsers=[];setSelectedPurchaseReturnedByUsers([]);selectedPurchaseReturnedBySignatures=[];setSelectedPurchaseReturnedBySignatures([]);formData={vat_percent:15.0,discount:0.0,discountValue:0.0,discount_percent:0.0,is_discount_percent:false,date_str:new Date(),signature_date_str:format(new Date(),\"MMM dd yyyy\"),payment_status:\"paid\",payment_method:\"\"};setFormData(_objectSpread({},formData));if(cookies.get(\"user_id\")){selectedPurchaseReturnedByUsers=[{id:cookies.get(\"user_id\"),name:cookies.get(\"user_name\")}];formData.purchase_returned_by=cookies.get(\"user_id\");setFormData(_objectSpread({},formData));setSelectedPurchaseReturnedByUsers(_toConsumableArray(selectedPurchaseReturnedByUsers));}setFormData(_objectSpread({},formData));if(id){getPurchaseReturn(id);}if(purchaseId){getPurchase(purchaseId);}setShow(true);}};});useEffect(function(){var listener=function listener(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){console.log(\"Enter key was pressed. Run your function-purchase return.\");// event.preventDefault();\nvar form=event.target.form;if(form&&event.target){var index=Array.prototype.indexOf.call(form,event.target);if(form&&form.elements[index+1]){if(event.target.getAttribute(\"class\").includes(\"barcode\")){form.elements[index].focus();}else{form.elements[index+1].focus();}event.preventDefault();}}}};document.addEventListener(\"keydown\",listener);return function(){document.removeEventListener(\"keydown\",listener);};},[]);var selectedDate=new Date();//const history = useHistory();\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isProcessing=_useState4[0],setProcessing=_useState4[1];var cookies=new Cookies();//fields\nvar _useState5=useState({vat_percent:10.0,discount:0.0,discountValue:0.0,discount_percent:0.0,is_discount_percent:false,//   date_str: format(new Date(), \"MMM dd yyyy\"),\ndate_str:new Date(),signature_date_str:format(new Date(),\"MMM dd yyyy\"),payment_status:\"paid\",payment_method:\"\"}),_useState6=_slicedToArray(_useState5,2),formData=_useState6[0],setFormData=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),selectedProducts=_useState8[0],setSelectedProducts=_useState8[1];//Purchase Returned By Auto Suggestion\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),purchaseReturnedByUserOptions=_useState10[0],setPurchaseReturnedByUserOptions=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),selectedPurchaseReturnedByUsers=_useState12[0],setSelectedPurchaseReturnedByUsers=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isPurchaseReturnedByUsersLoading=_useState14[0],setIsPurchaseReturnedByUsersLoading=_useState14[1];//Purchase Returned By Signature Auto Suggestion\nvar _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),purchaseReturnedBySignatureOptions=_useState16[0],setPurchaseReturnedBySignatureOptions=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),selectedPurchaseReturnedBySignatures=_useState18[0],setSelectedPurchaseReturnedBySignatures=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),isPurchaseReturnedBySignaturesLoading=_useState20[0],setIsPurchaseReturnedBySignaturesLoading=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),show=_useState22[0],setShow=_useState22[1];function handleClose(){setShow(false);}useEffect(function(){var at=cookies.get(\"access_token\");if(!at){// history.push(\"/dashboard/purchasereturneds\");\nwindow.location=\"/\";}});function getPurchaseReturn(id){console.log(\"inside get PurchaseReturned id:\",id);var requestOptions={method:'GET',headers:{'Content-Type':'application/json','Authorization':cookies.get('access_token')}};fetch('/v1/purchase-return/'+id,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var _response$headers$get;var isJson,data,error,purchaseReturn,selectedProductsTemp,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isJson=(_response$headers$get=response.headers.get('content-type'))===null||_response$headers$get===void 0?void 0:_response$headers$get.includes('application/json');_context.t0=isJson;if(!_context.t0){_context.next=6;break;}_context.next=5;return response.json();case 5:_context.t0=_context.sent;case 6:data=_context.t0;if(response.ok){_context.next=10;break;}error=data&&data.errors;return _context.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});console.log(\"Response:\");console.log(data);purchaseReturn=data.result;// formData = purchaseReturn;\nformData={id:purchaseReturn.id,code:purchaseReturn.code,store_id:purchaseReturn.store_id,vendor_id:purchaseReturn.vendor_id,date_str:purchaseReturn.date,// date: purchase.date,\nvat_percent:purchaseReturn.vat_percent,discount:purchaseReturn.discount,discount_percent:purchaseReturn.discount_percent,status:purchaseReturn.status,order_placed_by:purchaseReturn.order_placed_by,order_placed_by_signature_id:purchaseReturn.order_placed_by_signature_id,is_discount_percent:purchaseReturn.is_discount_percent,partial_payment_amount:purchaseReturn.partial_payment_amount,payment_method:purchaseReturn.payment_method,payment_status:purchaseReturn.payment_status,shipping_handling_fees:purchaseReturn.shipping_handling_fees};/*\n                formData = {\n                    date_str: format(new Date(), \"MMM dd yyyy\"),\n                    signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n                    purchase_id: purchase.id,\n                    purchase_code: purchase.code,\n                    vendor_invoice_no: purchase.vendor_invoice_no,\n                    store_id: purchase.store_id,\n                    vendor_id: purchase.vendor_id,\n                    vat_percent: purchase.vat_percent,\n                    status: purchase.status,\n                    purchase_returned_by: purchase.order_placed_by,\n                    purchase_returned_by_signature_id: purchase.order_placed_by_signature_id,\n                    is_discount_percent: purchase.is_discount_percent,\n                    discount_percent: purchase.discount_percent,\n                };\n                */ //formData.discount = (purchase.discount - purchase.return_discount);\n// formData.discount = 0;\nif(formData.is_discount_percent){formData.discountValue=formData.discount_percent;}else{formData.discountValue=formData.discount;}setFormData(_objectSpread({},formData));console.log(\"formData1.status:\",formData.status);console.log(\"purchaseReturn.products:\",purchaseReturn.products);selectedProductsTemp=purchaseReturn.products;selectedProducts=[];for(i=0;i<selectedProductsTemp.length;i++){if(selectedProductsTemp[i].quantity>0){selectedProductsTemp[i].selected=true;}else{selectedProductsTemp[i].selected=false;}selectedProducts.push(selectedProductsTemp[i]);selectedProductsTemp[i].purchase_unit_price=selectedProductsTemp[i].purchasereturn_unit_price;}setSelectedProducts(_toConsumableArray(selectedProducts));setFormData(_objectSpread({},formData));reCalculate();setFormData(_objectSpread({},formData));case 26:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function getPurchase(id){console.log(\"inside get Purchase\");var requestOptions={method:'GET',headers:{'Content-Type':'application/json','Authorization':cookies.get('access_token')}};fetch('/v1/purchase/'+id,requestOptions).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var _response$headers$get2;var isJson,data,error,purchase,selectedProductsTemp,i,purchasedQty;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isJson=(_response$headers$get2=response.headers.get('content-type'))===null||_response$headers$get2===void 0?void 0:_response$headers$get2.includes('application/json');_context2.t0=isJson;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return response.json();case 5:_context2.t0=_context2.sent;case 6:data=_context2.t0;if(response.ok){_context2.next=10;break;}error=data&&data.errors;return _context2.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});console.log(\"Response:\");console.log(data);purchase=data.result;formData={// date_str: format(new Date(), \"MMM dd yyyy\"),\ndate_str:new Date(),signature_date_str:format(new Date(),\"MMM dd yyyy\"),purchase_id:purchase.id,purchase_code:purchase.code,//   vendor_invoice_no: purchase.vendor_invoice_no,\nstore_id:purchase.store_id,vendor_id:purchase.vendor_id,vat_percent:purchase.vat_percent,status:purchase.status,purchase_returned_by:purchase.order_placed_by,purchase_returned_by_signature_id:purchase.order_placed_by_signature_id,is_discount_percent:purchase.is_discount_percent,discount_percent:purchase.discount_percent,payment_status:\"paid\",payment_method:\"\"};//formData.discount = (purchase.discount - purchase.return_discount);\nformData.discount=0;if(formData.is_discount_percent){formData.discountValue=formData.discount_percent;}else{formData.discountValue=formData.discount;}formData.discountValue=0;//formData.status = \"purchase_returned\";\nsetFormData(_objectSpread({},formData));console.log(\"formData1.status:\",formData.status);selectedProductsTemp=purchase.products;selectedProducts=[];for(i=0;i<selectedProductsTemp.length;i++){selectedProductsTemp[i].selected=false;purchasedQty=selectedProductsTemp[i].quantity-selectedProductsTemp[i].quantity_returned;selectedProductsTemp[i].quantity=purchasedQty;if(purchasedQty>0){selectedProducts.push(selectedProductsTemp[i]);}}setSelectedProducts(_toConsumableArray(selectedProducts));setFormData(_objectSpread({},formData));reCalculate();setFormData(_objectSpread({},formData));case 27:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function ObjectToSearchQueryParams(object){return Object.keys(object).map(function(key){return\"search[\".concat(key,\"]=\").concat(object[key]);}).join(\"&\");}function suggestUsers(_x3){return _suggestUsers.apply(this,arguments);}function _suggestUsers(){_suggestUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"Inside handle suggestUsers\");setPurchaseReturnedByUserOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context4.next=5;break;}return _context4.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";setIsPurchaseReturnedByUsersLoading(true);_context4.next=13;return fetch(\"/v1/user?\"+Select+queryString,requestOptions);case 13:result=_context4.sent;_context4.next=16;return result.json();case 16:data=_context4.sent;setPurchaseReturnedByUserOptions(data.result);setIsPurchaseReturnedByUsersLoading(false);case 19:case\"end\":return _context4.stop();}}},_callee4);}));return _suggestUsers.apply(this,arguments);}function suggestSignatures(_x4){return _suggestSignatures.apply(this,arguments);}function _suggestSignatures(){_suggestSignatures=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log(\"Inside handle suggestSignatures\");setPurchaseReturnedBySignatureOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context5.next=5;break;}return _context5.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";setIsPurchaseReturnedBySignaturesLoading(true);_context5.next=13;return fetch(\"/v1/signature?\"+Select+queryString,requestOptions);case 13:result=_context5.sent;_context5.next=16;return result.json();case 16:data=_context5.sent;setPurchaseReturnedBySignatureOptions(data.result);setIsPurchaseReturnedBySignaturesLoading(false);case 19:case\"end\":return _context5.stop();}}},_callee5);}));return _suggestSignatures.apply(this,arguments);}function handleCreate(event){console.log(\"formData:\",formData);console.log(\"formData.payment_status:\"+formData.payment_status);event.preventDefault();console.log(\"Inside handle Create\");console.log(\"selectedProducts:\",selectedProducts);formData.products=[];for(var i=0;i<selectedProducts.length;i++){if(!selectedProducts[i].selected){continue;// selectedProducts[i].quantity = 0;\n}formData.products.push({product_id:selectedProducts[i].product_id,quantity:parseFloat(selectedProducts[i].quantity),unit:selectedProducts[i].unit,purchasereturn_unit_price:parseFloat(selectedProducts[i].purchase_unit_price)});}formData.discount=parseFloat(formData.discount);formData.discount_percent=parseFloat(formData.discount_percent);formData.vat_percent=parseFloat(formData.vat_percent);console.log(\"formData.discount:\",formData.discount);if(formData.payment_status===\"paid_partially\"&&!formData.partial_payment_amount&&formData.partial_payment_amount!==0){errors[\"partial_payment_amount\"]=\"Invalid partial payment amount\";setErrors(_objectSpread({},errors));return;}if(formData.payment_status===\"paid_partially\"&&formData.partial_payment_amount<=0){errors[\"partial_payment_amount\"]=\"Partial payment should be > 0 \";setErrors(_objectSpread({},errors));return;}if(formData.payment_status===\"paid_partially\"&&formData.partial_payment_amount>=netTotal){errors[\"partial_payment_amount\"]=\"Partial payment cannot be >= \"+netTotal;setErrors(_objectSpread({},errors));return;}errors[\"payment_method\"]=\"\";setErrors(_objectSpread({},errors));if(!formData.id&&formData.payment_status!=\"not_paid\"&&!formData.payment_method){errors[\"payment_method\"]=\"Payment method is required\";setErrors(_objectSpread({},errors));return;}if(!formData.discountValue&&formData.discountValue!==0){errors[\"discount\"]=\"Invalid Discount\";setErrors(_objectSpread({},errors));return;}var endPoint=\"/v1/purchase-return\";var method=\"POST\";if(formData.id){endPoint=\"/v1/purchase-return/\"+formData.id;method=\"PUT\";}var requestOptions={method:method,headers:{'Accept':'application/json',\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")},body:JSON.stringify(formData)};setProcessing(true);fetch(endPoint,requestOptions).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(response){var _response$headers$get3;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:isJson=(_response$headers$get3=response.headers.get(\"content-type\"))===null||_response$headers$get3===void 0?void 0:_response$headers$get3.includes(\"application/json\");_context3.t0=isJson;if(!_context3.t0){_context3.next=6;break;}_context3.next=5;return response.json();case 5:_context3.t0=_context3.sent;case 6:data=_context3.t0;if(response.ok){_context3.next=10;break;}// get error message from body or default to response status\nerror=data&&data.errors;//const error = data.errors\nreturn _context3.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});setProcessing(false);console.log(\"Response:\");console.log(data);props.showToastMessage(\"Purchase Return Created Successfully!\",\"success\");if(props.refreshList){props.refreshList();}handleClose();openDetailsView(data.result.id);case 18:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x5){return _ref3.apply(this,arguments);};}()).catch(function(error){setProcessing(false);console.log(\"Inside catch\");console.log(error);setErrors(_objectSpread({},error));console.error(\"There was an error!\",error);props.showToastMessage(\"Error Creating PurchaseReturned!\",\"danger\");});}var _useState23=useState(0.0),_useState24=_slicedToArray(_useState23,2),totalPrice=_useState24[0],setTotalPrice=_useState24[1];function findTotalPrice(){totalPrice=0.00;for(var i=0;i<selectedProducts.length;i++){if(!selectedProducts[i].selected){continue;}totalPrice+=parseFloat(selectedProducts[i].purchase_unit_price)*parseFloat(selectedProducts[i].quantity);}totalPrice=totalPrice.toFixed(2);setTotalPrice(totalPrice);}var _useState25=useState(0.00),_useState26=_slicedToArray(_useState25,2),vatPrice=_useState26[0],setVatPrice=_useState26[1];function findVatPrice(){if(totalPrice>0){vatPrice=(parseFloat(formData.vat_percent)/100*parseFloat(totalPrice-formData.discount)).toFixed(2);;console.log(\"vatPrice:\",vatPrice);setVatPrice(vatPrice);}}var _useState27=useState(0.00),_useState28=_slicedToArray(_useState27,2),netTotal=_useState28[0],setNetTotal=_useState28[1];function findNetTotal(){if(totalPrice>0){netTotal=(parseFloat(totalPrice)-parseFloat(formData.discount)+parseFloat(vatPrice)).toFixed(2);setNetTotal(netTotal);}}var _useState29=useState(0.00),_useState30=_slicedToArray(_useState29,2),discountPercent=_useState30[0],setDiscountPercent=_useState30[1];function findDiscountPercent(){if(!formData.discountValue){formData.discount=0.00;formData.discount_percent=0.00;setFormData(_objectSpread({},formData));return;}formData.discount=formData.discountValue;if(formData.discount>0&&totalPrice>0){discountPercent=parseFloat(parseFloat(formData.discount/totalPrice)*100).toFixed(2);setDiscountPercent(discountPercent);formData.discount_percent=discountPercent;setFormData(_objectSpread({},formData));}}function findDiscount(){if(!formData.discountValue){formData.discount=0.00;formData.discount_percent=0.00;setFormData(_objectSpread({},formData));return;}formData.discount_percent=formData.discountValue;if(formData.discount_percent>0&&totalPrice>0){formData.discount=parseFloat(totalPrice*parseFloat(formData.discount_percent/100)).toFixed(2);}setFormData(_objectSpread({},formData));}function reCalculate(){findTotalPrice();if(formData.is_discount_percent){findDiscount();}else{findDiscountPercent();}findVatPrice();findNetTotal();}var DetailsViewRef=useRef();function openDetailsView(id){DetailsViewRef.current.open(id);}var StoreCreateFormRef=useRef();var ProductCreateFormRef=useRef();function openProductCreateForm(){ProductCreateFormRef.current.open();}function openProductUpdateForm(id){ProductCreateFormRef.current.open(id);}var VendorCreateFormRef=useRef();var UserCreateFormRef=useRef();function openUserCreateForm(){UserCreateFormRef.current.open();}var SignatureCreateFormRef=useRef();function openSignatureCreateForm(){SignatureCreateFormRef.current.open();}var ProductDetailsViewRef=useRef();function openProductDetailsView(id){ProductDetailsViewRef.current.open(id);}var PurchaseDetailsViewRef=useRef();function openPurchaseDetailsView(id){PurchaseDetailsViewRef.current.open(id);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ProductView,{ref:ProductDetailsViewRef,openUpdateForm:openProductUpdateForm,openCreateForm:openProductCreateForm}),/*#__PURE__*/_jsx(ProductCreate,{ref:ProductCreateFormRef,showToastMessage:props.showToastMessage,openDetailsView:openProductDetailsView}),/*#__PURE__*/_jsx(PurchaseReturnedView,{ref:DetailsViewRef}),/*#__PURE__*/_jsx(StoreCreate,{ref:StoreCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(UserCreate,{ref:UserCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(SignatureCreate,{ref:SignatureCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(VendorCreate,{ref:VendorCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(PurchaseView,{ref:PurchaseDetailsViewRef}),/*#__PURE__*/_jsxs(Modal,{show:show,size:\"xl\",onHide:handleClose,animation:false,backdrop:\"static\",scrollable:true,children:[/*#__PURE__*/_jsxs(Modal.Header,{children:[/*#__PURE__*/_jsx(Modal.Title,{children:formData.id?\"Update Purchase Return #\"+formData.code+\" for purchase #\"+formData.purchase_code:\"Create Purchase Return\"+\" for purchase #\"+formData.purchase_code}),/*#__PURE__*/_jsxs(\"div\",{className:\"col align-self-end text-end\",children:[/*#__PURE__*/_jsx(PurchaseReturnedPreview,{}),/*#__PURE__*/_jsxs(Button,{variant:\"primary\",className:\"mb-3\",onClick:handleCreate,children:[isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":\"\",formData.id?\"Update\":\"Create\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:handleClose,\"aria-label\":\"Close\"})]})]}),/*#__PURE__*/_jsxs(Modal.Body,{children:[selectedProducts.length===0&&\"Already Returned All purchased products\",selectedProducts.length>0&&/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 needs-validation\",onSubmit:handleCreate,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Select Products\"}),errors[\"product_id\"]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"product_id\"]]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",style:{overflowX:\"auto\",height:\"400px\",overflowY:\"scroll\"},children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped table-sm table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"th\",{children:\"Select\"}),/*#__PURE__*/_jsx(\"th\",{children:\"SI No.\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Part No.\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Purchase Return Unit Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Purchase Return Price\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:selectedProducts.map(function(product,index){return/*#__PURE__*/_jsxs(\"tr\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedProducts[index].selected,onChange:function onChange(e){console.log(\"e.target.value:\",e.target.value);selectedProducts[index].selected=!selectedProducts[index].selected;if(selectedProducts[index].selected===true){if(selectedProducts[index].quantity===0){selectedProducts[index].quantity=1;}}else{selectedProducts[index].quantity=0;}setSelectedProducts(_toConsumableArray(selectedProducts));reCalculate();}})}),/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:product.part_number}),/*#__PURE__*/_jsx(\"td\",{style:{textDecoration:\"underline\",color:\"blue\",cursor:\"pointer\"},onClick:function onClick(){openProductDetailsView(product.product_id);},children:product.name}),/*#__PURE__*/_jsxs(\"td\",{style:{width:\"155px\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:product.quantity,className:\"form-control\",placeholder:\"Quantity\",onChange:function onChange(e){errors[\"quantity_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){errors[\"quantity_\"+index]=\"Invalid Quantity\";selectedProducts[index].quantity=e.target.value;setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));console.log(\"errors:\",errors);return;}if(parseFloat(e.target.value)===0){errors[\"quantity_\"+index]=\"Quantity should be >0\";selectedProducts[index].quantity=parseFloat(e.target.value);setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));console.log(\"errors:\",errors);return;}product.quantity=parseFloat(e.target.value);reCalculate();selectedProducts[index].quantity=parseFloat(e.target.value);console.log(\"selectedProducts[index].quantity:\",selectedProducts[index].quantity);setSelectedProducts(_toConsumableArray(selectedProducts));reCalculate();}}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",id:\"basic-addon2\",children:selectedProducts[index].unit?selectedProducts[index].unit:\"Units\"})]}),errors[\"quantity_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"quantity_\"+index]]})]}),/*#__PURE__*/_jsxs(\"td\",{style:{width:\"180px\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:product.purchase_unit_price,className:\"form-control\",placeholder:\"Purchase Return Unit Price\",onChange:function onChange(e){errors[\"purchasereturned_unit_price_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){errors[\"purchasereturned_unit_price_\"+index]=\"Invalid Purchase Return Unit Price\";selectedProducts[index].purchase_unit_price=parseFloat(e.target.value);setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));return;}if(e.target.value===0){errors[\"purchasereturned_unit_price_\"+index]=\"Purchase Return Unit Price should be >0\";selectedProducts[index].purchase_unit_price=parseFloat(e.target.value);setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));return;}selectedProducts[index].purchase_unit_price=parseFloat(e.target.value);console.log(\"selectedProducts[index].purchase_unit_price:\",selectedProducts[index].purchase_unit_price);setSelectedProducts(_toConsumableArray(selectedProducts));reCalculate();}}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",id:\"basic-addon2\",children:\"SAR\"})]}),errors[\"purchasereturned_unit_price_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"purchasereturned_unit_price_\"+index]]})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(NumberFormat,{value:(product.purchase_unit_price*product.quantity).toFixed(2),displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]});})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",style:{overflowX:\"auto\"},children:/*#__PURE__*/_jsx(\"table\",{className:\"table table-striped table-sm table-bordered\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-end\",children:\"Total\"}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(NumberFormat,{value:totalPrice,displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"th\",{colSpan:\"6\",className:\"text-end\",children:[\"Discount(  \",formData.discount_percent+\"%\",\")\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(NumberFormat,{value:formData.discount,displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{colSpan:\"5\",className:\"text-end\",children:\"VAT\"}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:formData.vat_percent+\"%\"}),/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",children:/*#__PURE__*/_jsx(NumberFormat,{value:vatPrice,displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-end\",children:\"Net Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-center\",children:/*#__PURE__*/_jsx(NumberFormat,{value:netTotal,displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Date*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(DatePicker,{id:\"date_str\",selected:formData.date_str?new Date(formData.date_str):null,value:formData.date_str?format(new Date(formData.date_str),\"MMMM d, yyyy h:mm aa\"):null,className:\"form-control\",dateFormat:\"MMMM d, yyyy h:mm aa\",showTimeSelect:true,timeIntervals:\"1\",onChange:function onChange(value){console.log(\"Value\",value);formData.date_str=value;// formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\nsetFormData(_objectSpread({},formData));}}),errors.date_str&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.date_str]}),formData.date_str&&!errors.date_str&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Vendor Invoice No. (Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.vendor_invoice_no?formData.vendor_invoice_no:\"\",type:\"string\",onChange:function onChange(e){errors[\"vendor_invoice_no\"]=\"\";setErrors(_objectSpread({},errors));formData.vendor_invoice_no=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"vendor_invoice_no\",placeholder:\"Vendor Invoice No.\"}),errors.vendor_invoice_no&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.vendor_invoice_no]}),formData.vendor_invoice_no&&!errors.rack&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"VAT %*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.vat_percent,type:\"number\",onChange:function onChange(e){console.log(\"Inside onchange vat percent\");if(isNaN(e.target.value)){errors[\"vat_percent\"]=\"Invalid Quantity\";setErrors(_objectSpread({},errors));return;}errors[\"vat_percent\"]=\"\";setErrors(_objectSpread({},errors));formData.vat_percent=e.target.value;setFormData(_objectSpread({},formData));reCalculate();console.log(formData);},className:\"form-control\",id:\"validationCustom01\",placeholder:\"VAT %\",\"aria-label\":\"Select Store\",\"aria-describedby\":\"button-addon1\"}),errors.vat_percent&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.vat_percent]}),formData.vat_percent&&!errors.vat_percent&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Discount*\"}),/*#__PURE__*/_jsx(Form.Check,{type:\"switch\",id:\"custom-switch\",label:\"%\",value:formData.is_discount_percent,checked:formData.is_discount_percent?\"checked\":null,onChange:function onChange(e){formData.is_discount_percent=!formData.is_discount_percent;console.log(\"e.target.value:\",formData.is_discount_percent);setFormData(_objectSpread({},formData));reCalculate();}}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.discountValue,type:\"number\",onChange:function onChange(e){if(parseFloat(e.target.value)===0){formData.discountValue=parseFloat(e.target.value);reCalculate();setFormData(_objectSpread({},formData));errors[\"discount\"]=\"\";setErrors(_objectSpread({},errors));return;}if(!e.target.value){console.log(\"inside invalid\");formData.discountValue=\"\";errors[\"discount\"]=\"Invalid Discount\";setFormData(_objectSpread({},formData));setErrors(_objectSpread({},errors));return;}errors[\"discount\"]=\"\";setErrors(_objectSpread({},errors));console.log(\"e.target.value:\",e.target.value);formData.discountValue=e.target.value;reCalculate();setFormData(_objectSpread({},formData));},className:\"form-control\",id:\"validationCustom02\",placeholder:\"Discount\",\"aria-label\":\"Select Customer\",\"aria-describedby\":\"button-addon2\"}),errors.discount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.discount]}),!errors.discount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),!formData.id?/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Payment method*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:formData.payment_method,disabled:formData.payment_status==\"not_paid\"?\"disabled\":\"\",onChange:function onChange(e){console.log(\"Inside onchange payment method\");if(!e.target.value){errors[\"status\"]=\"Payment Method is required\";setErrors(_objectSpread({},errors));formData.payment_method=\"\";setFormData(_objectSpread({},formData));return;}errors[\"payment_method\"]=\"\";setErrors(_objectSpread({},errors));formData.payment_method=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_account\",children:\"Bank Account  / Debit / Credit Card\"})]}),errors.payment_method&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.payment_method]})]})]}):\"\",!formData.id?/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Payment Status*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:formData.payment_status,onChange:function onChange(e){console.log(\"Inside onchange payment Status\");if(!e.target.value){errors[\"status\"]=\"Payment status is required12\";setErrors(_objectSpread({},errors));formData.payment_status=\"\";setFormData(_objectSpread({},formData));return;}errors[\"payment_status\"]=\"\";setErrors(_objectSpread({},errors));formData.payment_status=e.target.value;if(formData.payment_status!==\"paid_partially\"){formData.partial_payment_amount=0.00;}setFormData(_objectSpread({},formData));if(formData.payment_status==\"not_paid\"){formData.payment_method=\"\";setFormData(_objectSpread({},formData));}console.log(formData);},className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"paid\",children:\"Paid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"not_paid\",children:\"Not Paid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paid_partially\",children:\"Paid Partially\"})]}),errors.payment_status&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.payment_status]})]})]}):\"\",formData.payment_status===\"paid_partially\"?/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Patial Payment Amount*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formData.partial_payment_amount,onChange:function onChange(e){console.log(\"Inside onchange vat discount\");if(!e.target.value){formData.partial_payment_amount=e.target.value;errors[\"partial_payment_amount\"]=\"Invalid partial payment amount\";setErrors(_objectSpread({},errors));return;}formData.partial_payment_amount=parseFloat(e.target.value);errors[\"partial_payment_amount\"]=\"\";if(formData.partial_payment_amount>=netTotal){errors[\"partial_payment_amount\"]=\"Partial payment cannot be >= \"+netTotal;setErrors(_objectSpread({},errors));return;}setErrors(_objectSpread({},errors));setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"validationCustom02\",placeholder:\"Amount\"}),errors.partial_payment_amount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.partial_payment_amount]})]})]}):\"\",/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleCreate,children:isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":formData.id?\"Update\":\"Create\"})]})]})]})]})]});});export default PurchaseReturnedCreate;","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/purchase_return/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","PurchaseReturnedPreview","Modal","Button","Form","StoreCreate","VendorCreate","ProductCreate","UserCreate","SignatureCreate","Cookies","Typeahead","NumberFormat","DatePicker","format","Spinner","PurchaseReturnedView","ProductView","PurchaseView","PurchaseReturnedCreate","props","ref","open","id","purchaseId","selectedProducts","setSelectedProducts","selectedPurchaseReturnedByUsers","setSelectedPurchaseReturnedByUsers","selectedPurchaseReturnedBySignatures","setSelectedPurchaseReturnedBySignatures","formData","vat_percent","discount","discountValue","discount_percent","is_discount_percent","date_str","Date","signature_date_str","payment_status","payment_method","setFormData","cookies","get","name","purchase_returned_by","getPurchaseReturn","getPurchase","setShow","listener","event","code","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","preventDefault","document","addEventListener","removeEventListener","selectedDate","errors","setErrors","isProcessing","setProcessing","purchaseReturnedByUserOptions","setPurchaseReturnedByUserOptions","isPurchaseReturnedByUsersLoading","setIsPurchaseReturnedByUsersLoading","purchaseReturnedBySignatureOptions","setPurchaseReturnedBySignatureOptions","isPurchaseReturnedBySignaturesLoading","setIsPurchaseReturnedBySignaturesLoading","show","handleClose","at","window","location","requestOptions","method","headers","fetch","then","response","isJson","json","data","ok","error","Promise","reject","purchaseReturn","result","store_id","vendor_id","date","status","order_placed_by","order_placed_by_signature_id","partial_payment_amount","shipping_handling_fees","products","selectedProductsTemp","i","length","quantity","selected","push","purchase_unit_price","purchasereturn_unit_price","reCalculate","catch","purchase","purchase_id","purchase_code","purchase_returned_by_signature_id","purchasedQty","quantity_returned","ObjectToSearchQueryParams","object","Object","keys","map","key","join","suggestUsers","searchTerm","params","queryString","Authorization","Select","suggestSignatures","handleCreate","product_id","parseFloat","unit","netTotal","endPoint","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","totalPrice","setTotalPrice","findTotalPrice","toFixed","vatPrice","setVatPrice","findVatPrice","setNetTotal","findNetTotal","discountPercent","setDiscountPercent","findDiscountPercent","findDiscount","DetailsViewRef","current","StoreCreateFormRef","ProductCreateFormRef","openProductCreateForm","openProductUpdateForm","VendorCreateFormRef","UserCreateFormRef","openUserCreateForm","SignatureCreateFormRef","openSignatureCreateForm","ProductDetailsViewRef","openProductDetailsView","PurchaseDetailsViewRef","openPurchaseDetailsView","color","overflowX","height","overflowY","product","e","value","part_number","textDecoration","cursor","width","vendor_invoice_no","rack","isNaN"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport PurchaseReturnedPreview from \"./preview.js\";\nimport { Modal, Button, Form } from \"react-bootstrap\";\nimport StoreCreate from \"../store/create.js\";\nimport VendorCreate from \"../vendor/create.js\";\nimport ProductCreate from \"../product/create.js\";\nimport UserCreate from \"../user/create.js\";\nimport SignatureCreate from \"../signature/create.js\";\nimport Cookies from \"universal-cookie\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport NumberFormat from \"react-number-format\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\nimport { Spinner } from \"react-bootstrap\";\nimport PurchaseReturnedView from \"./view.js\";\nimport ProductView from \"../product/view.js\";\nimport PurchaseView from \"./../purchase/view.js\";\n\n\nconst PurchaseReturnedCreate = forwardRef((props, ref) => {\n\n    useImperativeHandle(ref, () => ({\n        open(id, purchaseId) {\n\n            selectedProducts = [];\n            setSelectedProducts([]);\n\n            selectedPurchaseReturnedByUsers = [];\n            setSelectedPurchaseReturnedByUsers([]);\n\n            selectedPurchaseReturnedBySignatures = [];\n            setSelectedPurchaseReturnedBySignatures([]);\n\n\n            formData = {\n                vat_percent: 15.0,\n                discount: 0.0,\n                discountValue: 0.0,\n                discount_percent: 0.0,\n                is_discount_percent: false,\n                date_str: new Date(),\n                signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n                payment_status: \"paid\",\n                payment_method: \"\",\n            };\n\n            setFormData({ ...formData });\n\n            if (cookies.get(\"user_id\")) {\n                selectedPurchaseReturnedByUsers = [{\n                    id: cookies.get(\"user_id\"),\n                    name: cookies.get(\"user_name\"),\n                }];\n                formData.purchase_returned_by = cookies.get(\"user_id\");\n                setFormData({ ...formData });\n                setSelectedPurchaseReturnedByUsers([...selectedPurchaseReturnedByUsers]);\n            }\n\n            setFormData({ ...formData });\n\n\n            if (id) {\n                getPurchaseReturn(id);\n            }\n\n            if (purchaseId) {\n                getPurchase(purchaseId);\n            }\n            setShow(true);\n        },\n\n    }));\n\n\n    useEffect(() => {\n        const listener = event => {\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n                console.log(\"Enter key was pressed. Run your function-purchase return.\");\n                // event.preventDefault();\n\n                var form = event.target.form;\n                if (form && event.target) {\n                    var index = Array.prototype.indexOf.call(form, event.target);\n                    if (form && form.elements[index + 1]) {\n                        if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n                            form.elements[index].focus();\n                        } else {\n                            form.elements[index + 1].focus();\n                        }\n                        event.preventDefault();\n                    }\n                }\n            }\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => {\n            document.removeEventListener(\"keydown\", listener);\n        };\n    }, []);\n\n    const selectedDate = new Date();\n\n    //const history = useHistory();\n    let [errors, setErrors] = useState({});\n    const [isProcessing, setProcessing] = useState(false);\n    const cookies = new Cookies();\n\n    //fields\n    let [formData, setFormData] = useState({\n        vat_percent: 10.0,\n        discount: 0.0,\n        discountValue: 0.0,\n        discount_percent: 0.0,\n        is_discount_percent: false,\n        //   date_str: format(new Date(), \"MMM dd yyyy\"),\n        date_str: new Date(),\n        signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n        payment_status: \"paid\",\n        payment_method: \"\",\n    });\n\n\n    let [selectedProducts, setSelectedProducts] = useState([]);\n\n    //Purchase Returned By Auto Suggestion\n    const [purchaseReturnedByUserOptions, setPurchaseReturnedByUserOptions] = useState([]);\n    let [selectedPurchaseReturnedByUsers, setSelectedPurchaseReturnedByUsers] = useState([]);\n    const [isPurchaseReturnedByUsersLoading, setIsPurchaseReturnedByUsersLoading] = useState(false);\n\n    //Purchase Returned By Signature Auto Suggestion\n    const [purchaseReturnedBySignatureOptions, setPurchaseReturnedBySignatureOptions] =\n        useState([]);\n    let [selectedPurchaseReturnedBySignatures, setSelectedPurchaseReturnedBySignatures] =\n        useState([]);\n    const [isPurchaseReturnedBySignaturesLoading, setIsPurchaseReturnedBySignaturesLoading] =\n        useState(false);\n\n    const [show, setShow] = useState(false);\n\n    function handleClose() {\n        setShow(false);\n    }\n\n    useEffect(() => {\n        let at = cookies.get(\"access_token\");\n        if (!at) {\n            // history.push(\"/dashboard/purchasereturneds\");\n            window.location = \"/\";\n        }\n    });\n\n\n\n    function getPurchaseReturn(id) {\n        console.log(\"inside get PurchaseReturned id:\", id);\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n\n        fetch('/v1/purchase-return/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n                console.log(\"Response:\");\n                console.log(data);\n\n                let purchaseReturn = data.result;\n               // formData = purchaseReturn;\n\n                formData = {\n                    id: purchaseReturn.id,\n                    code: purchaseReturn.code,\n                    store_id: purchaseReturn.store_id,\n                    vendor_id: purchaseReturn.vendor_id,\n                    date_str: purchaseReturn.date,\n                    // date: purchase.date,\n                    vat_percent: purchaseReturn.vat_percent,\n                    discount: purchaseReturn.discount,\n                    discount_percent: purchaseReturn.discount_percent,\n                    status: purchaseReturn.status,\n                    order_placed_by: purchaseReturn.order_placed_by,\n                    order_placed_by_signature_id: purchaseReturn.order_placed_by_signature_id,\n                    is_discount_percent: purchaseReturn.is_discount_percent,\n                    partial_payment_amount: purchaseReturn.partial_payment_amount,\n                    payment_method: purchaseReturn.payment_method,\n                    payment_status: purchaseReturn.payment_status,\n                    shipping_handling_fees: purchaseReturn.shipping_handling_fees,\n                };\n\n                /*\n                formData = {\n                    date_str: format(new Date(), \"MMM dd yyyy\"),\n                    signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n                    purchase_id: purchase.id,\n                    purchase_code: purchase.code,\n                    vendor_invoice_no: purchase.vendor_invoice_no,\n                    store_id: purchase.store_id,\n                    vendor_id: purchase.vendor_id,\n                    vat_percent: purchase.vat_percent,\n                    status: purchase.status,\n                    purchase_returned_by: purchase.order_placed_by,\n                    purchase_returned_by_signature_id: purchase.order_placed_by_signature_id,\n                    is_discount_percent: purchase.is_discount_percent,\n                    discount_percent: purchase.discount_percent,\n                };\n                */\n\n                //formData.discount = (purchase.discount - purchase.return_discount);\n                // formData.discount = 0;\n\n                if (formData.is_discount_percent) {\n                    formData.discountValue = formData.discount_percent;\n                } else {\n                    formData.discountValue = formData.discount;\n                }\n\n\n                setFormData({ ...formData });\n\n                console.log(\"formData1.status:\", formData.status);\n\n\n                console.log(\"purchaseReturn.products:\", purchaseReturn.products);\n\n                let selectedProductsTemp = purchaseReturn.products;\n\n                selectedProducts = [];\n                for (let i = 0; i < selectedProductsTemp.length; i++) {\n                    if (selectedProductsTemp[i].quantity > 0) {\n                        selectedProductsTemp[i].selected = true;\n                    } else {\n                        selectedProductsTemp[i].selected = false;\n                    }\n                    selectedProducts.push(selectedProductsTemp[i]);\n\n                    selectedProductsTemp[i].purchase_unit_price = selectedProductsTemp[i].purchasereturn_unit_price;\n                }\n\n\n                setSelectedProducts([...selectedProducts]);\n\n                setFormData({ ...formData });\n                reCalculate();\n                setFormData({ ...formData });\n\n\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n\n    function getPurchase(id) {\n        console.log(\"inside get Purchase\");\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n\n        fetch('/v1/purchase/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n                console.log(\"Response:\");\n                console.log(data);\n\n                let purchase = data.result;\n                formData = {\n                    // date_str: format(new Date(), \"MMM dd yyyy\"),\n                    date_str: new Date(),\n                    signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n                    purchase_id: purchase.id,\n                    purchase_code: purchase.code,\n                    //   vendor_invoice_no: purchase.vendor_invoice_no,\n                    store_id: purchase.store_id,\n                    vendor_id: purchase.vendor_id,\n                    vat_percent: purchase.vat_percent,\n                    status: purchase.status,\n                    purchase_returned_by: purchase.order_placed_by,\n                    purchase_returned_by_signature_id: purchase.order_placed_by_signature_id,\n                    is_discount_percent: purchase.is_discount_percent,\n                    discount_percent: purchase.discount_percent,\n                    payment_status: \"paid\",\n                    payment_method: \"\",\n                };\n\n                //formData.discount = (purchase.discount - purchase.return_discount);\n                formData.discount = 0;\n\n                if (formData.is_discount_percent) {\n                    formData.discountValue = formData.discount_percent;\n                } else {\n                    formData.discountValue = formData.discount;\n                }\n\n                formData.discountValue = 0;\n\n                //formData.status = \"purchase_returned\";\n\n                setFormData({ ...formData });\n                console.log(\"formData1.status:\", formData.status);\n\n\n                let selectedProductsTemp = purchase.products;\n\n                selectedProducts = [];\n                for (let i = 0; i < selectedProductsTemp.length; i++) {\n                    selectedProductsTemp[i].selected = false;\n                    let purchasedQty = selectedProductsTemp[i].quantity - selectedProductsTemp[i].quantity_returned;\n                    selectedProductsTemp[i].quantity = purchasedQty;\n\n                    if (purchasedQty > 0) {\n                        selectedProducts.push(selectedProductsTemp[i]);\n                    }\n                }\n\n\n                setSelectedProducts([...selectedProducts]);\n\n                setFormData({ ...formData });\n                reCalculate();\n                setFormData({ ...formData });\n\n\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n    function ObjectToSearchQueryParams(object) {\n        return Object.keys(object)\n            .map(function (key) {\n                return `search[${key}]=${object[key]}`;\n            })\n            .join(\"&\");\n    }\n\n    async function suggestUsers(searchTerm) {\n        console.log(\"Inside handle suggestUsers\");\n        setPurchaseReturnedByUserOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsPurchaseReturnedByUsersLoading(true);\n        let result = await fetch(\n            \"/v1/user?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setPurchaseReturnedByUserOptions(data.result);\n        setIsPurchaseReturnedByUsersLoading(false);\n    }\n\n    async function suggestSignatures(searchTerm) {\n        console.log(\"Inside handle suggestSignatures\");\n        setPurchaseReturnedBySignatureOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsPurchaseReturnedBySignaturesLoading(true);\n        let result = await fetch(\n            \"/v1/signature?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setPurchaseReturnedBySignatureOptions(data.result);\n        setIsPurchaseReturnedBySignaturesLoading(false);\n    }\n\n    function handleCreate(event) {\n        console.log(\"formData:\", formData);\n        console.log(\"formData.payment_status:\" + formData.payment_status);\n        event.preventDefault();\n        console.log(\"Inside handle Create\");\n        console.log(\"selectedProducts:\", selectedProducts);\n\n        formData.products = [];\n        for (var i = 0; i < selectedProducts.length; i++) {\n            if (!selectedProducts[i].selected) {\n                continue;\n                // selectedProducts[i].quantity = 0;\n            }\n\n            formData.products.push({\n                product_id: selectedProducts[i].product_id,\n                quantity: parseFloat(selectedProducts[i].quantity),\n                unit: selectedProducts[i].unit,\n                purchasereturn_unit_price: parseFloat(selectedProducts[i].purchase_unit_price),\n            });\n        }\n\n        formData.discount = parseFloat(formData.discount);\n        formData.discount_percent = parseFloat(formData.discount_percent);\n\n        formData.vat_percent = parseFloat(formData.vat_percent);\n        console.log(\"formData.discount:\", formData.discount);\n\n        if (formData.payment_status === \"paid_partially\" && !formData.partial_payment_amount && formData.partial_payment_amount !== 0) {\n            errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (formData.payment_status === \"paid_partially\" && formData.partial_payment_amount <= 0) {\n            errors[\"partial_payment_amount\"] = \"Partial payment should be > 0 \";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (formData.payment_status === \"paid_partially\" && formData.partial_payment_amount >= netTotal) {\n            errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n            setErrors({ ...errors });\n            return;\n        }\n\n        errors[\"payment_method\"] = \"\";\n        setErrors({ ...errors });\n        if (!formData.id && formData.payment_status != \"not_paid\" && !formData.payment_method) {\n            errors[\"payment_method\"] = \"Payment method is required\";\n            setErrors({ ...errors });\n            return;\n        }\n\n\n\n\n        if (!formData.discountValue && formData.discountValue !== 0) {\n            errors[\"discount\"] = \"Invalid Discount\";\n            setErrors({ ...errors });\n            return;\n        }\n\n\n        let endPoint = \"/v1/purchase-return\";\n        let method = \"POST\";\n        if (formData.id) {\n            endPoint = \"/v1/purchase-return/\" + formData.id;\n            method = \"PUT\";\n        }\n\n\n        const requestOptions = {\n            method: method,\n            headers: {\n                'Accept': 'application/json',\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n            body: JSON.stringify(formData),\n        };\n\n        setProcessing(true);\n        fetch(endPoint, requestOptions)\n            .then(async (response) => {\n                const isJson = response.headers\n                    .get(\"content-type\")\n                    ?.includes(\"application/json\");\n                const data = isJson && (await response.json());\n\n                // check for error response\n                if (!response.ok) {\n                    // get error message from body or default to response status\n                    const error = data && data.errors;\n                    //const error = data.errors\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n                setProcessing(false);\n\n                console.log(\"Response:\");\n                console.log(data);\n                props.showToastMessage(\"Purchase Return Created Successfully!\", \"success\");\n                if (props.refreshList) {\n                    props.refreshList();\n                }\n                handleClose();\n                openDetailsView(data.result.id);\n            })\n            .catch((error) => {\n                setProcessing(false);\n                console.log(\"Inside catch\");\n                console.log(error);\n                setErrors({ ...error });\n                console.error(\"There was an error!\", error);\n                props.showToastMessage(\"Error Creating PurchaseReturned!\", \"danger\");\n            });\n    }\n\n\n    let [totalPrice, setTotalPrice] = useState(0.0);\n\n    function findTotalPrice() {\n        totalPrice = 0.00;\n        for (var i = 0; i < selectedProducts.length; i++) {\n            if (!selectedProducts[i].selected) {\n                continue;\n            }\n            totalPrice +=\n                parseFloat(selectedProducts[i].purchase_unit_price) *\n                parseFloat(selectedProducts[i].quantity);\n        }\n        totalPrice = totalPrice.toFixed(2);\n        setTotalPrice(totalPrice);\n    }\n\n    let [vatPrice, setVatPrice] = useState(0.00);\n\n    function findVatPrice() {\n        if (totalPrice > 0) {\n            vatPrice = ((parseFloat(formData.vat_percent) / 100) * parseFloat(totalPrice - formData.discount)).toFixed(2);;\n            console.log(\"vatPrice:\", vatPrice);\n            setVatPrice(vatPrice);\n        }\n\n    }\n\n\n    let [netTotal, setNetTotal] = useState(0.00);\n\n    function findNetTotal() {\n        if (totalPrice > 0) {\n            netTotal = (parseFloat(totalPrice) - parseFloat(formData.discount) + parseFloat(vatPrice)).toFixed(2);\n            setNetTotal(netTotal);\n        }\n\n    }\n\n    let [discountPercent, setDiscountPercent] = useState(0.00);\n\n    function findDiscountPercent() {\n        if (!formData.discountValue) {\n            formData.discount = 0.00;\n            formData.discount_percent = 0.00;\n            setFormData({ ...formData });\n            return;\n        }\n\n        formData.discount = formData.discountValue;\n\n        if (formData.discount > 0 && totalPrice > 0) {\n            discountPercent = parseFloat(parseFloat(formData.discount / totalPrice) * 100).toFixed(2);\n            setDiscountPercent(discountPercent);\n            formData.discount_percent = discountPercent;\n            setFormData({ ...formData });\n        }\n\n    }\n\n    function findDiscount() {\n        if (!formData.discountValue) {\n            formData.discount = 0.00;\n            formData.discount_percent = 0.00;\n            setFormData({ ...formData });\n            return;\n        }\n\n        formData.discount_percent = formData.discountValue;\n\n        if (formData.discount_percent > 0 && totalPrice > 0) {\n            formData.discount = parseFloat(totalPrice * parseFloat(formData.discount_percent / 100)).toFixed(2);\n        }\n        setFormData({ ...formData });\n    }\n\n\n    function reCalculate() {\n        findTotalPrice();\n        if (formData.is_discount_percent) {\n            findDiscount();\n        } else {\n            findDiscountPercent();\n        }\n        findVatPrice();\n        findNetTotal();\n    }\n\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        DetailsViewRef.current.open(id);\n    }\n\n    const StoreCreateFormRef = useRef();\n\n    const ProductCreateFormRef = useRef();\n    function openProductCreateForm() {\n        ProductCreateFormRef.current.open();\n    }\n\n    function openProductUpdateForm(id) {\n        ProductCreateFormRef.current.open(id);\n    }\n\n    const VendorCreateFormRef = useRef();\n\n    const UserCreateFormRef = useRef();\n    function openUserCreateForm() {\n        UserCreateFormRef.current.open();\n    }\n\n\n    const SignatureCreateFormRef = useRef();\n    function openSignatureCreateForm() {\n        SignatureCreateFormRef.current.open();\n    }\n\n    const ProductDetailsViewRef = useRef();\n    function openProductDetailsView(id) {\n        ProductDetailsViewRef.current.open(id);\n    }\n\n    const PurchaseDetailsViewRef = useRef();\n    function openPurchaseDetailsView(id) {\n        PurchaseDetailsViewRef.current.open(id);\n    }\n\n\n    return (\n        <>\n            <ProductView ref={ProductDetailsViewRef} openUpdateForm={openProductUpdateForm} openCreateForm={openProductCreateForm} />\n            <ProductCreate ref={ProductCreateFormRef} showToastMessage={props.showToastMessage} openDetailsView={openProductDetailsView} />\n\n\n\n            <PurchaseReturnedView ref={DetailsViewRef} />\n            <StoreCreate ref={StoreCreateFormRef} showToastMessage={props.showToastMessage} />\n            <UserCreate ref={UserCreateFormRef} showToastMessage={props.showToastMessage} />\n            <SignatureCreate ref={SignatureCreateFormRef} showToastMessage={props.showToastMessage} />\n            <VendorCreate ref={VendorCreateFormRef} showToastMessage={props.showToastMessage} />\n            <PurchaseView ref={PurchaseDetailsViewRef} />\n            <Modal show={show} size=\"xl\" onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n                <Modal.Header>\n                    <Modal.Title>\n                        {formData.id ? \"Update Purchase Return #\" + formData.code + \" for purchase #\" + formData.purchase_code : \"Create Purchase Return\" + \" for purchase #\" + formData.purchase_code}\n                        {/*\n                        {formData.purchase_id ? \" for Purchase #\" + <span style={{\n                            textDecoration: \"underline\",\n                            color: \"blue\",\n                            cursor: \"pointer\",\n                        }}\n                            onClick={() => {\n                                openPurchaseDetailsView(formData.purchase_id);\n                            }}> formData.purchase_code : \"\"} </span> : \"\"}\n                        */}\n                    </Modal.Title>\n\n                    <div className=\"col align-self-end text-end\">\n                        <PurchaseReturnedPreview />\n                        <Button variant=\"primary\" className=\"mb-3\" onClick={handleCreate} >\n                            {isProcessing ?\n                                <Spinner\n                                    as=\"span\"\n                                    animation=\"border\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden={true}\n                                /> + \" Creating...\"\n\n                                : \"\"\n                            }\n                            {formData.id ? \"Update\" : \"Create\"}\n\n                        </Button>\n                        <button\n                            type=\"button\"\n                            className=\"btn-close\"\n                            onClick={handleClose}\n                            aria-label=\"Close\"\n                        ></button>\n                    </div>\n                </Modal.Header>\n                <Modal.Body>\n                    {selectedProducts.length === 0 && \"Already Returned All purchased products\"}\n\n                    {selectedProducts.length > 0 && <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n\n                        <h2>Select Products</h2>\n                        {errors[\"product_id\"] && (\n                            <div style={{ color: \"red\" }}>\n                                <i className=\"bi bi-x-lg\"> </i>\n                                {errors[\"product_id\"]}\n                            </div>\n                        )}\n                        <div className=\"table-responsive\" style={{ overflowX: \"auto\", height: \"400px\", overflowY: \"scroll\" }}>\n                            <table className=\"table table-striped table-sm table-bordered\">\n                                <thead>\n                                    <tr className=\"text-center\">\n                                        <th>Select</th>\n                                        <th>SI No.</th>\n                                        <th>Part No.</th>\n                                        <th>Name</th>\n                                        <th>Qty</th>\n                                        <th>Purchase Return Unit Price</th>\n                                        <th>Purchase Return Price</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {selectedProducts.map((product, index) => (\n                                        <tr className=\"text-center\">\n                                            <td>\n                                                <input type=\"checkbox\" checked={selectedProducts[index].selected} onChange={(e) => {\n                                                    console.log(\"e.target.value:\", e.target.value)\n                                                    selectedProducts[index].selected = !selectedProducts[index].selected;\n                                                    if (selectedProducts[index].selected === true) {\n                                                        if (selectedProducts[index].quantity === 0) {\n                                                            selectedProducts[index].quantity = 1;\n                                                        }\n                                                    } else {\n                                                        selectedProducts[index].quantity = 0;\n                                                    }\n                                                    setSelectedProducts([...selectedProducts]);\n                                                    reCalculate();\n                                                }} />\n                                            </td>\n                                            <td>{index + 1}</td>\n                                            <td>{product.part_number}</td>\n                                            <td style={{\n                                                textDecoration: \"underline\",\n                                                color: \"blue\",\n                                                cursor: \"pointer\",\n                                            }}\n                                                onClick={() => {\n                                                    openProductDetailsView(product.product_id);\n                                                }}>{product.name}\n                                            </td>\n                                            <td style={{ width: \"155px\" }}>\n\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"number\" value={product.quantity} className=\"form-control\"\n\n                                                        placeholder=\"Quantity\" onChange={(e) => {\n                                                            errors[\"quantity_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n                                                            if (!e.target.value) {\n                                                                errors[\"quantity_\" + index] = \"Invalid Quantity\";\n                                                                selectedProducts[index].quantity = e.target.value;\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            if (parseFloat(e.target.value) === 0) {\n                                                                errors[\"quantity_\" + index] = \"Quantity should be >0\";\n                                                                selectedProducts[index].quantity = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            product.quantity = parseFloat(e.target.value);\n                                                            reCalculate();\n\n                                                            selectedProducts[index].quantity = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].quantity:\", selectedProducts[index].quantity);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                    <span className=\"input-group-text\" id=\"basic-addon2\">{selectedProducts[index].unit ? selectedProducts[index].unit : \"Units\"}</span>\n                                                </div>\n                                                {errors[\"quantity_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        <i className=\"bi bi-x-lg\"> </i>\n                                                        {errors[\"quantity_\" + index]}\n                                                    </div>\n                                                )}\n\n                                            </td>\n                                            <td style={{ width: \"180px\" }}>\n                                                <div className=\"input-group mb-3\">\n\n                                                    <input type=\"number\" value={product.purchase_unit_price} className=\"form-control\"\n\n                                                        placeholder=\"Purchase Return Unit Price\" onChange={(e) => {\n                                                            errors[\"purchasereturned_unit_price_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n\n                                                            if (!e.target.value) {\n                                                                errors[\"purchasereturned_unit_price_\" + index] = \"Invalid Purchase Return Unit Price\";\n                                                                selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                return;\n                                                            }\n\n                                                            if (e.target.value === 0) {\n                                                                errors[\"purchasereturned_unit_price_\" + index] = \"Purchase Return Unit Price should be >0\";\n                                                                selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                return;\n                                                            }\n\n                                                            selectedProducts[index].purchase_unit_price = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].purchase_unit_price:\", selectedProducts[index].purchase_unit_price);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                    <span className=\"input-group-text\" id=\"basic-addon2\">SAR</span>\n                                                </div>\n                                                {errors[\"purchasereturned_unit_price_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        <i className=\"bi bi-x-lg\"> </i>\n                                                        {errors[\"purchasereturned_unit_price_\" + index]}\n                                                    </div>\n                                                )}\n\n                                            </td>\n                                            <td>\n                                                <NumberFormat\n                                                    value={(product.purchase_unit_price * product.quantity).toFixed(2)}\n                                                    displayType={\"text\"}\n                                                    thousandSeparator={true}\n                                                    suffix={\" SAR\"}\n                                                    renderText={(value, props) => value}\n                                                />\n                                            </td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                        <div className=\"table-responsive\" style={{ overflowX: \"auto\" }}>\n                            <table className=\"table table-striped table-sm table-bordered\">\n                                <tbody>\n                                    <tr>\n                                        <td colSpan=\"5\"></td>\n                                        <th className=\"text-end\">Total</th>\n                                        <td className=\"text-center\">\n                                            <NumberFormat\n                                                value={totalPrice}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\" SAR\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </td>\n                                    </tr>\n\n                                    <tr>\n                                        <th colSpan=\"6\" className=\"text-end\">\n                                            Discount(  {formData.discount_percent + \"%\"})\n                                        </th>\n                                        <td className=\"text-center\">\n                                            <NumberFormat\n                                                value={formData.discount}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\" SAR\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <th colSpan=\"5\" className=\"text-end\">\n                                            VAT\n                                        </th>\n                                        <td className=\"text-center\">{formData.vat_percent + \"%\"}</td>\n                                        <td className=\"text-center\">\n                                            <NumberFormat\n                                                value={vatPrice}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\" SAR\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <td colSpan=\"5\"></td>\n                                        <th className=\"text-end\">Net Total</th>\n                                        <th className=\"text-center\">\n                                            <NumberFormat\n                                                value={netTotal}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\" SAR\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </th>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Date*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    selected={formData.date_str ? new Date(formData.date_str) : null}\n                                    value={formData.date_str ? format(\n                                        new Date(formData.date_str),\n                                        \"MMMM d, yyyy h:mm aa\"\n                                    ) : null}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                    showTimeSelect\n                                    timeIntervals=\"1\"\n                                    onChange={(value) => {\n                                        console.log(\"Value\", value);\n                                        formData.date_str = value;\n                                        // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                                {formData.date_str && !errors.date_str && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-3\">\n                            <label className=\"form-label\">Vendor Invoice No. (Optional)</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.vendor_invoice_no ? formData.vendor_invoice_no : \"\"}\n                                    type='string'\n                                    onChange={(e) => {\n                                        errors[\"vendor_invoice_no\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.vendor_invoice_no = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"vendor_invoice_no\"\n                                    placeholder=\"Vendor Invoice No.\"\n                                />\n                                {errors.vendor_invoice_no && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.vendor_invoice_no}\n                                    </div>\n                                )}\n                                {formData.vendor_invoice_no && !errors.rack && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">VAT %*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.vat_percent}\n                                    type='number'\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange vat percent\");\n                                        if (isNaN(e.target.value)) {\n                                            errors[\"vat_percent\"] = \"Invalid Quantity\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        errors[\"vat_percent\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.vat_percent = e.target.value;\n                                        setFormData({ ...formData });\n                                        reCalculate();\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"validationCustom01\"\n                                    placeholder=\"VAT %\"\n                                    aria-label=\"Select Store\"\n                                    aria-describedby=\"button-addon1\"\n                                />\n                                {errors.vat_percent && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.vat_percent}\n                                    </div>\n                                )}\n                                {formData.vat_percent && !errors.vat_percent && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Discount*</label>\n                            <Form.Check\n                                type=\"switch\"\n                                id=\"custom-switch\"\n                                label=\"%\"\n                                value={formData.is_discount_percent}\n                                checked={formData.is_discount_percent ? \"checked\" : null}\n                                onChange={(e) => {\n                                    formData.is_discount_percent = !formData.is_discount_percent;\n                                    console.log(\"e.target.value:\", formData.is_discount_percent);\n                                    setFormData({ ...formData });\n                                    reCalculate();\n                                }}\n                            />\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.discountValue}\n                                    type='number'\n                                    onChange={(e) => {\n                                        if (parseFloat(e.target.value) === 0) {\n                                            formData.discountValue = parseFloat(e.target.value);\n                                            reCalculate();\n                                            setFormData({ ...formData });\n                                            errors[\"discount\"] = \"\";\n                                            setErrors({ ...errors });\n\n                                            return;\n                                        }\n\n                                        if (!e.target.value) {\n                                            console.log(\"inside invalid\");\n                                            formData.discountValue = \"\";\n                                            errors[\"discount\"] = \"Invalid Discount\";\n                                            setFormData({ ...formData });\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        errors[\"discount\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        console.log(\"e.target.value:\", e.target.value);\n                                        formData.discountValue = e.target.value;\n\n                                        reCalculate();\n                                        setFormData({ ...formData });\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"validationCustom02\"\n                                    placeholder=\"Discount\"\n                                    aria-label=\"Select Customer\"\n                                    aria-describedby=\"button-addon2\"\n                                />\n                                {errors.discount && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.discount}\n                                    </div>\n                                )}\n                                {!errors.discount && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n\n                        </div>\n\n\n                        {!formData.id ? <div className=\"col-md-2\">\n                            <label className=\"form-label\">Payment method*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <select\n                                    value={formData.payment_method}\n                                    disabled={formData.payment_status == \"not_paid\" ? \"disabled\" : \"\"}\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange payment method\");\n                                        if (!e.target.value) {\n                                            errors[\"status\"] = \"Payment Method is required\";\n                                            setErrors({ ...errors });\n                                            formData.payment_method = \"\";\n                                            setFormData({ ...formData });\n                                            return;\n                                        }\n\n                                        errors[\"payment_method\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.payment_method = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                >\n                                    <option value=\"\">Select</option>\n                                    <option value=\"cash\">Cash</option>\n                                    <option value=\"bank_account\">Bank Account  / Debit / Credit Card</option>\n                                </select>\n                                {errors.payment_method && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.payment_method}\n                                    </div>\n                                )}\n                            </div>\n                        </div> : \"\"}\n\n                        {!formData.id ? <div className=\"col-md-2\">\n                            <label className=\"form-label\">Payment Status*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <select\n                                    value={formData.payment_status}\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange payment Status\");\n                                        if (!e.target.value) {\n                                            errors[\"status\"] = \"Payment status is required12\";\n                                            setErrors({ ...errors });\n                                            formData.payment_status = \"\";\n                                            setFormData({ ...formData });\n                                            return;\n                                        }\n\n                                        errors[\"payment_status\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.payment_status = e.target.value;\n                                        if (formData.payment_status !== \"paid_partially\") {\n                                            formData.partial_payment_amount = 0.00;\n                                        }\n                                        setFormData({ ...formData });\n\n\n                                        if (formData.payment_status == \"not_paid\") {\n                                            formData.payment_method = \"\";\n                                            setFormData({ ...formData });\n                                        }\n\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                >\n                                    <option value=\"paid\">Paid</option>\n                                    <option value=\"not_paid\">Not Paid</option>\n                                    <option value=\"paid_partially\">Paid Partially</option>\n                                </select>\n                                {errors.payment_status && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.payment_status}\n                                    </div>\n                                )}\n                            </div>\n                        </div> : \"\"}\n\n\n                        {formData.payment_status === \"paid_partially\" ? <div className=\"col-md-3\">\n                            <label className=\"form-label\">Patial Payment Amount*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    type='number'\n                                    value={formData.partial_payment_amount}\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange vat discount\");\n                                        if (!e.target.value) {\n                                            formData.partial_payment_amount = e.target.value;\n                                            errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n                                        formData.partial_payment_amount = parseFloat(e.target.value);\n                                        errors[\"partial_payment_amount\"] = \"\";\n\n                                        if (formData.partial_payment_amount >= netTotal) {\n                                            errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n                                        setErrors({ ...errors });\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"validationCustom02\"\n                                    placeholder=\"Amount\"\n                                />\n                                {errors.partial_payment_amount && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.partial_payment_amount}\n                                    </div>\n                                )}\n                            </div>\n                        </div> : \"\"}\n\n\n                        <Modal.Footer>\n                            <Button variant=\"secondary\" onClick={handleClose}>\n                                Close\n                            </Button>\n                            <Button variant=\"primary\" onClick={handleCreate} >\n                                {isProcessing ?\n                                    <Spinner\n                                        as=\"span\"\n                                        animation=\"border\"\n                                        size=\"sm\"\n                                        role=\"status\"\n                                        aria-hidden={true}\n                                    /> + \" Creating...\"\n\n                                    : formData.id ? \"Update\" : \"Create\"\n                                }\n                            </Button>\n                        </Modal.Footer>\n                    </form>}\n                </Modal.Body>\n\n            </Modal>\n\n\n        </>\n    );\n});\n\nexport default PurchaseReturnedCreate;\n"]},"metadata":{},"sourceType":"module"}