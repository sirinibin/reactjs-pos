{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef,forwardRef,useImperativeHandle}from\"react\";import{Modal,Button,Form}from\"react-bootstrap\";import Cookies from\"universal-cookie\";import{Spinner}from\"react-bootstrap\";import UserView from\"./view.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UserCreate=/*#__PURE__*/forwardRef(function(props,ref){useImperativeHandle(ref,function(){return{open:function open(id){formData={};setFormData({});if(id){getUser(id);}SetShow(true);}};});useEffect(function(){var listener=function listener(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){console.log(\"Enter key was pressed. Run your function.\");// event.preventDefault();\nvar form=event.target.form;if(form&&event.target){var index=Array.prototype.indexOf.call(form,event.target);if(form&&form.elements[index+1]){if(event.target.getAttribute(\"class\").includes(\"barcode\")){form.elements[index].focus();}else{form.elements[index+1].focus();}event.preventDefault();}}}};document.addEventListener(\"keydown\",listener);return function(){document.removeEventListener(\"keydown\",listener);};},[]);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isProcessing=_useState4[0],setProcessing=_useState4[1];var cookies=new Cookies();//fields\nvar _useState5=useState({admin:false}),_useState6=_slicedToArray(_useState5,2),formData=_useState6[0],setFormData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),show=_useState8[0],SetShow=_useState8[1];function handleClose(){SetShow(false);}useEffect(function(){var at=cookies.get(\"access_token\");if(!at){window.location=\"/\";}});function getUser(id){console.log(\"inside get User\");var requestOptions={method:'GET',headers:{'Content-Type':'application/json','Authorization':cookies.get('access_token')}};fetch('/v1/user/'+id,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var _response$headers$get;var isJson,data,error,userData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isJson=(_response$headers$get=response.headers.get('content-type'))===null||_response$headers$get===void 0?void 0:_response$headers$get.includes('application/json');_context.t0=isJson;if(!_context.t0){_context.next=6;break;}_context.next=5;return response.json();case 5:_context.t0=_context.sent;case 6:data=_context.t0;if(response.ok){_context.next=10;break;}error=data&&data.errors;return _context.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});userData=data.result;console.log(\"Response:\");console.log(userData);formData={id:userData.id,name:userData.name,email:userData.email,mob:userData.mob,log:\"\"};if(userData.admin===true){formData.admin=true;}else{formData.admin=false;}console.log(\"From Server:\",formData);setFormData(_objectSpread({},formData));case 18:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function handleCreate(event){event.preventDefault();console.log(\"Inside handle Create\");var endPoint=\"/v1/user\";var method=\"POST\";if(formData.id){endPoint=\"/v1/user/\"+formData.id;method=\"PUT\";}var requestOptions={method:method,headers:{'Accept':'application/json',\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")},body:JSON.stringify(formData)};console.log(\"sending formData:\",formData);setProcessing(true);fetch(endPoint,requestOptions).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var _response$headers$get2;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isJson=(_response$headers$get2=response.headers.get(\"content-type\"))===null||_response$headers$get2===void 0?void 0:_response$headers$get2.includes(\"application/json\");_context2.t0=isJson;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return response.json();case 5:_context2.t0=_context2.sent;case 6:data=_context2.t0;if(response.ok){_context2.next=10;break;}// get error message from body or default to response status\nerror=data&&data.errors;//const error = data.errors\nreturn _context2.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});setProcessing(false);console.log(\"Response:\");console.log(data);props.showToastMessage(\"User Created Successfully!\",\"success\");if(props.refreshList){props.refreshList();}handleClose();props.openDetailsView(data.result.id);case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}()).catch(function(error){setProcessing(false);console.log(\"Inside catch\");console.log(error);setErrors(_objectSpread({},error));console.error(\"There was an error!\",error);props.showToastMessage(\"Error Creating User!\",\"danger\");});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Modal,{show:show,size:\"lg\",onHide:handleClose,animation:false,backdrop:\"static\",scrollable:true,children:[/*#__PURE__*/_jsxs(Modal.Header,{children:[/*#__PURE__*/_jsx(Modal.Title,{children:formData.id?\"Update User #\"+formData.name:\"Create New User\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"col align-self-end text-end\",children:[formData.id?/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:function onClick(){handleClose();props.openDetailsView(formData.id);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-eye\"}),\" View Detail\"]}):\"\",\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreate,children:[isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":\"\",formData.id?\"Update\":\"Create\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:handleClose,\"aria-label\":\"Close\"})]})]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 needs-validation\",onSubmit:handleCreate,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Name*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.name?formData.name:\"\",type:\"text\",onChange:function onChange(e){errors[\"name\"]=\"\";setErrors(_objectSpread({},errors));formData.name=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"name1\",placeholder:\"Name\"}),errors.name&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.name]}),formData.name&&!errors.name&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]}),/*#__PURE__*/_jsx(Form.Check,{type:\"switch\",as:\"input\",id:\"admin\",label:\"Admin\",value:formData.admin,checked:formData.admin===true?\"checked\":\"\",onChange:function onChange(e){formData.admin=!formData.admin;console.log(\"formData.admin:\",formData.admin);setFormData(_objectSpread({},formData));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Email*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.email?formData.email:\"\",type:\"text\",onChange:function onChange(e){errors[\"email\"]=\"\";formData.email=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"email1\",placeholder:\"Email\"}),errors.email&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.email]}),formData.email&&!errors.email&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Password*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.password?formData.password:\"\",type:\"password\",onChange:function onChange(e){errors[\"password\"]=\"\";formData.password=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"password1\",placeholder:\"Password\"}),errors.password&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.password]}),formData.password&&!errors.password&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Mob*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.mob?formData.mob:\"\",type:\"text\",onChange:function onChange(e){errors[\"mob\"]=\"\";setErrors(_objectSpread({},errors));formData.mob=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"mob1\",placeholder:\"Mob\"}),errors.mob&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.mob]}),formData.mob&&!errors.mob&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"buser\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":formData.id?\"Update\":\"Create\"})]})]})})]})});});export default UserCreate;","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/user/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","Modal","Button","Form","Cookies","Spinner","UserView","UserCreate","props","ref","open","id","formData","setFormData","getUser","SetShow","listener","event","code","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","preventDefault","document","addEventListener","removeEventListener","errors","setErrors","isProcessing","setProcessing","cookies","admin","show","handleClose","at","get","window","location","requestOptions","method","headers","fetch","then","response","isJson","json","data","ok","error","Promise","reject","userData","result","name","email","mob","catch","handleCreate","endPoint","Authorization","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","e","value","color","password"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport { Modal, Button, Form } from \"react-bootstrap\";\nimport Cookies from \"universal-cookie\";\nimport { Spinner } from \"react-bootstrap\";\nimport UserView from \"./view.js\";\n\n\nconst UserCreate = forwardRef((props, ref) => {\n\n    useImperativeHandle(ref, () => ({\n        open(id) {\n            formData = {};\n            setFormData({});\n            if (id) {\n                getUser(id);\n            }\n\n            SetShow(true);\n        },\n\n    }));\n\n    useEffect(() => {\n        const listener = event => {\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n                console.log(\"Enter key was pressed. Run your function.\");\n                // event.preventDefault();\n\n                var form = event.target.form;\n                if (form && event.target) {\n                    var index = Array.prototype.indexOf.call(form, event.target);\n                    if (form && form.elements[index + 1]) {\n                        if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n                            form.elements[index].focus();\n                        } else {\n                            form.elements[index + 1].focus();\n                        }\n                        event.preventDefault();\n                    }\n                }\n            }\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => {\n            document.removeEventListener(\"keydown\", listener);\n        };\n    }, []);\n\n\n    let [errors, setErrors] = useState({});\n    const [isProcessing, setProcessing] = useState(false);\n    const cookies = new Cookies();\n\n    //fields\n    let [formData, setFormData] = useState({\n        admin: false,\n    });\n\n    const [show, SetShow] = useState(false);\n\n    function handleClose() {\n        SetShow(false);\n    }\n\n    useEffect(() => {\n        let at = cookies.get(\"access_token\");\n        if (!at) {\n            window.location = \"/\";\n        }\n    });\n\n\n    function getUser(id) {\n        console.log(\"inside get User\");\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n\n        fetch('/v1/user/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n\n                let userData = data.result;\n                console.log(\"Response:\");\n                console.log(userData);\n\n\n                formData = {\n                    id: userData.id,\n                    name: userData.name,\n                    email: userData.email,\n                    mob: userData.mob,\n                    log: \"\",\n                };\n\n                if (userData.admin === true) {\n                    formData.admin = true;\n                } else {\n                    formData.admin = false;\n                }\n                console.log(\"From Server:\", formData);\n                setFormData({ ...formData });\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n    function handleCreate(event) {\n        event.preventDefault();\n        console.log(\"Inside handle Create\");\n\n\n        let endPoint = \"/v1/user\";\n        let method = \"POST\";\n        if (formData.id) {\n            endPoint = \"/v1/user/\" + formData.id;\n            method = \"PUT\";\n        }\n\n\n        const requestOptions = {\n            method: method,\n            headers: {\n                'Accept': 'application/json',\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n            body: JSON.stringify(formData),\n        };\n\n        console.log(\"sending formData:\", formData);\n\n        setProcessing(true);\n        fetch(endPoint, requestOptions)\n            .then(async (response) => {\n                const isJson = response.headers\n                    .get(\"content-type\")\n                    ?.includes(\"application/json\");\n                const data = isJson && (await response.json());\n\n                // check for error response\n                if (!response.ok) {\n                    // get error message from body or default to response status\n                    const error = data && data.errors;\n                    //const error = data.errors\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n                setProcessing(false);\n\n                console.log(\"Response:\");\n                console.log(data);\n                props.showToastMessage(\"User Created Successfully!\", \"success\");\n                if (props.refreshList) {\n                    props.refreshList();\n                }\n                handleClose();\n                \n\n                props.openDetailsView(data.result.id);\n            })\n            .catch((error) => {\n                setProcessing(false);\n                console.log(\"Inside catch\");\n                console.log(error);\n                setErrors({ ...error });\n                console.error(\"There was an error!\", error);\n                props.showToastMessage(\"Error Creating User!\", \"danger\");\n            });\n    }\n\n\n    return (\n        <>\n            <Modal show={show} size=\"lg\" onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n                <Modal.Header>\n                    <Modal.Title>\n                        {formData.id ? \"Update User #\" + formData.name : \"Create New User\"}\n                    </Modal.Title>\n\n                    <div className=\"col align-self-end text-end\">\n                        {formData.id ? <Button variant=\"primary\" onClick={() => {\n                            handleClose();\n                            props.openDetailsView(formData.id);\n                        }}>\n                            <i className=\"bi bi-eye\"></i> View Detail\n                        </Button> : \"\"}\n                        &nbsp;&nbsp;\n                        <Button variant=\"primary\" onClick={handleCreate} >\n                            {isProcessing ?\n                                <Spinner\n                                    as=\"span\"\n                                    animation=\"border\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden={true}\n                                /> + \" Creating...\"\n\n                                : \"\"\n                            }\n                            {formData.id ? \"Update\" : \"Create\"}\n\n                        </Button>\n                        <button\n                            type=\"button\"\n                            className=\"btn-close\"\n                            onClick={handleClose}\n                            aria-label=\"Close\"\n                        ></button>\n                    </div>\n                </Modal.Header>\n                <Modal.Body>\n                    <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Name*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.name ? formData.name : \"\"}\n                                    type='text'\n                                    onChange={(e) => {\n                                        errors[\"name\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.name = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"name1\"\n                                    placeholder=\"Name\"\n                                />\n                                {errors.name && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.name}\n                                    </div>\n                                )}\n                                {formData.name && !errors.name && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n\n\n                            <Form.Check\n                                type=\"switch\"\n                                as=\"input\"\n                                id=\"admin\"\n                                label=\"Admin\"\n                                value={formData.admin}\n                                checked={formData.admin === true ? \"checked\" : \"\"}\n                                onChange={(e) => {\n                                    formData.admin = !formData.admin;\n                                    console.log(\"formData.admin:\", formData.admin);\n                                    setFormData({ ...formData });\n                                }}\n                            />\n\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Email*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.email ? formData.email : \"\"}\n                                    type='text'\n                                    onChange={(e) => {\n                                        errors[\"email\"] = \"\";\n\n                                        formData.email = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"email1\"\n                                    placeholder=\"Email\"\n                                />\n\n                                {errors.email && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.email}\n                                    </div>\n                                )}\n                                {formData.email && !errors.email && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Password*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.password ? formData.password : \"\"}\n                                    type='password'\n                                    onChange={(e) => {\n                                        errors[\"password\"] = \"\";\n\n                                        formData.password = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"password1\"\n                                    placeholder=\"Password\"\n                                />\n\n                                {errors.password && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.password}\n                                    </div>\n                                )}\n                                {formData.password && !errors.password && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Mob*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.mob ? formData.mob : \"\"}\n                                    type='text'\n                                    onChange={(e) => {\n                                        errors[\"mob\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.mob = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"mob1\"\n                                    placeholder=\"Mob\"\n                                />\n                                {errors.mob && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.mob}\n                                    </div>\n                                )}\n                                {formData.mob && !errors.mob && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <Modal.Footer>\n                            <Button variant=\"secondary\" onClick={handleClose}>\n                                Close\n                            </Button>\n                            <Button variant=\"primary\" type=\"submit\" >\n                                {isProcessing ?\n                                    <Spinner\n                                        as=\"span\"\n                                        animation=\"buser\"\n                                        size=\"sm\"\n                                        role=\"status\"\n                                        aria-hidden={true}\n                                    /> + \" Creating...\"\n\n                                    : formData.id ? \"Update\" : \"Create\"\n                                }\n                            </Button>\n                        </Modal.Footer>\n                    </form>\n                </Modal.Body>\n\n            </Modal>\n\n\n        </>\n    );\n});\n\nexport default UserCreate;\n"]},"metadata":{},"sourceType":"module"}