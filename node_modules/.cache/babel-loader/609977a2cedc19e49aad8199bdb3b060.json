{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useState,useEffect,useRef,forwardRef,useImperativeHandle}from\"react\";import{Modal,Button}from\"react-bootstrap\";import Cookies from\"universal-cookie\";import{Spinner}from\"react-bootstrap\";import SalesReturnPaymentView from\"./view.js\";import{Typeahead}from\"react-bootstrap-typeahead\";import DatePicker from\"react-datepicker\";import{format}from\"date-fns\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SalesReturnPaymentCreate=/*#__PURE__*/forwardRef(function(props,ref){useImperativeHandle(ref,function(){return{open:function open(id,salesreturn){salesreturn=salesreturn;setSalesReturn(_objectSpread({},salesreturn));formData={method:\"\"};formData.date_str=new Date();if(salesreturn){formData.sales_return_id=salesreturn.id;formData.sales_return_code=salesreturn.code;formData.order_id=salesreturn.order_id;formData.order_code=salesreturn.order_code;formData.store_id=salesreturn.store_id;}setFormData(formData);selectedParentCategories=[];setSelectedParentCategories(selectedParentCategories);if(id){getSalesReturnPayment(id);}errors={};setErrors(_objectSpread({},errors));SetShow(true);}};});var _useState=useState({}),_useState2=_slicedToArray(_useState,2),salesreturn=_useState2[0],setSalesReturn=_useState2[1];useEffect(function(){var listener=function listener(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){console.log(\"Enter key was pressed. Run your function-product category.\");// event.preventDefault();\nvar form=event.target.form;if(form&&event.target){var index=Array.prototype.indexOf.call(form,event.target);if(form&&form.elements[index+1]){if(event.target.getAttribute(\"class\").includes(\"barcode\")){form.elements[index].focus();}else{form.elements[index+1].focus();}event.preventDefault();}}}};document.addEventListener(\"keydown\",listener);return function(){document.removeEventListener(\"keydown\",listener);};},[]);var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isProcessing=_useState6[0],setProcessing=_useState6[1];var cookies=new Cookies();var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),parentCategoryOptions=_useState8[0],setParentCategoryOptions=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),selectedParentCategories=_useState10[0],setSelectedParentCategories=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isProductCategoriesLoading=_useState12[0],setIsProductCategoriesLoading=_useState12[1];//fields\nvar _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),formData=_useState14[0],setFormData=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),show=_useState16[0],SetShow=_useState16[1];function handleClose(){SetShow(false);}useEffect(function(){var at=cookies.get(\"access_token\");if(!at){window.location=\"/\";}});function getSalesReturnPayment(id){console.log(\"inside get Product Category\");var requestOptions={method:'GET',headers:{'Content-Type':'application/json','Authorization':cookies.get('access_token')}};formData={};setFormData(_objectSpread({},formData));selectedParentCategories=[];setSelectedParentCategories(_toConsumableArray(selectedParentCategories));fetch('/v1/sales-return-payment/'+id,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var _response$headers$get;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isJson=(_response$headers$get=response.headers.get('content-type'))===null||_response$headers$get===void 0?void 0:_response$headers$get.includes('application/json');_context.t0=isJson;if(!_context.t0){_context.next=6;break;}_context.next=5;return response.json();case 5:_context.t0=_context.sent;case 6:data=_context.t0;if(response.ok){_context.next=10;break;}error=data&&data.errors;return _context.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});console.log(\"Response:\");console.log(data);formData=data.result;formData.date_str=data.result.date;console.log(\"formData:\",formData);/*\n                formData.sales_return_id = salesreturn.id;\n                formData.sales_return_code = salesreturn.code;\n\n                formData.order_id = salesreturn.order_id;\n                formData.order_code = salesreturn.order_code;\n\n                formData.store_id = salesreturn.store_id;\n                 */setFormData(_objectSpread({},formData));console.log(\"formData:\",formData);case 18:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function ObjectToSearchQueryParams(object){return Object.keys(object).map(function(key){return\"search[\".concat(key,\"]=\").concat(object[key]);}).join(\"&\");}function handleCreate(event){event.preventDefault();console.log(\"Inside handle Create\");console.log(\"formData.logo:\",formData.logo);setIsProductCategoriesLoading(true);var endPoint=\"/v1/sales-return-payment\";var method=\"POST\";if(formData.id){endPoint=\"/v1/sales-return-payment/\"+formData.id;method=\"PUT\";}if(formData.amount<=0){errors[\"amount\"]=\"Amount should be > 0:\";setErrors(_objectSpread({},errors));return;}if(formData.amount>salesreturn.net_total){errors[\"amount\"]=\"Amount should be less than or equal to net total amount:\"+salesreturn.net_total;setErrors(_objectSpread({},errors));return;}console.log(\"salesreturn.order_id:\",salesreturn.order_id);formData.order_id=salesreturn.order_id;formData.order_code=salesreturn.order_code;var requestOptions={method:method,headers:{'Accept':'application/json',\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")},body:JSON.stringify(formData)};console.log(\"formData:\",formData);setProcessing(true);fetch(endPoint,requestOptions).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var _response$headers$get2;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isJson=(_response$headers$get2=response.headers.get(\"content-type\"))===null||_response$headers$get2===void 0?void 0:_response$headers$get2.includes(\"application/json\");_context2.t0=isJson;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return response.json();case 5:_context2.t0=_context2.sent;case 6:data=_context2.t0;if(response.ok){_context2.next=10;break;}// get error message from body or default to response status\nerror=data&&data.errors;//const error = data.errors\nreturn _context2.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});setProcessing(false);setIsProductCategoriesLoading(false);console.log(\"Response:\");console.log(data);props.showToastMessage(\"Product Category Created Successfully!\",\"success\");if(props.refreshList){props.refreshList();}handleClose();if(props.refreshSalesReturnList){props.refreshSalesReturnList();}props.openDetailsView(data.result.id);case 20:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setIsProductCategoriesLoading(false);console.log(\"Inside catch\");console.log(error);setErrors(_objectSpread({},error));console.error(\"There was an error!\",error);props.showToastMessage(\"Error Creating SalesReturnPayment!\",\"danger\");});}function suggestCategories(_x3){return _suggestCategories.apply(this,arguments);}function _suggestCategories(){_suggestCategories=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Inside handle suggest Categories\");setParentCategoryOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context3.next=5;break;}return _context3.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{Authorization:cookies.get(\"access_token\"),\"Content-Type\":\"application/json\"}};Select=\"select=id,name\";setIsProductCategoriesLoading(true);_context3.next=13;return fetch(\"/v1/sales-return-payment?\"+Select+queryString,requestOptions);case 13:result=_context3.sent;_context3.next=16;return result.json();case 16:data=_context3.sent;setParentCategoryOptions(data.result);setIsProductCategoriesLoading(false);case 19:case\"end\":return _context3.stop();}}},_callee3);}));return _suggestCategories.apply(this,arguments);}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Modal,{show:show,size:\"lg\",onHide:handleClose,animation:false,backdrop:\"static\",scrollable:true,children:[/*#__PURE__*/_jsxs(Modal.Header,{children:[/*#__PURE__*/_jsx(Modal.Title,{children:formData.id?\"Update Payment of sales return #\"+formData.sales_return_code:\"Add Payment of sales return  #\"+formData.sales_return_code}),/*#__PURE__*/_jsxs(\"div\",{className:\"col align-self-end text-end\",children:[formData.id?/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:function onClick(){handleClose();props.openDetailsView(formData.id);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-eye\"}),\" View Detail\"]}):\"\",\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreate,children:[isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"bsalesreturn\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":\"\",formData.id?\"Update\":\"Create\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:handleClose,\"aria-label\":\"Close\"})]})]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 needs-validation\",onSubmit:handleCreate,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Amount*\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group mb-3\",children:/*#__PURE__*/_jsx(\"input\",{value:formData.amount?formData.amount:\"\",type:\"number\",onChange:function onChange(e){console.log(\"Inside onchange vat \");if(!e.target.value){formData.amount=e.target.value;errors[\"amount\"]=\"Invalid amount\";setErrors(_objectSpread({},errors));return;}if(parseFloat(e.target.value)<=0){formData.amount=e.target.value;errors[\"amount\"]=\"Amount should be > 0\";setErrors(_objectSpread({},errors));return;}formData.amount=parseFloat(e.target.value);errors[\"amount\"]=\"\";if(formData.amount>salesreturn.net_total){errors[\"amount\"]=\"Amount should be less than or equal to net total amount:\"+salesreturn.net_total;setErrors(_objectSpread({},errors));return;}setErrors(_objectSpread({},errors));setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"name\",placeholder:\"Amount\"})}),errors.amount&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\"},children:errors.amount}),formData.amount&&!errors.amount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Date*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(DatePicker,{id:\"date_str\",selected:formData.date_str?new Date(formData.date_str):null,value:formData.date_str?format(new Date(formData.date_str),\"MMMM d, yyyy h:mm aa\"):null,className:\"form-control\",dateFormat:\"MMMM d, yyyy h:mm aa\",showTimeSelect:true,timeIntervals:\"1\",onChange:function onChange(value){console.log(\"Value\",value);formData.date_str=value;// formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\nsetFormData(_objectSpread({},formData));}}),errors.date_str&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.date_str]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Payment method*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:formData.method,onChange:function onChange(e){console.log(\"Inside onchange payment method\");if(!e.target.value){errors[\"method\"]=\"Invalid Payment Method\";formData.method=\"\";setFormData(_objectSpread({},formData));setErrors(_objectSpread({},errors));return;}errors[\"method\"]=\"\";setErrors(_objectSpread({},errors));formData.method=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_account\",children:\"Bank Account / Debit / Credit Card\"})]}),errors.method&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\"},children:errors.method}),formData.method&&!errors.method&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"row  g-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-3\"})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleCreate,children:isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"bsalesreturnpayment\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Processing...\":formData.id?\"Update\":\"Create\"})]})]})})]})});});export default SalesReturnPaymentCreate;","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/sales_return_payment/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","Modal","Button","Cookies","Spinner","SalesReturnPaymentView","Typeahead","DatePicker","format","SalesReturnPaymentCreate","props","ref","open","id","salesreturn","setSalesReturn","formData","method","date_str","Date","sales_return_id","sales_return_code","code","order_id","order_code","store_id","setFormData","selectedParentCategories","setSelectedParentCategories","getSalesReturnPayment","errors","setErrors","SetShow","listener","event","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","preventDefault","document","addEventListener","removeEventListener","isProcessing","setProcessing","cookies","parentCategoryOptions","setParentCategoryOptions","isProductCategoriesLoading","setIsProductCategoriesLoading","show","handleClose","at","get","window","location","requestOptions","headers","fetch","then","response","isJson","json","data","ok","error","Promise","reject","result","date","catch","ObjectToSearchQueryParams","object","Object","keys","map","key","join","handleCreate","logo","endPoint","amount","net_total","Authorization","body","JSON","stringify","showToastMessage","refreshList","refreshSalesReturnList","openDetailsView","suggestCategories","searchTerm","params","name","queryString","Select","e","value","parseFloat","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport Cookies from \"universal-cookie\";\nimport { Spinner } from \"react-bootstrap\";\nimport SalesReturnPaymentView from \"./view.js\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\n\n\nconst SalesReturnPaymentCreate = forwardRef((props, ref) => {\n\n    useImperativeHandle(ref, () => ({\n        open(id, salesreturn) {\n            salesreturn = salesreturn;\n            setSalesReturn({ ...salesreturn });\n            formData = {\n                method: \"\",\n            };\n\n            formData.date_str = new Date();\n\n            if (salesreturn) {\n                formData.sales_return_id = salesreturn.id;\n                formData.sales_return_code = salesreturn.code;\n\n                formData.order_id = salesreturn.order_id;\n                formData.order_code = salesreturn.order_code;\n\n                formData.store_id = salesreturn.store_id;\n\n            }\n            setFormData(formData);\n            selectedParentCategories = [];\n            setSelectedParentCategories(selectedParentCategories);\n\n            if (id) {\n                getSalesReturnPayment(id);\n            }\n            errors = {};\n            setErrors({ ...errors });\n            SetShow(true);\n        },\n\n    }));\n\n    let [salesreturn, setSalesReturn] = useState({});\n\n    useEffect(() => {\n        const listener = event => {\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n                console.log(\"Enter key was pressed. Run your function-product category.\");\n                // event.preventDefault();\n\n                var form = event.target.form;\n                if (form && event.target) {\n                    var index = Array.prototype.indexOf.call(form, event.target);\n                    if (form && form.elements[index + 1]) {\n                        if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n                            form.elements[index].focus();\n                        } else {\n                            form.elements[index + 1].focus();\n                        }\n                        event.preventDefault();\n                    }\n                }\n            }\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => {\n            document.removeEventListener(\"keydown\", listener);\n        };\n    }, []);\n\n    let [errors, setErrors] = useState({});\n    const [isProcessing, setProcessing] = useState(false);\n    const cookies = new Cookies();\n\n    const [parentCategoryOptions, setParentCategoryOptions] = useState([]);\n    let [selectedParentCategories, setSelectedParentCategories] = useState([]);\n    const [isProductCategoriesLoading, setIsProductCategoriesLoading] = useState(false);\n\n    //fields\n    let [formData, setFormData] = useState({});\n\n    const [show, SetShow] = useState(false);\n\n    function handleClose() {\n        SetShow(false);\n    }\n\n    useEffect(() => {\n        let at = cookies.get(\"access_token\");\n        if (!at) {\n            window.location = \"/\";\n        }\n    });\n\n\n    function getSalesReturnPayment(id) {\n        console.log(\"inside get Product Category\");\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n        formData = {};\n        setFormData({ ...formData });\n        selectedParentCategories = [];\n        setSelectedParentCategories([...selectedParentCategories]);\n        fetch('/v1/sales-return-payment/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n                console.log(\"Response:\");\n                console.log(data);\n\n                formData = data.result;\n                formData.date_str = data.result.date;\n                console.log(\"formData:\", formData);\n\n                /*\n                formData.sales_return_id = salesreturn.id;\n                formData.sales_return_code = salesreturn.code;\n\n                formData.order_id = salesreturn.order_id;\n                formData.order_code = salesreturn.order_code;\n\n                formData.store_id = salesreturn.store_id;\n                 */\n\n                setFormData({ ...formData });\n                console.log(\"formData:\", formData);\n\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n    function ObjectToSearchQueryParams(object) {\n        return Object.keys(object)\n            .map(function (key) {\n                return `search[${key}]=${object[key]}`;\n            })\n            .join(\"&\");\n    }\n\n    function handleCreate(event) {\n        event.preventDefault();\n        console.log(\"Inside handle Create\");\n\n\n        console.log(\"formData.logo:\", formData.logo);\n\n        setIsProductCategoriesLoading(true);\n\n        let endPoint = \"/v1/sales-return-payment\";\n        let method = \"POST\";\n        if (formData.id) {\n            endPoint = \"/v1/sales-return-payment/\" + formData.id;\n            method = \"PUT\";\n        }\n\n        if (formData.amount <= 0) {\n            errors[\"amount\"] = \"Amount should be > 0:\";\n            setErrors({ ...errors });\n            return;\n        }\n\n\n        if (formData.amount > salesreturn.net_total) {\n            errors[\"amount\"] = \"Amount should be less than or equal to net total amount:\" + salesreturn.net_total;\n            setErrors({ ...errors });\n            return;\n        }\n\n        console.log(\"salesreturn.order_id:\", salesreturn.order_id);\n\n        formData.order_id = salesreturn.order_id;\n        formData.order_code = salesreturn.order_code;\n\n        const requestOptions = {\n            method: method,\n            headers: {\n                'Accept': 'application/json',\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n            body: JSON.stringify(formData),\n        };\n\n        console.log(\"formData:\", formData);\n\n        setProcessing(true);\n        fetch(endPoint, requestOptions)\n            .then(async (response) => {\n                const isJson = response.headers\n                    .get(\"content-type\")\n                    ?.includes(\"application/json\");\n                const data = isJson && (await response.json());\n\n                // check for error response\n                if (!response.ok) {\n                    // get error message from body or default to response status\n                    const error = data && data.errors;\n                    //const error = data.errors\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n                setProcessing(false);\n                setIsProductCategoriesLoading(false);\n\n                console.log(\"Response:\");\n                console.log(data);\n                props.showToastMessage(\"Product Category Created Successfully!\", \"success\");\n                if (props.refreshList) {\n                    props.refreshList();\n                }\n                handleClose();\n                if (props.refreshSalesReturnList) {\n                    props.refreshSalesReturnList();\n                }\n                props.openDetailsView(data.result.id);\n            })\n            .catch((error) => {\n                setProcessing(false);\n                setIsProductCategoriesLoading(false);\n                console.log(\"Inside catch\");\n                console.log(error);\n                setErrors({ ...error });\n                console.error(\"There was an error!\", error);\n                props.showToastMessage(\"Error Creating SalesReturnPayment!\", \"danger\");\n            });\n    }\n\n    async function suggestCategories(searchTerm) {\n        console.log(\"Inside handle suggest Categories\");\n        setParentCategoryOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                Authorization: cookies.get(\"access_token\"),\n                \"Content-Type\": \"application/json\",\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsProductCategoriesLoading(true);\n        let result = await fetch(\n            \"/v1/sales-return-payment?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setParentCategoryOptions(data.result);\n        setIsProductCategoriesLoading(false);\n    }\n\n\n\n    return (\n        <>\n            <Modal show={show} size=\"lg\" onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n                <Modal.Header>\n                    <Modal.Title>\n                        {formData.id ? \"Update Payment of sales return #\" + formData.sales_return_code : \"Add Payment of sales return  #\" + formData.sales_return_code}\n                    </Modal.Title>\n\n                    <div className=\"col align-self-end text-end\">\n                        {formData.id ? <Button variant=\"primary\" onClick={() => {\n                            handleClose();\n                            props.openDetailsView(formData.id);\n                        }}>\n                            <i className=\"bi bi-eye\"></i> View Detail\n                        </Button> : \"\"}\n                        &nbsp;&nbsp;\n                        <Button variant=\"primary\" onClick={handleCreate} >\n                            {isProcessing ?\n                                <Spinner\n                                    as=\"span\"\n                                    animation=\"bsalesreturn\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden={true}\n                                /> + \" Creating...\"\n\n                                : \"\"\n                            }\n                            {formData.id ? \"Update\" : \"Create\"}\n\n                        </Button>\n                        <button\n                            type=\"button\"\n                            className=\"btn-close\"\n                            onClick={handleClose}\n                            aria-label=\"Close\"\n                        ></button>\n                    </div>\n                </Modal.Header>\n                <Modal.Body>\n                    <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n\n                        <div className=\"col-md-3\">\n                            <label className=\"form-label\">Amount*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.amount ? formData.amount : \"\"}\n                                    type='number'\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange vat \");\n                                        if (!e.target.value) {\n                                            formData.amount = e.target.value;\n                                            errors[\"amount\"] = \"Invalid amount\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        if (parseFloat(e.target.value) <= 0) {\n                                            formData.amount = e.target.value;\n                                            errors[\"amount\"] = \"Amount should be > 0\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n\n                                        formData.amount = parseFloat(e.target.value);\n                                        errors[\"amount\"] = \"\";\n\n                                        if (formData.amount > salesreturn.net_total) {\n                                            errors[\"amount\"] = \"Amount should be less than or equal to net total amount:\" + salesreturn.net_total;\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n                                        setErrors({ ...errors });\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"name\"\n                                    placeholder=\"Amount\"\n                                />\n                            </div>\n                            {errors.amount && (\n                                <div style={{ color: \"red\" }}>\n                                    {errors.amount}\n                                </div>\n                            )}\n                            {formData.amount && !errors.amount && (\n                                <div style={{ color: \"green\" }}>\n                                    <i className=\"bi bi-check-lg\"> </i>\n                                    Looks good!\n                                </div>\n                            )}\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Date*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    selected={formData.date_str ? new Date(formData.date_str) : null}\n                                    value={formData.date_str ? format(\n                                        new Date(formData.date_str),\n                                        \"MMMM d, yyyy h:mm aa\"\n                                    ) : null}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                    showTimeSelect\n                                    timeIntervals=\"1\"\n                                    onChange={(value) => {\n                                        console.log(\"Value\", value);\n                                        formData.date_str = value;\n                                        // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                            </div>\n\n                        </div>\n\n\n                        <div className=\"row\">\n                            <div className=\"col-md-3\">\n                                <label className=\"form-label\">Payment method*</label>\n\n                                <div className=\"input-group mb-3\" >\n                                    <select\n                                        value={formData.method}\n                                        onChange={(e) => {\n                                            console.log(\"Inside onchange payment method\");\n                                            if (!e.target.value) {\n                                                errors[\"method\"] = \"Invalid Payment Method\";\n                                                formData.method=\"\";\n                                                setFormData({ ...formData });\n                                                setErrors({ ...errors });\n                                                return;\n                                            }\n\n                                            errors[\"method\"] = \"\";\n                                            setErrors({ ...errors });\n\n                                            formData.method = e.target.value;\n                                            setFormData({ ...formData });\n                                            console.log(formData);\n                                        }}\n                                        className=\"form-control\"\n                                    >\n                                        <option value=\"\">Select</option>\n                                        <option value=\"cash\">Cash</option>\n                                        <option value=\"bank_account\">Bank Account / Debit / Credit Card</option>\n                                    </select>\n                                    {errors.method && (\n                                        <div style={{ color: \"red\" }}>\n                                            {errors.method}\n                                        </div>\n                                    )}\n                                    {formData.method && !errors.method && (\n                                        <div style={{ color: \"green\" }}>\n                                            <i className=\"bi bi-check-lg\"> </i>\n                                            Looks good!\n                                        </div>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n\n                        <div className=\"row  g-5\">\n                            <div className=\"col-md-3\">\n                            </div>\n                        </div>\n\n                        <Modal.Footer>\n                            <Button variant=\"secondary\" onClick={handleClose}>\n                                Close\n                            </Button>\n                            <Button variant=\"primary\" onClick={handleCreate} >\n                                {isProcessing ?\n                                    <Spinner\n                                        as=\"span\"\n                                        animation=\"bsalesreturnpayment\"\n                                        size=\"sm\"\n                                        role=\"status\"\n                                        aria-hidden={true}\n                                    /> + \" Processing...\"\n\n                                    : formData.id ? \"Update\" : \"Create\"\n                                }\n                            </Button>\n                        </Modal.Footer>\n                    </form>\n                </Modal.Body>\n\n            </Modal>\n\n\n        </>\n    );\n});\n\nexport default SalesReturnPaymentCreate;\n"]},"metadata":{},"sourceType":"module"}