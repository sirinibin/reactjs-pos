{"ast":null,"code":"import _toConsumableArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef,forwardRef,useImperativeHandle}from\"react\";import{Modal,Button}from\"react-bootstrap\";import Cookies from\"universal-cookie\";import{Spinner}from\"react-bootstrap\";import ExpenseView from\"./view.js\";import{Typeahead}from\"react-bootstrap-typeahead\";import StoreCreate from\"../store/create.js\";import ExpenseCategoryCreate from\"../expense_category/create.js\";import ExpenseCategoryView from\"../expense_category/view.js\";import Resizer from\"react-image-file-resizer\";import DatePicker from\"react-datepicker\";import{format}from\"date-fns\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ExpenseCreate=/*#__PURE__*/forwardRef(function(props,ref){//Store Auto Suggestion\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),selectedStores=_useState2[0],setSelectedStores=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isStoresLoading=_useState4[0],setIsStoresLoading=_useState4[1];useImperativeHandle(ref,function(){return{open:function open(id){selectedCategories=[];setSelectedCategories(selectedCategories);formData={images_content:[]};setFormData({formData:formData});if(id){getExpense(id);}SetShow(true);}};});useEffect(function(){var listener=function listener(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){console.log(\"Enter key was pressed. Run your function-expense.\");// event.preventDefault();\nvar form=event.target.form;if(form&&event.target){var index=Array.prototype.indexOf.call(form,event.target);if(form&&form.elements[index+1]){if(event.target.getAttribute(\"class\").includes(\"description\")){form.elements[index].focus();form.elements[index].value+='\\r\\n';}else{form.elements[index+1].focus();}event.preventDefault();}}}};document.addEventListener(\"keydown\",listener);return function(){document.removeEventListener(\"keydown\",listener);};},[]);function resizeFIle(file,w,h,cb){Resizer.imageFileResizer(file,w,h,\"JPEG\",100,0,function(uri){cb(uri);},\"base64\");}var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),selectedImage=_useState6[0],setSelectedImage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),storeOptions=_useState8[0],setStoreOptions=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),selectedCategories=_useState10[0],setSelectedCategories=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),categoryOptions=_useState12[0],setCategoryOptions=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),errors=_useState14[0],setErrors=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isProcessing=_useState16[0],setProcessing=_useState16[1];var cookies=new Cookies();//fields\nvar _useState17=useState({images_content:[]}),_useState18=_slicedToArray(_useState17,2),formData=_useState18[0],setFormData=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),show=_useState20[0],SetShow=_useState20[1];function handleClose(){SetShow(false);}function getExpense(id){console.log(\"inside get Expense\");var requestOptions={method:'GET',headers:{'Content-Type':'application/json','Authorization':cookies.get('access_token')}};fetch('/v1/expense/'+id,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var _response$headers$get;var isJson,data,error,categoryIds,categoryNames,i,selectedStores;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isJson=(_response$headers$get=response.headers.get('content-type'))===null||_response$headers$get===void 0?void 0:_response$headers$get.includes('application/json');_context.t0=isJson;if(!_context.t0){_context.next=6;break;}_context.next=5;return response.json();case 5:_context.t0=_context.sent;case 6:data=_context.t0;if(response.ok){_context.next=10;break;}error=data&&data.errors;return _context.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});console.log(\"Response:\");console.log(data);categoryIds=data.result.category_id;categoryNames=data.result.category_name;selectedCategories=[];if(categoryIds&&categoryNames){for(i=0;i<categoryIds.length;i++){selectedCategories.push({id:categoryIds[i],name:categoryNames[i]});}}setSelectedCategories(selectedCategories);formData=data.result;selectedStores=[{id:formData.store_id,name:formData.store_name}];setSelectedStores([].concat(selectedStores));formData.images_content=[];setFormData(_objectSpread({},formData));case 23:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function suggestCategories(_x2){return _suggestCategories.apply(this,arguments);}function _suggestCategories(){_suggestCategories=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Inside handle suggest Categories\");console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context3.next=4;break;}return _context3.abrupt(\"return\");case 4:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";_context3.next=11;return fetch(\"/v1/expense-category?\"+Select+queryString,requestOptions);case 11:result=_context3.sent;_context3.next=14;return result.json();case 14:data=_context3.sent;setCategoryOptions(data.result);case 16:case\"end\":return _context3.stop();}}},_callee3);}));return _suggestCategories.apply(this,arguments);}function suggestStores(_x3){return _suggestStores.apply(this,arguments);}function _suggestStores(){_suggestStores=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"Inside handle suggest Stores\");console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context4.next=4;break;}return _context4.abrupt(\"return\");case 4:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";_context4.next=11;return fetch(\"/v1/store?\"+Select+queryString,requestOptions);case 11:result=_context4.sent;_context4.next=14;return result.json();case 14:data=_context4.sent;setStoreOptions(data.result);case 16:case\"end\":return _context4.stop();}}},_callee4);}));return _suggestStores.apply(this,arguments);}useEffect(function(){var at=cookies.get(\"access_token\");if(!at){window.location=\"/\";}});function ObjectToSearchQueryParams(object){return Object.keys(object).map(function(key){return\"search[\".concat(key,\"]=\").concat(object[key]);}).join(\"&\");}function handleCreate(event){event.preventDefault();console.log(\"Inside handle Create\");formData.category_id=[];for(var i=0;i<selectedCategories.length;i++){formData.category_id.push(selectedCategories[i].id);}console.log(\"category_id:\",formData.category_id);if(cookies.get(\"store_id\")){formData.store_id=cookies.get(\"store_id\");}var endPoint=\"/v1/expense\";var method=\"POST\";if(formData.id){endPoint=\"/v1/expense/\"+formData.id;method=\"PUT\";}var requestOptions={method:method,headers:{'Accept':'application/json',\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")},body:JSON.stringify(formData)};console.log(\"formData:\",formData);setProcessing(true);fetch(endPoint,requestOptions).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var _response$headers$get2;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isJson=(_response$headers$get2=response.headers.get(\"content-type\"))===null||_response$headers$get2===void 0?void 0:_response$headers$get2.includes(\"application/json\");_context2.t0=isJson;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return response.json();case 5:_context2.t0=_context2.sent;case 6:data=_context2.t0;if(response.ok){_context2.next=10;break;}// get error message from body or default to response status\nerror=data&&data.errors;//const error = data.errors\nreturn _context2.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});setProcessing(false);console.log(\"Response:\");console.log(data);props.showToastMessage(\"Expense Created Successfully!\",\"success\");if(props.refreshList){props.refreshList();}handleClose();props.openDetailsView(data.result.id);case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x4){return _ref2.apply(this,arguments);};}()).catch(function(error){setProcessing(false);console.log(\"Inside catch\");console.log(error);setErrors(_objectSpread({},error));console.error(\"There was an error!\",error);props.showToastMessage(\"Error Creating Expense!\",\"danger\");});}function getTargetDimension(originaleWidth,originalHeight,targetWidth,targetHeight){var ratio=parseFloat(originaleWidth/originalHeight);targetWidth=parseInt(targetHeight*ratio);targetHeight=parseInt(targetWidth*ratio);return{targetWidth:targetWidth,targetHeight:targetHeight};}/*\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        console.log(\"id:\", id);\n        DetailsViewRef.current.open(id);\n    }\n    */var StoreCreateFormRef=useRef();function openStoreCreateForm(){StoreCreateFormRef.current.open();}var ExpenseCategoryCreateFormRef=useRef();function openExpenseCategoryCreateForm(){ExpenseCategoryCreateFormRef.current.open();}var ExpenseCategoryDetailsViewRef=useRef();function openExpenseCategoryDetailsView(id){ExpenseCategoryDetailsViewRef.current.open(id);}function openExpenseCategoryUpdateForm(id){ExpenseCategoryCreateFormRef.current.open(id);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(StoreCreate,{ref:StoreCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(ExpenseCategoryCreate,{ref:ExpenseCategoryCreateFormRef,openDetailsView:openExpenseCategoryDetailsView,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(ExpenseCategoryView,{ref:ExpenseCategoryDetailsViewRef,openUpdateForm:openExpenseCategoryUpdateForm,openCreateForm:openExpenseCategoryCreateForm}),/*#__PURE__*/_jsxs(Modal,{show:show,size:\"xl\",onHide:handleClose,animation:false,backdrop:\"static\",scrollable:true,children:[/*#__PURE__*/_jsxs(Modal.Header,{children:[/*#__PURE__*/_jsx(Modal.Title,{children:formData.id?\"Update Expense #\"+formData.description:\"Create New Expense\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"col align-self-end text-end\",children:[formData.id?/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:function onClick(){handleClose();props.openDetailsView(formData.id);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-eye\"}),\" View Detail\"]}):\"\",\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreate,children:[isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":\"\",formData.id?\"Update\":\"Create\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:handleClose,\"aria-label\":\"Close\"})]})]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 needs-validation\",onSubmit:handleCreate,children:[!cookies.get('store_name')?/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Store*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(Typeahead,{id:\"store_id\",labelKey:\"name\",isLoading:isStoresLoading,isInvalid:errors.store_id?true:false,onChange:function onChange(selectedItems){errors.store_id=\"\";errors[\"product_id\"]=\"\";setErrors(errors);if(selectedItems.length===0){errors.store_id=\"Invalid Store selected\";setErrors(errors);setFormData(_objectSpread({},formData));setSelectedStores([]);return;}formData.store_id=selectedItems[0].id;setFormData(_objectSpread({},formData));console.log(\"formData.store_id:\",formData.store_id);selectedStores=selectedItems;setSelectedStores(_toConsumableArray(selectedItems));},options:storeOptions,placeholder:\"Select Store\",selected:selectedStores,highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestStores(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:openStoreCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi x-lg\",children:\" \"}),errors.store_id]})]})]}):\"\",/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Amount*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.amount?formData.amount:\"\",type:\"number\",onChange:function onChange(e){errors[\"amount\"]=\"\";setErrors(_objectSpread({},errors));formData.amount=parseFloat(e.target.value);setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"amount\",placeholder:\"Amount\"}),errors.amount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.amount]}),formData.amount&&!errors.amount&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Description*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:formData.description?formData.description:\"\",type:\"string\",onChange:function onChange(e){errors[\"description\"]=\"\";setErrors(_objectSpread({},errors));formData.description=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control description\",id:\"description\",placeholder:\"Description\"}),errors.description&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.description]}),formData.description&&!errors.description&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Categories*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(Typeahead,{id:\"category_id\",labelKey:\"name\",isInvalid:errors.category_id?true:false,onChange:function onChange(selectedItems){errors.category_id=\"\";setErrors(errors);if(selectedItems.length===0){errors.category_id=\"Invalid Category selected\";setErrors(errors);setFormData(_objectSpread({},formData));setSelectedCategories([]);return;}setFormData(_objectSpread({},formData));setSelectedCategories(selectedItems);},options:categoryOptions,placeholder:\"Select Categories\",selected:selectedCategories,highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestCategories(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:openExpenseCategoryCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),errors.category_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.category_id]}),formData.category_id&&!errors.category_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Date Time*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(DatePicker,{id:\"date_str\",selected:formData.date_str?new Date(formData.date_str):null,value:formData.date_str?format(new Date(formData.date_str),\"MMMM d, yyyy h:mm aa\"):null,className:\"form-control\",dateFormat:\"MMMM d, yyyy h:mm aa\",showTimeSelect:true,timeIntervals:\"1\",onChange:function onChange(value){console.log(\"Value\",value);formData.date_str=value;// formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\nsetFormData(_objectSpread({},formData));}}),errors.date_str&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.date_str]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Payment method*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:formData.payment_method,onChange:function onChange(e){console.log(\"Inside onchange payment method\");if(!e.target.value){formData.payment_method=\"\";errors[\"status\"]=\"Invalid Payment Method\";setErrors(_objectSpread({},errors));return;}errors[\"payment_method\"]=\"\";setErrors(_objectSpread({},errors));formData.payment_method=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",SELECTED:true}),/*#__PURE__*/_jsx(\"option\",{value:\"cash\",children:\"Cash\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_account\",children:\"Bank Account / Debit / Credit Card\"})]}),errors.payment_method&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.payment_method]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Image(Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:selectedImage?selectedImage:\"\",type:\"file\",onChange:function onChange(e){errors[\"image\"]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){errors[\"image\"]=\"Invalid Image File\";setErrors(_objectSpread({},errors));return;}selectedImage=e.target.value;setSelectedImage(selectedImage);var file=document.querySelector('#image').files[0];var targetHeight=400;var targetWidth=400;var url=URL.createObjectURL(file);var img=new Image();img.onload=function(){var originaleWidth=img.width;var originalHeight=img.height;var targetDimensions=getTargetDimension(originaleWidth,originalHeight,targetWidth,targetHeight);targetWidth=targetDimensions.targetWidth;targetHeight=targetDimensions.targetHeight;resizeFIle(file,targetWidth,targetHeight,function(result){formData.images_content=[];formData.images_content[0]=result;setFormData(_objectSpread({},formData));console.log(\"formData.images_content[0]:\",formData.images_content[0]);});};img.src=url;/*\n                                        resizeFIle(file, (result) => {\n                                            if (!formData.images_content) {\n                                                formData.images_content = [];\n                                            }\n                                            formData.images_content[0] = result;\n                                            setFormData({ ...formData });\n    \n                                            console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                        });\n                                        */},className:\"form-control\",id:\"image\"}),errors.image&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.image]}),formData.image&&!errors.image&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleCreate,children:isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"bexpense\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Processing...\":formData.id?\"Update\":\"Create\"})]})]})})]})]});});export default ExpenseCreate;","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/expense/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","Modal","Button","Cookies","Spinner","ExpenseView","Typeahead","StoreCreate","ExpenseCategoryCreate","ExpenseCategoryView","Resizer","DatePicker","format","ExpenseCreate","props","ref","selectedStores","setSelectedStores","isStoresLoading","setIsStoresLoading","open","id","selectedCategories","setSelectedCategories","formData","images_content","setFormData","getExpense","SetShow","listener","event","code","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","value","preventDefault","document","addEventListener","removeEventListener","resizeFIle","file","w","h","cb","imageFileResizer","uri","selectedImage","setSelectedImage","storeOptions","setStoreOptions","categoryOptions","setCategoryOptions","errors","setErrors","isProcessing","setProcessing","cookies","show","handleClose","requestOptions","method","headers","get","fetch","then","response","isJson","json","data","ok","error","Promise","reject","categoryIds","result","category_id","categoryNames","category_name","i","length","push","name","store_id","store_name","catch","suggestCategories","searchTerm","params","queryString","ObjectToSearchQueryParams","Authorization","Select","suggestStores","at","window","location","object","Object","keys","map","key","join","handleCreate","endPoint","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","getTargetDimension","originaleWidth","originalHeight","targetWidth","targetHeight","ratio","parseFloat","parseInt","StoreCreateFormRef","openStoreCreateForm","current","ExpenseCategoryCreateFormRef","openExpenseCategoryCreateForm","ExpenseCategoryDetailsViewRef","openExpenseCategoryDetailsView","openExpenseCategoryUpdateForm","description","selectedItems","e","toString","color","amount","date_str","Date","payment_method","querySelector","files","url","URL","createObjectURL","img","Image","onload","width","height","targetDimensions","src","image"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport Cookies from \"universal-cookie\";\nimport { Spinner } from \"react-bootstrap\";\nimport ExpenseView from \"./view.js\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport StoreCreate from \"../store/create.js\";\nimport ExpenseCategoryCreate from \"../expense_category/create.js\";\nimport ExpenseCategoryView from \"../expense_category/view.js\";\nimport Resizer from \"react-image-file-resizer\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\n\n\nconst ExpenseCreate = forwardRef((props, ref) => {\n\n    //Store Auto Suggestion\n    let [selectedStores, setSelectedStores] = useState([]);\n    const [isStoresLoading, setIsStoresLoading] = useState(false);\n\n\n    useImperativeHandle(ref, () => ({\n        open(id) {\n\n\n            selectedCategories = [];\n            setSelectedCategories(selectedCategories);\n\n\n            formData = {\n                images_content: [],\n            };\n            setFormData({ formData });\n\n            if (id) {\n                getExpense(id);\n            }\n\n            SetShow(true);\n        },\n\n    }));\n\n    useEffect(() => {\n        const listener = event => {\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n                console.log(\"Enter key was pressed. Run your function-expense.\");\n                // event.preventDefault();\n\n                var form = event.target.form;\n                if (form && event.target) {\n                    var index = Array.prototype.indexOf.call(form, event.target);\n                    if (form && form.elements[index + 1]) {\n                        if (event.target.getAttribute(\"class\").includes(\"description\")) {\n                            form.elements[index].focus();\n                            form.elements[index].value += '\\r\\n';\n                        } else {\n                            form.elements[index + 1].focus();\n                        }\n                        event.preventDefault();\n                    }\n                }\n            }\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => {\n            document.removeEventListener(\"keydown\", listener);\n        };\n    }, []);\n\n\n    function resizeFIle(file, w, h, cb) {\n        Resizer.imageFileResizer(\n            file,\n            w,\n            h,\n            \"JPEG\",\n            100,\n            0,\n            (uri) => {\n                cb(uri);\n            },\n            \"base64\"\n        );\n    }\n\n    let [selectedImage, setSelectedImage] = useState(\"\");\n\n\n    let [storeOptions, setStoreOptions] = useState([]);\n\n    let [selectedCategories, setSelectedCategories] = useState([]);\n    let [categoryOptions, setCategoryOptions] = useState([]);\n\n    let [errors, setErrors] = useState({});\n    const [isProcessing, setProcessing] = useState(false);\n    const cookies = new Cookies();\n\n    //fields\n    let [formData, setFormData] = useState({\n        images_content: [],\n    });\n\n    const [show, SetShow] = useState(false);\n\n    function handleClose() {\n        SetShow(false);\n    }\n\n\n    function getExpense(id) {\n        console.log(\"inside get Expense\");\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n\n        fetch('/v1/expense/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n                console.log(\"Response:\");\n                console.log(data);\n                let categoryIds = data.result.category_id;\n                let categoryNames = data.result.category_name;\n\n                selectedCategories = [];\n                if (categoryIds && categoryNames) {\n                    for (var i = 0; i < categoryIds.length; i++) {\n                        selectedCategories.push({\n                            id: categoryIds[i],\n                            name: categoryNames[i],\n                        });\n                    }\n                }\n\n                setSelectedCategories(selectedCategories);\n\n                formData = data.result;\n\n                let selectedStores = [\n                    {\n                        id: formData.store_id,\n                        name: formData.store_name,\n                    }\n                ];\n                setSelectedStores([...selectedStores]);\n\n                formData.images_content = [];\n                setFormData({ ...formData });\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n\n    async function suggestCategories(searchTerm) {\n        console.log(\"Inside handle suggest Categories\");\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        let result = await fetch(\n            \"/v1/expense-category?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setCategoryOptions(data.result);\n    }\n\n    async function suggestStores(searchTerm) {\n        console.log(\"Inside handle suggest Stores\");\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        let result = await fetch(\n            \"/v1/store?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setStoreOptions(data.result);\n    }\n\n    useEffect(() => {\n        let at = cookies.get(\"access_token\");\n        if (!at) {\n            window.location = \"/\";\n        }\n    });\n\n\n    function ObjectToSearchQueryParams(object) {\n        return Object.keys(object)\n            .map(function (key) {\n                return `search[${key}]=${object[key]}`;\n            })\n            .join(\"&\");\n    }\n\n    function handleCreate(event) {\n        event.preventDefault();\n        console.log(\"Inside handle Create\");\n\n        formData.category_id = [];\n        for (var i = 0; i < selectedCategories.length; i++) {\n            formData.category_id.push(selectedCategories[i].id);\n        }\n\n\n        console.log(\"category_id:\", formData.category_id);\n\n        if (cookies.get(\"store_id\")) {\n            formData.store_id = cookies.get(\"store_id\");\n        }\n\n\n        let endPoint = \"/v1/expense\";\n        let method = \"POST\";\n        if (formData.id) {\n            endPoint = \"/v1/expense/\" + formData.id;\n            method = \"PUT\";\n        }\n\n\n        const requestOptions = {\n            method: method,\n            headers: {\n                'Accept': 'application/json',\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n            body: JSON.stringify(formData),\n        };\n\n        console.log(\"formData:\", formData);\n\n        setProcessing(true);\n        fetch(endPoint, requestOptions)\n            .then(async (response) => {\n                const isJson = response.headers\n                    .get(\"content-type\")\n                    ?.includes(\"application/json\");\n                const data = isJson && (await response.json());\n\n                // check for error response\n                if (!response.ok) {\n                    // get error message from body or default to response status\n                    const error = data && data.errors;\n                    //const error = data.errors\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n                setProcessing(false);\n\n                console.log(\"Response:\");\n                console.log(data);\n                props.showToastMessage(\"Expense Created Successfully!\", \"success\");\n                if (props.refreshList) {\n                    props.refreshList();\n                }\n\n                handleClose();\n                props.openDetailsView(data.result.id);\n            })\n            .catch((error) => {\n                setProcessing(false);\n                console.log(\"Inside catch\");\n                console.log(error);\n                setErrors({ ...error });\n                console.error(\"There was an error!\", error);\n                props.showToastMessage(\"Error Creating Expense!\", \"danger\");\n            });\n    }\n\n\n\n\n\n\n\n\n    function getTargetDimension(originaleWidth, originalHeight, targetWidth, targetHeight) {\n\n        let ratio = parseFloat(originaleWidth / originalHeight);\n\n        targetWidth = parseInt(targetHeight * ratio);\n        targetHeight = parseInt(targetWidth * ratio);\n\n        return { targetWidth: targetWidth, targetHeight: targetHeight };\n    }\n\n    /*\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        console.log(\"id:\", id);\n        DetailsViewRef.current.open(id);\n    }\n    */\n\n    const StoreCreateFormRef = useRef();\n    function openStoreCreateForm() {\n        StoreCreateFormRef.current.open();\n    }\n\n    const ExpenseCategoryCreateFormRef = useRef();\n    function openExpenseCategoryCreateForm() {\n        ExpenseCategoryCreateFormRef.current.open();\n    }\n\n    const ExpenseCategoryDetailsViewRef = useRef();\n    function openExpenseCategoryDetailsView(id) {\n        ExpenseCategoryDetailsViewRef.current.open(id);\n    }\n\n\n    function openExpenseCategoryUpdateForm(id) {\n        ExpenseCategoryCreateFormRef.current.open(id);\n    }\n\n    return (\n        <>\n\n            <StoreCreate ref={StoreCreateFormRef} showToastMessage={props.showToastMessage} />\n            {/*\n            <ExpenseView ref={DetailsViewRef} />\n            */}\n            <ExpenseCategoryCreate ref={ExpenseCategoryCreateFormRef} openDetailsView={openExpenseCategoryDetailsView} showToastMessage={props.showToastMessage} />\n\n            <ExpenseCategoryView ref={ExpenseCategoryDetailsViewRef} openUpdateForm={openExpenseCategoryUpdateForm} openCreateForm={openExpenseCategoryCreateForm} />\n\n\n            <Modal show={show} size=\"xl\" onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n                <Modal.Header>\n                    <Modal.Title>\n                        {formData.id ? \"Update Expense #\" + formData.description : \"Create New Expense\"}\n                    </Modal.Title>\n\n\n                    <div className=\"col align-self-end text-end\">\n                        {formData.id ? <Button variant=\"primary\" onClick={() => {\n                            handleClose();\n                            props.openDetailsView(formData.id);\n                        }}>\n                            <i className=\"bi bi-eye\"></i> View Detail\n                        </Button> : \"\"}\n                        &nbsp;&nbsp;\n                        <Button variant=\"primary\" onClick={handleCreate} >\n                            {isProcessing ?\n                                <Spinner\n                                    as=\"span\"\n                                    animation=\"border\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden={true}\n                                /> + \" Creating...\"\n\n                                : \"\"\n                            }\n                            {formData.id ? \"Update\" : \"Create\"}\n\n                        </Button>\n                        <button\n                            type=\"button\"\n                            className=\"btn-close\"\n                            onClick={handleClose}\n                            aria-label=\"Close\"\n                        ></button>\n                    </div>\n                </Modal.Header>\n                <Modal.Body>\n                    <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n\n                        {!cookies.get('store_name') ? <div className=\"col-md-6\">\n                            <label className=\"form-label\">Store*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"store_id\"\n                                    labelKey=\"name\"\n                                    isLoading={isStoresLoading}\n                                    isInvalid={errors.store_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.store_id = \"\";\n                                        errors[\"product_id\"] = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.store_id = \"Invalid Store selected\";\n                                            setErrors(errors);\n                                            setFormData({ ...formData });\n                                            setSelectedStores([]);\n                                            return;\n                                        }\n                                        formData.store_id = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        console.log(\"formData.store_id:\", formData.store_id);\n                                        selectedStores = selectedItems;\n                                        setSelectedStores([...selectedItems]);\n                                    }\n                                    }\n                                    options={storeOptions}\n                                    placeholder=\"Select Store\"\n                                    selected={selectedStores}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestStores(searchTerm);\n                                    }}\n                                />\n\n                                <Button hide={true.toString()} onClick={openStoreCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi x-lg\"> </i>\n                                    {errors.store_id}\n                                </div>\n                            </div>\n                        </div> : \"\"}\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Amount*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.amount ? formData.amount : \"\"}\n                                    type='number'\n                                    onChange={(e) => {\n                                        errors[\"amount\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.amount = parseFloat(e.target.value);\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"amount\"\n                                    placeholder=\"Amount\"\n                                />\n                                {errors.amount && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.amount}\n                                    </div>\n                                )}\n                                {formData.amount && !errors.amount && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Description*</label>\n                            <div className=\"input-group mb-3\">\n                                <textarea\n                                    value={formData.description ? formData.description : \"\"}\n                                    type='string'\n                                    onChange={(e) => {\n                                        errors[\"description\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.description = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control description\"\n                                    id=\"description\"\n                                    placeholder=\"Description\"\n                                />\n                                {errors.description && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.description}\n                                    </div>\n                                )}\n                                {formData.description && !errors.description && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Categories*</label>\n\n                            <div className=\"input-group mb-3\">\n\n                                <Typeahead\n                                    id=\"category_id\"\n                                    labelKey=\"name\"\n\n                                    isInvalid={errors.category_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.category_id = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.category_id = \"Invalid Category selected\";\n                                            setErrors(errors);\n                                            setFormData({ ...formData });\n                                            setSelectedCategories([]);\n                                            return;\n                                        }\n                                        setFormData({ ...formData });\n                                        setSelectedCategories(selectedItems);\n                                    }}\n                                    options={categoryOptions}\n                                    placeholder=\"Select Categories\"\n                                    selected={selectedCategories}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestCategories(searchTerm);\n                                    }}\n                                />\n                                <Button hide={true.toString()} onClick={openExpenseCategoryCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                {errors.category_id && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.category_id}\n                                    </div>\n                                )}\n                                {formData.category_id && !errors.category_id && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Date Time*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    selected={formData.date_str ? new Date(formData.date_str) : null}\n                                    value={formData.date_str ? format(\n                                        new Date(formData.date_str),\n                                        \"MMMM d, yyyy h:mm aa\"\n                                    ) : null}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                    showTimeSelect\n                                    timeIntervals=\"1\"\n                                    onChange={(value) => {\n                                        console.log(\"Value\", value);\n                                        formData.date_str = value;\n                                        // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n\n                        <div className=\"col-md-2\">\n                            <label className=\"form-label\">Payment method*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <select\n                                    value={formData.payment_method}\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange payment method\");\n                                        if (!e.target.value) {\n                                            formData.payment_method = \"\";\n                                            errors[\"status\"] = \"Invalid Payment Method\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        errors[\"payment_method\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.payment_method = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                >\n                                    <option value=\"\" SELECTED></option>\n                                    <option value=\"cash\">Cash</option>\n                                    <option value=\"bank_account\">Bank Account / Debit / Credit Card</option>\n                                </select>\n                                {errors.payment_method && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.payment_method}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Image(Optional)</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={selectedImage ? selectedImage : \"\"}\n                                    type='file'\n                                    onChange={(e) => {\n                                        errors[\"image\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        if (!e.target.value) {\n                                            errors[\"image\"] = \"Invalid Image File\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        selectedImage = e.target.value;\n                                        setSelectedImage(selectedImage);\n\n                                        let file = document.querySelector('#image').files[0];\n\n\n                                        let targetHeight = 400;\n                                        let targetWidth = 400;\n\n\n                                        let url = URL.createObjectURL(file);\n                                        let img = new Image();\n\n                                        img.onload = function () {\n                                            let originaleWidth = img.width;\n                                            let originalHeight = img.height;\n\n                                            let targetDimensions = getTargetDimension(originaleWidth, originalHeight, targetWidth, targetHeight);\n                                            targetWidth = targetDimensions.targetWidth;\n                                            targetHeight = targetDimensions.targetHeight;\n\n                                            resizeFIle(file, targetWidth, targetHeight, (result) => {\n                                                formData.images_content = [];\n                                                formData.images_content[0] = result;\n                                                setFormData({ ...formData });\n\n                                                console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                            });\n                                        };\n                                        img.src = url;\n\n\n                                        /*\n                                        resizeFIle(file, (result) => {\n                                            if (!formData.images_content) {\n                                                formData.images_content = [];\n                                            }\n                                            formData.images_content[0] = result;\n                                            setFormData({ ...formData });\n    \n                                            console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                        });\n                                        */\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"image\"\n                                />\n                                {errors.image && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.image}\n                                    </div>\n                                )}\n                                {formData.image && !errors.image && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n\n\n                        <Modal.Footer>\n                            <Button variant=\"secondary\" onClick={handleClose}>\n                                Close\n                            </Button>\n                            <Button variant=\"primary\" onClick={handleCreate} >\n                                {isProcessing ?\n                                    <Spinner\n                                        as=\"span\"\n                                        animation=\"bexpense\"\n                                        size=\"sm\"\n                                        role=\"status\"\n                                        aria-hidden={true}\n                                    /> + \" Processing...\"\n\n                                    : formData.id ? \"Update\" : \"Create\"\n                                }\n                            </Button>\n                        </Modal.Footer>\n                    </form>\n                </Modal.Body>\n\n            </Modal>\n\n\n        </>\n    );\n});\n\nexport default ExpenseCreate;\n"]},"metadata":{},"sourceType":"module"}