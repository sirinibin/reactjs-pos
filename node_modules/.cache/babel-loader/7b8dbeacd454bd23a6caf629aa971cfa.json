{"ast":null,"code":"var _jsxFileName = \"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/order/create.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport OrderPreview from \"./preview.js\";\nimport { Modal, Button, Form } from \"react-bootstrap\";\nimport StoreCreate from \"../store/create.js\";\nimport CustomerCreate from \"./../customer/create.js\";\nimport ProductCreate from \"./../product/create.js\";\nimport UserCreate from \"./../user/create.js\";\nimport SignatureCreate from \"./../signature/create.js\";\nimport Cookies from \"universal-cookie\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport NumberFormat from \"react-number-format\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\nimport { Spinner } from \"react-bootstrap\";\nimport OrderView from \"./view.js\";\nimport \"./style.css\";\nimport { DebounceInput } from 'react-debounce-input'; //import BarcodeScannerComponent from \"react-qr-barcode-scanner\";\n//import Quagga from 'quagga';\n\nimport ProductView from \"./../product/view.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst OrderCreate = /*#__PURE__*/forwardRef(_c = _s((props, ref) => {\n  _s();\n\n  useImperativeHandle(ref, () => ({\n    open(id) {\n      selectedProducts = [];\n      setSelectedProducts([]);\n      selectedStores = [];\n      setSelectedStores([]);\n      selectedCustomers = [];\n      setSelectedCustomers([]);\n\n      if (cookies.get(\"user_id\")) {\n        selectedDeliveredByUsers = [{\n          id: cookies.get(\"user_id\"),\n          name: cookies.get(\"user_name\")\n        }];\n        formData.delivered_by = cookies.get(\"user_id\");\n        setFormData({ ...formData\n        });\n        setSelectedDeliveredByUsers([...selectedDeliveredByUsers]);\n      }\n\n      if (cookies.get('store_id')) {\n        formData.store_id = cookies.get('store_id');\n        formData.store_name = cookies.get('store_name');\n        formData.vat_percent = parseFloat(cookies.get('vat_percent'));\n        console.log(\"formData.store_id:\", formData.store_id);\n      }\n\n      formData.id = undefined;\n      formData.discount = 0.00;\n      formData.discount_percent = 0.00;\n      formData.shipping_handling_fees = 0.00;\n      formData.partial_payment_amount = 0.00;\n      formData.status = \"delivered\";\n      formData.payment_method = \"\";\n      formData.payment_status = \"\";\n      formData.code = \"\";\n      formData.net_total = 0.00;\n      formData.date_str = new Date();\n      formData.payments = [{\n        \"date_str\": new Date(),\n        \"amount\": \"\",\n        \"method\": \"\"\n      }];\n\n      if (id) {\n        getOrder(id);\n      }\n\n      setFormData({ ...formData\n      });\n      reCalculate();\n      setShow(true);\n    }\n\n  }));\n\n  function getOrder(id) {\n    console.log(\"inside get Order\");\n    const requestOptions = {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': cookies.get('access_token')\n      }\n    };\n    fetch('/v1/order/' + id, requestOptions).then(async response => {\n      var _response$headers$get;\n\n      const isJson = (_response$headers$get = response.headers.get('content-type')) === null || _response$headers$get === void 0 ? void 0 : _response$headers$get.includes('application/json');\n      const data = isJson && (await response.json()); // check for error response\n\n      if (!response.ok) {\n        const error = data && data.errors;\n        return Promise.reject(error);\n      }\n\n      setErrors({});\n      console.log(\"Response:\");\n      console.log(data);\n      formData = data.result;\n      formData.date_str = data.result.date;\n      /*\n      let order = data.result;\n      formData = {\n          id: order.id,\n          code: order.code,\n          store_id: purchase.store_id,\n          vendor_id: purchase.vendor_id,\n          date_str: purchase.date,\n          // date: purchase.date,\n          vat_percent: purchase.vat_percent,\n          discount: purchase.discount,\n          discount_percent: purchase.discount_percent,\n          status: purchase.status,\n          order_placed_by: purchase.order_placed_by,\n          order_placed_by_signature_id: purchase.order_placed_by_signature_id,\n          is_discount_percent: purchase.is_discount_percent,\n          partial_payment_amount: purchase.partial_payment_amount,\n          payment_method: purchase.payment_method,\n          payment_status: purchase.payment_status,\n          shipping_handling_fees: purchase.shipping_handling_fees,\n      };\n      */\n\n      if (formData.is_discount_percent) {\n        formData.discountValue = formData.discount_percent;\n      } else {\n        formData.discountValue = formData.discount;\n      }\n\n      selectedProducts = formData.products;\n      setSelectedProducts([...selectedProducts]);\n      let selectedStores = [{\n        id: formData.store_id,\n        name: formData.store_name\n      }];\n      let searchLabel = formData.customer_name;\n      let selectedCustomers = [{\n        id: formData.customer_id,\n        name: formData.customer_name,\n        search_label: searchLabel\n      }];\n      /*\n      let selectedOrderPlacedByUsers = [\n          {\n              id: formData.created_by,\n              name: formData.created_by_name\n          }\n      ];\n        setSelectedOrderPlacedByUsers([...selectedOrderPlacedByUsers]);\n      */\n\n      setSelectedStores([...selectedStores]);\n      setSelectedCustomers([...selectedCustomers]);\n      reCalculate();\n      setFormData({ ...formData\n      });\n    }).catch(error => {\n      setProcessing(false);\n      setErrors(error);\n    });\n  }\n\n  useEffect(() => {\n    const listener = event => {\n      if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n        console.log(\"Enter key was pressed. Run your function-order.123\"); // event.preventDefault();\n\n        var form = event.target.form;\n\n        if (form && event.target) {\n          var index = Array.prototype.indexOf.call(form, event.target);\n\n          if (form && form.elements[index + 1]) {\n            if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n              form.elements[index].focus();\n            } else {\n              form.elements[index + 1].focus();\n            }\n\n            event.preventDefault();\n          }\n        }\n      }\n    };\n\n    document.addEventListener(\"keydown\", listener);\n    return () => {\n      document.removeEventListener(\"keydown\", listener);\n    };\n  }, []);\n  const selectedDate = new Date(); //const history = useHistory();\n\n  let [errors, setErrors] = useState({});\n  const [isProcessing, setProcessing] = useState(false);\n  const cookies = new Cookies(); //fields\n\n  let [formData, setFormData] = useState({\n    vat_percent: 15.0,\n    discountValue: 0.00,\n    discount: 0.00,\n    discount_percent: 0.0,\n    is_discount_percent: false,\n    date_str: new Date(),\n    signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n    status: \"delivered\",\n    payment_status: \"\",\n    payment_method: \"\",\n    price_type: \"retail\",\n    useLaserScanner: false,\n    store_id: \"\"\n  }); //Store Auto Suggestion\n\n  const [storeOptions, setStoreOptions] = useState([]);\n  let [selectedStores, setSelectedStores] = useState([]);\n  const [isStoresLoading, setIsStoresLoading] = useState(false); //Customer Auto Suggestion\n\n  const [customerOptions, setCustomerOptions] = useState([]);\n  let [selectedCustomers, setSelectedCustomers] = useState([]);\n  const [isCustomersLoading, setIsCustomersLoading] = useState(false); //Product Auto Suggestion\n\n  const [productOptions, setProductOptions] = useState([]);\n  let [selectedProduct, setSelectedProduct] = useState([]);\n  let [selectedProducts, setSelectedProducts] = useState([]);\n  const [isProductsLoading, setIsProductsLoading] = useState(false); //Delivered By Auto Suggestion\n\n  let [deliveredByUserOptions, setDeliveredByUserOptions] = useState([]);\n  let [selectedDeliveredByUsers, setSelectedDeliveredByUsers] = useState([]);\n  const [isDeliveredByUsersLoading, setIsDeliveredByUsersLoading] = useState(false); //Delivered By Signature Auto Suggestion\n\n  const [deliveredBySignatureOptions, setDeliveredBySignatureOptions] = useState([]);\n  const [selectedDeliveredBySignatures, setSelectedDeliveredBySignatures] = useState([]);\n  const [isDeliveredBySignaturesLoading, setIsDeliveredBySignaturesLoading] = useState(false);\n  const [show, setShow] = useState(false);\n\n  function handleClose() {\n    setShow(false);\n  }\n\n  useEffect(() => {\n    let at = cookies.get(\"access_token\");\n\n    if (!at) {\n      // history.push(\"/dashboard/orders\");\n      window.location = \"/\";\n    }\n  });\n\n  function ObjectToSearchQueryParams(object) {\n    return Object.keys(object).map(function (key) {\n      return `search[${key}]=` + encodeURIComponent(object[key]);\n    }).join(\"&\");\n  }\n\n  async function suggestStores(searchTerm) {\n    console.log(\"Inside handle suggestStores\");\n    setStoreOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name\";\n    setIsStoresLoading(true);\n    let result = await fetch(\"/v1/store?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setStoreOptions(data.result);\n    setIsStoresLoading(false);\n  }\n\n  async function suggestCustomers(searchTerm) {\n    console.log(\"Inside handle suggestCustomers\");\n    setCustomerOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name,phone,name_in_arabic,phone_in_arabic,search_label\";\n    setIsCustomersLoading(true);\n    let result = await fetch(\"/v1/customer?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setCustomerOptions(data.result);\n    setIsCustomersLoading(false);\n  }\n\n  function GetProductUnitPriceInStore(storeId, productStores) {\n    if (!productStores) {\n      return \"\";\n    }\n\n    for (var i = 0; i < productStores.length; i++) {\n      console.log(\"productStores[i]:\", productStores[i]);\n      console.log(\"store_id:\", storeId);\n\n      if (productStores[i].store_id === storeId) {\n        console.log(\"macthed\");\n        console.log(\"productStores[i].retail_unit_price:\", productStores[i].retail_unit_price);\n        return productStores[i];\n        /*\n        if (formData.price_type === \"retail\") {\n            return unitPriceListArray[i].retail_unit_price;\n        } else if (formData.price_type === \"wholesale\") {\n            return unitPriceListArray[i].wholesale_unit_price;\n        } else if (formData.price_type === \"purchase\") {\n            return unitPriceListArray[i].purchase_unit_price;\n        }\n        */\n      } else {\n        console.log(\"not matched\");\n      }\n    }\n\n    return \"\";\n  }\n\n  let [openProductSearchResult, setOpenProductSearchResult] = useState(false);\n\n  async function suggestProducts(searchTerm) {\n    console.log(\"Inside handle suggestProducts\");\n    setProductOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      openProductSearchResult = false;\n      setOpenProductSearchResult(false);\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n\n    if (cookies.get(\"store_id\")) {\n      params.store_id = cookies.get(\"store_id\");\n    }\n\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,item_code,bar_code,part_number,name,unit,part_number,name_in_arabic,product_stores\";\n    setIsProductsLoading(true);\n    let result = await fetch(\"/v1/product?\" + Select + queryString + \"&limit=200\", requestOptions);\n    let data = await result.json();\n    let products = data.result;\n\n    if (!products || products.length === 0) {\n      openProductSearchResult = false;\n      setOpenProductSearchResult(false);\n      setIsProductsLoading(false);\n      return;\n    }\n\n    openProductSearchResult = true;\n    setOpenProductSearchResult(true);\n    setProductOptions(products);\n    setIsProductsLoading(false);\n  }\n\n  async function getProductByBarCode(barcode) {\n    formData.barcode = barcode;\n    setFormData({ ...formData\n    });\n    console.log(\"Inside getProductByBarCode\");\n    errors[\"bar_code\"] = \"\";\n    setErrors({ ...errors\n    });\n    console.log(\"barcode:\" + formData.barcode);\n\n    if (!formData.barcode) {\n      return;\n    }\n\n    if (formData.barcode.length === 13) {\n      formData.barcode = formData.barcode.slice(0, -1);\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,item_code,bar_code,ean_12,part_number,name,product_stores,unit,part_number,name_in_arabic\";\n    let result = await fetch(\"/v1/product/barcode/\" + formData.barcode + \"?\" + Select, requestOptions);\n    let data = await result.json();\n    let product = data.result;\n\n    if (product) {\n      addProduct(product);\n    } else {\n      errors[\"bar_code\"] = \"Invalid Barcode:\" + formData.barcode;\n      setErrors({ ...errors\n      });\n    }\n\n    formData.barcode = \"\";\n    setFormData({ ...formData\n    });\n  }\n\n  async function suggestUsers(searchTerm) {\n    console.log(\"Inside handle suggestUsers\");\n    setDeliveredByUserOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name\";\n    setIsDeliveredByUsersLoading(true);\n    let result = await fetch(\"/v1/user?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setDeliveredByUserOptions(data.result);\n    setIsDeliveredByUsersLoading(false);\n  }\n\n  async function suggestSignatures(searchTerm) {\n    console.log(\"Inside handle suggestSignatures\");\n    setDeliveredBySignatureOptions([]);\n    console.log(\"searchTerm:\" + searchTerm);\n\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      }\n    };\n    let Select = \"select=id,name\";\n    setIsDeliveredBySignaturesLoading(true);\n    let result = await fetch(\"/v1/signature?\" + Select + queryString, requestOptions);\n    let data = await result.json();\n    setDeliveredBySignatureOptions(data.result);\n    setIsDeliveredBySignaturesLoading(false);\n  }\n\n  function handleCreate(event) {\n    event.preventDefault();\n    formData.products = [];\n\n    for (var i = 0; i < selectedProducts.length; i++) {\n      formData.products.push({\n        product_id: selectedProducts[i].product_id,\n        quantity: parseFloat(selectedProducts[i].quantity),\n        unit_price: parseFloat(selectedProducts[i].unit_price),\n        unit: selectedProducts[i].unit\n      });\n    }\n\n    if (!formData.shipping_handling_fees && formData.shipping_handling_fees !== 0) {\n      errors[\"shipping_handling_fees\"] = \"Invalid shipping / handling fees\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (formData.payment_status === \"paid_partially\" && !formData.partial_payment_amount && formData.partial_payment_amount !== 0) {\n      errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (formData.payment_status === \"paid_partially\" && formData.partial_payment_amount <= 0) {\n      errors[\"partial_payment_amount\"] = \"Partial payment should be > 0 \";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (!formData.id && formData.payment_status === \"paid_partially\" && formData.partial_payment_amount >= netTotal) {\n      errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    errors[\"payment_method\"] = \"\";\n    setErrors({ ...errors\n    });\n\n    if (!formData.id && formData.payment_status != \"not_paid\" && !formData.payment_method) {\n      errors[\"payment_method\"] = \"Payment method is required\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (!formData.discount && formData.discount !== 0) {\n      errors[\"discount\"] = \"Invalid discount\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (!formData.discount_percent && formData.discount_percent !== 0) {\n      errors[\"discount_percent\"] = \"Invalid discount percent\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (parseFloat(formData.discount_percent) > 100) {\n      errors[\"discount_percent\"] = \"Discount percent cannot be > 100\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    if (!formData.vat_percent && formData.vat_percent !== 0) {\n      errors[\"vat_percent\"] = \"Invalid vat percent\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    formData.discount = parseFloat(formData.discount);\n    formData.discount_percent = parseFloat(formData.discount_percent);\n    formData.vat_percent = parseFloat(formData.vat_percent);\n    formData.partial_payment_amount = parseFloat(formData.partial_payment_amount);\n    formData.net_total = parseFloat(netTotal);\n\n    if (cookies.get('store_id')) {\n      formData.store_id = cookies.get('store_id');\n    }\n\n    let endPoint = \"/v1/order\";\n    let method = \"POST\";\n\n    if (formData.id) {\n      endPoint = \"/v1/order/\" + formData.id;\n      method = \"PUT\";\n    }\n\n    const requestOptions = {\n      method: method,\n      headers: {\n        'Accept': 'application/json',\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\")\n      },\n      body: JSON.stringify(formData)\n    };\n    console.log(\"formData:\", formData);\n    setProcessing(true);\n    fetch(endPoint, requestOptions).then(async response => {\n      var _response$headers$get2;\n\n      const isJson = (_response$headers$get2 = response.headers.get(\"content-type\")) === null || _response$headers$get2 === void 0 ? void 0 : _response$headers$get2.includes(\"application/json\");\n      const data = isJson && (await response.json()); // check for error response\n\n      if (!response.ok) {\n        // get error message from body or default to response status\n        const error = data && data.errors; //const error = data.errors\n\n        return Promise.reject(error);\n      }\n\n      setErrors({});\n      setProcessing(false);\n      console.log(\"Response:\");\n      console.log(data);\n      props.showToastMessage(\"Order Created Successfully!\", \"success\");\n\n      if (props.refreshList) {\n        props.refreshList();\n      }\n\n      handleClose();\n      formData.products = [];\n      selectedProducts = [];\n      setSelectedProducts([]);\n      formData.customer_id = \"\";\n      setSelectedCustomers([]);\n      setFormData({ ...formData\n      });\n      reCalculate();\n      openDetailsView(data.result.id);\n    }).catch(error => {\n      setProcessing(false);\n      console.log(\"Inside catch\");\n      console.log(error);\n      setErrors({ ...error\n      });\n      console.error(\"There was an error!\", error);\n      props.showToastMessage(\"Error Creating Order!\", \"danger\");\n    });\n  }\n\n  function getProductIndex(productID) {\n    for (var i = 0; i < selectedProducts.length; i++) {\n      if (selectedProducts[i].product_id === productID) {\n        return i;\n      }\n    }\n\n    return false;\n  }\n\n  function isProductAdded(productID) {\n    for (var i = 0; i < selectedProducts.length; i++) {\n      if (selectedProducts[i].product_id === productID) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function GetProductStockInStore(storeId, productStores) {\n    if (!productStores) {\n      return 0.0;\n    }\n\n    for (var i = 0; i < productStores.length; i++) {\n      if (productStores[i].store_id === storeId) {\n        return productStores[i].stock;\n      }\n    }\n\n    return 0.0;\n  }\n\n  function addProduct(product) {\n    console.log(\"Inside Add product\");\n\n    if (!formData.store_id) {\n      errors.product_id = \"Please Select a Store and try again\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    errors.product_id = \"\";\n\n    if (!product) {\n      errors.product_id = \"Invalid Product\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n    /*\n    let productStore = GetProductUnitPriceInStore(\n        formData.store_id,\n        product.stores\n    );\n    */\n    // product.unit_price = productStore.retail_unit_price;\n\n\n    if (product.product_stores[formData.store_id]) {\n      product.unit_price = product.product_stores[formData.store_id].retail_unit_price;\n    }\n\n    errors.unit_price = \"\";\n\n    if (!product.unit_price) {\n      errors.unit_price = \"Invalid Unit Price\";\n      setErrors({ ...errors\n      });\n      return;\n    }\n\n    let alreadyAdded = false;\n    let index = false;\n    let quantity = 0.00;\n    product.quantity = 1.00;\n\n    if (isProductAdded(product.id)) {\n      alreadyAdded = true;\n      index = getProductIndex(product.id);\n      quantity = parseFloat(selectedProducts[index].quantity + product.quantity);\n    } else {\n      quantity = parseFloat(product.quantity);\n    }\n\n    console.log(\"quantity:\", quantity);\n    errors.quantity = \"\"; //let stock = GetProductStockInStore(formData.store_id, product.stores);\n\n    let stock = 0;\n\n    if (product.product_stores[formData.store_id]) {\n      stock = product.product_stores[formData.store_id].stock;\n    }\n\n    if (stock < quantity) {\n      if (index === false) {\n        index = selectedProducts.length;\n      } // errors[\"quantity_\" + index] = \"Stock is only \" + stock + \" in Store: \" + formData.store_name + \" for product: \" + product.name;\n\n\n      errors[\"quantity_\" + index] = \"Warning: Available stock is \" + stock;\n      console.log(\"errors:\", errors);\n      setErrors({ ...errors\n      });\n    }\n\n    if (alreadyAdded) {\n      selectedProducts[index].quantity = parseFloat(quantity);\n    }\n\n    if (!alreadyAdded) {\n      selectedProducts.push({\n        product_id: product.id,\n        code: product.item_code,\n        part_number: product.part_number,\n        name: product.name,\n        quantity: product.quantity,\n        product_stores: product.product_stores,\n        unit_price: parseFloat(product.unit_price).toFixed(2),\n        unit: product.unit\n      });\n    }\n\n    setSelectedProducts([...selectedProducts]);\n    reCalculate();\n  }\n\n  function removeProduct(product) {\n    const index = selectedProducts.indexOf(product);\n\n    if (index > -1) {\n      selectedProducts.splice(index, 1);\n    }\n\n    setSelectedProducts([...selectedProducts]);\n    reCalculate();\n  }\n\n  let [totalPrice, setTotalPrice] = useState(0.0);\n\n  function findTotalPrice() {\n    totalPrice = 0.00;\n\n    for (var i = 0; i < selectedProducts.length; i++) {\n      totalPrice += parseFloat(selectedProducts[i].unit_price) * parseFloat(selectedProducts[i].quantity);\n    }\n\n    totalPrice = totalPrice.toFixed(2);\n    setTotalPrice(totalPrice);\n  }\n\n  let [vatPrice, setVatPrice] = useState(0.00);\n\n  function findVatPrice() {\n    vatPrice = 0.00;\n\n    if (totalPrice > 0) {\n      vatPrice = (parseFloat(parseFloat(formData.vat_percent) / 100) * (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount))).toFixed(2);\n      ;\n      console.log(\"vatPrice:\", vatPrice);\n    }\n\n    setVatPrice(vatPrice);\n  }\n\n  let [netTotal, setNetTotal] = useState(0.00);\n\n  function findNetTotal() {\n    netTotal = 0.00;\n\n    if (totalPrice > 0) {\n      netTotal = (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount) + parseFloat(vatPrice)).toFixed(2);\n    }\n\n    setNetTotal(netTotal);\n  }\n\n  let [discountPercent, setDiscountPercent] = useState(0.00);\n\n  function findDiscountPercent() {\n    if (formData.discount >= 0 && totalPrice > 0) {\n      discountPercent = parseFloat(parseFloat(formData.discount / totalPrice) * 100).toFixed(2);\n      setDiscountPercent(discountPercent);\n      formData.discount_percent = discountPercent;\n      setFormData({ ...formData\n      });\n    }\n  }\n\n  function findDiscount() {\n    if (formData.discount_percent >= 0 && totalPrice > 0) {\n      formData.discount = parseFloat(totalPrice * parseFloat(formData.discount_percent / 100)).toFixed(2);\n      setFormData({ ...formData\n      });\n    }\n  }\n\n  function reCalculate() {\n    findTotalPrice();\n\n    if (formData.is_discount_percent) {\n      findDiscount();\n    } else {\n      findDiscountPercent();\n    }\n\n    findVatPrice();\n    findNetTotal();\n  }\n\n  const DetailsViewRef = useRef();\n\n  function openDetailsView(id) {\n    DetailsViewRef.current.open(id);\n  }\n\n  const StoreCreateFormRef = useRef();\n\n  function openStoreCreateForm() {\n    StoreCreateFormRef.current.open();\n  }\n\n  const CustomerCreateFormRef = useRef();\n\n  function openCustomerCreateForm() {\n    CustomerCreateFormRef.current.open();\n  }\n\n  const ProductCreateFormRef = useRef();\n\n  function openProductCreateForm() {\n    ProductCreateFormRef.current.open();\n  }\n\n  const UserCreateFormRef = useRef();\n\n  function openUserCreateForm() {\n    UserCreateFormRef.current.open();\n  }\n\n  const SignatureCreateFormRef = useRef();\n\n  function openSignatureCreateForm() {\n    SignatureCreateFormRef.current.open();\n  }\n\n  const ProductDetailsViewRef = useRef();\n\n  function openProductDetailsView(id) {\n    ProductDetailsViewRef.current.open(id);\n  }\n\n  function addNewPayment() {\n    formData.payments.push({\n      \"date_str\": new Date(),\n      \"amount\": \"\",\n      \"method\": \"\"\n    });\n    setFormData({ ...formData\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(OrderView, {\n      ref: DetailsViewRef,\n      openCreateForm: props.openCreateForm\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 994,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ProductView, {\n      ref: ProductDetailsViewRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 995,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(StoreCreate, {\n      ref: StoreCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 996,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CustomerCreate, {\n      ref: CustomerCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 997,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ProductCreate, {\n      ref: ProductCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 998,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(UserCreate, {\n      ref: UserCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 999,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SignatureCreate, {\n      ref: SignatureCreateFormRef,\n      showToastMessage: props.showToastMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1000,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      show: show,\n      size: \"xl\",\n      fullscreen: true,\n      onHide: handleClose,\n      animation: false,\n      backdrop: \"static\",\n      scrollable: true,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        children: [/*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: formData.id ? \"Update Sales Order #\" + formData.code : \"Create New Sales Order\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1006,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col align-self-end text-end\",\n          children: [/*#__PURE__*/_jsxDEV(OrderPreview, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1011,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"primary\",\n            onClick: handleCreate,\n            children: isProcessing ? formData.id ? \"Updating....\" : \"Creating..\" : formData.id ? \"Update\" : \"Create\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1012,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn-close\",\n            onClick: handleClose,\n            \"aria-label\": \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1017,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1010,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1005,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: [Object.keys(errors).length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: errors && Object.keys(errors).map((key, index) => {\n              return errors[key] ? /*#__PURE__*/_jsxDEV(\"li\", {\n                style: {\n                  color: \"red\"\n                },\n                children: errors[key]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1031,\n                columnNumber: 59\n              }, this) : \"\";\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1028,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1027,\n          columnNumber: 25\n        }, this) : \"\", /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"row g-3 needs-validation\",\n          onSubmit: e => {\n            e.preventDefault();\n            handleCreate(e);\n          },\n          children: [!cookies.get('store_name') ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Store*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1037,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(Typeahead, {\n                id: \"store_id\",\n                labelKey: \"name\",\n                isLoading: isStoresLoading,\n                isInvalid: errors.store_id ? true : false,\n                onChange: selectedItems => {\n                  errors.store_id = \"\";\n                  errors[\"product_id\"] = \"\";\n                  setErrors(errors);\n\n                  if (selectedItems.length === 0) {\n                    errors.store_id = \"Invalid Store selected\";\n                    setErrors(errors);\n                    setFormData({ ...formData\n                    });\n                    setSelectedStores([]);\n                    return;\n                  }\n\n                  formData.store_id = selectedItems[0].id;\n                  setFormData({ ...formData\n                  });\n                  console.log(\"formData.store_id:\", formData.store_id);\n                  selectedStores = selectedItems;\n                  setSelectedStores([...selectedItems]);\n\n                  if (formData.store_id) {\n                    if (selectedProduct[0] && selectedProduct[0].product_stores && selectedProduct[0].quantity) {\n                      let stock = 0;\n\n                      if (selectedProduct[0].product_stores) {\n                        //stock = GetProductStockInStore(formData.store_id, selectedProduct[0].stores);\n                        if (selectedProduct[0].product_stores[formData.store_id]) {\n                          stock = selectedProduct[0].product_stores[formData.store_id].stock;\n                        }\n                      }\n\n                      if (stock < parseFloat(selectedProduct[0].quantity)) {\n                        if (selectedStores[0]) {\n                          errors.product_id = \"Stock is only \" + stock + \" in Store: \" + selectedStores[0].name + \" for this product\";\n                        } else {\n                          errors.product_id = \"Stock is only \" + stock + \" in Selected Store for this product\";\n                        }\n\n                        setErrors({ ...errors\n                        });\n                      }\n                    } else if (selectedProduct[0] && selectedProduct[0].product_stores) {\n                      let stock = 0; //stock = GetProductStockInStore(formData.store_id, selectedProduct[0].stores);\n\n                      if (selectedProduct[0].product_stores[formData.store_id]) {\n                        stock = selectedProduct[0].product_stores[formData.store_id].stock;\n                      }\n\n                      if (stock === 0) {\n                        if (selectedStores[0]) {\n                          errors[\"product_id\"] = \"This product is not available in store: \" + selectedStores[0].name;\n                        } else {\n                          errors[\"product_id\"] = \"This product is not available in selected store.\";\n                        }\n\n                        setErrors({ ...errors\n                        });\n                      }\n                    }\n\n                    if (selectedProduct[0]) {\n                      /*\n                      selectedProduct[0].unit_price = GetProductUnitPriceInStore(\n                          formData.store_id,\n                          selectedProduct[0].stores\n                      );\n                      */\n                      if (selectedProduct[0].product_stores[formData.store_id]) {\n                        selectedProduct[0].unit_price = selectedProduct[0].product_stores[formData.store_id].retail_unit_price;\n                      }\n\n                      if (!selectedProduct[0].quantity) {\n                        selectedProduct[0].quantity = 1;\n                      }\n\n                      setSelectedProduct([...selectedProduct]);\n                    }\n                  }\n                },\n                options: storeOptions,\n                placeholder: \"Select Store\",\n                selected: selectedStores,\n                highlightOnlyResult: true,\n                onInputChange: (searchTerm, e) => {\n                  suggestStores(searchTerm);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1040,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                hide: true.toString(),\n                onClick: openStoreCreateForm,\n                className: \"btn btn-outline-secondary btn-primary btn-sm\",\n                type: \"button\",\n                id: \"button-addon1\",\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-plus-lg\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1129,\n                  columnNumber: 185\n                }, this), \" New\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1129,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1131,\n                  columnNumber: 37\n                }, this), errors.store_id]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1130,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1039,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1036,\n            columnNumber: 55\n          }, this) : \"\", /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Customer*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1137,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(Typeahead, {\n                id: \"customer_id\",\n                labelKey: \"search_label\",\n                isLoading: isCustomersLoading,\n                isInvalid: errors.customer_id ? true : false,\n                onChange: selectedItems => {\n                  errors.customer_id = \"\";\n                  setErrors(errors);\n\n                  if (selectedItems.length === 0) {\n                    errors.customer_id = \"Invalid Customer selected\";\n                    setErrors(errors);\n                    formData.customer_id = \"\";\n                    setFormData({ ...formData\n                    });\n                    setSelectedCustomers([]);\n                    return;\n                  }\n\n                  formData.customer_id = selectedItems[0].id;\n                  setFormData({ ...formData\n                  });\n                  setSelectedCustomers(selectedItems);\n                },\n                options: customerOptions,\n                placeholder: \"Type name or mob\",\n                selected: selectedCustomers,\n                highlightOnlyResult: true,\n                onInputChange: (searchTerm, e) => {\n                  suggestCustomers(searchTerm);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1140,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                hide: true.toString(),\n                onClick: openCustomerCreateForm,\n                className: \"btn btn-outline-secondary btn-primary btn-sm\",\n                type: \"button\",\n                id: \"button-addon1\",\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-plus-lg\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1168,\n                  columnNumber: 188\n                }, this), \" New\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1168,\n                columnNumber: 33\n              }, this), errors.customer_id && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1171,\n                  columnNumber: 41\n                }, this), errors.customer_id]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1170,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1139,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1136,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Product Barcode Scan\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1179,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(DebounceInput, {\n                minLength: 3,\n                debounceTimeout: 100,\n                placeholder: \"Scan Barcode\",\n                className: \"form-control barcode\",\n                value: formData.barcode,\n                onChange: event => getProductByBarCode(event.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1182,\n                columnNumber: 33\n              }, this), errors.bar_code && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1191,\n                  columnNumber: 41\n                }, this), errors.bar_code]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1190,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1181,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1178,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-12\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Product Search*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1200,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Typeahead, {\n              id: \"product_id\",\n              size: \"lg\",\n              labelKey: \"search_label\",\n              emptyLabel: \"\",\n              clearButton: true,\n              open: openProductSearchResult,\n              isLoading: isProductsLoading,\n              isInvalid: errors.product_id ? true : false,\n              onChange: selectedItems => {\n                if (selectedItems.length === 0) {\n                  errors[\"product_id\"] = \"Invalid Product selected\";\n                  setErrors(errors);\n                  return;\n                }\n\n                errors[\"product_id\"] = \"\";\n                setErrors({ ...errors\n                });\n\n                if (formData.store_id) {\n                  addProduct(selectedItems[0]);\n                }\n\n                setOpenProductSearchResult(false);\n              },\n              options: productOptions,\n              selected: selectedProduct,\n              placeholder: \"Search By Part No. / Name / Name in Arabic\",\n              highlightOnlyResult: true,\n              onInputChange: (searchTerm, e) => {\n                suggestProducts(searchTerm);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1227,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              hide: true.toString(),\n              onClick: openProductCreateForm,\n              className: \"btn btn-outline-secondary btn-primary btn-sm\",\n              type: \"button\",\n              id: \"button-addon1\",\n              children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-plus-lg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1259,\n                columnNumber: 183\n              }, this), \" New\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1259,\n              columnNumber: 29\n            }, this), errors.product_id ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: \"red\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-x-lg\",\n                children: \" \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1262,\n                columnNumber: 37\n              }, this), errors.product_id]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1261,\n              columnNumber: 33\n            }, this) : \"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1199,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"table-responsive\",\n            style: {\n              overflowX: \"auto\",\n              maxHeight: \"400px\",\n              overflowY: \"auto\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"table table-striped table-sm table-bordered\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"text-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"3%\"\n                    },\n                    children: \"Remove\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1274,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"5%\"\n                    },\n                    children: \"SI No.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1275,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"10%\"\n                    },\n                    children: \"Part No.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1276,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"30%\"\n                    },\n                    className: \"text-start\",\n                    children: \"Name\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1277,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"15%\"\n                    },\n                    children: \"Qty\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1278,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"18%\"\n                    },\n                    children: \"Unit Price\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1279,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    style: {\n                      width: \"32%\"\n                    },\n                    children: \"Price\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1280,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1273,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1272,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: selectedProducts.map((product, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"text-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\",\n                        cursor: \"pointer\"\n                      },\n                      onClick: () => {\n                        removeProduct(product);\n                      },\n                      children: /*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-x-lg\",\n                        children: \" \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1294,\n                        columnNumber: 53\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1288,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1287,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: index + 1\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1297,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: product.part_number\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1298,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      textDecoration: \"underline\",\n                      color: \"blue\",\n                      cursor: \"pointer\"\n                    },\n                    className: \"text-start\",\n                    onClick: () => {\n                      openProductDetailsView(product.product_id);\n                    },\n                    children: product.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1299,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"input-group mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"number\",\n                        value: product.quantity,\n                        className: \"form-control text-end\",\n                        placeholder: \"Quantity\",\n                        onChange: e => {\n                          errors[\"quantity_\" + index] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            errors[\"quantity_\" + index] = \"Invalid Quantity\";\n                            selectedProducts[index].quantity = e.target.value;\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          if (e.target.value === 0) {\n                            errors[\"quantity_\" + index] = \"Quantity should be > 0\";\n                            selectedProducts[index].quantity = e.target.value;\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          product.quantity = parseFloat(e.target.value);\n                          selectedProducts[index].quantity = parseFloat(e.target.value);\n                          reCalculate();\n                          let stock = 0;\n\n                          if (selectedProducts[index].product_stores) {\n                            var _selectedProducts$ind;\n\n                            stock = (_selectedProducts$ind = selectedProducts[index].product_stores[formData.store_id]) === null || _selectedProducts$ind === void 0 ? void 0 : _selectedProducts$ind.stock; // stock = GetProductStockInStore(formData.store_id, selectedProducts[index].stores);\n                          }\n\n                          if (stock < parseFloat(e.target.value) && selectedProducts[index].product_stores) {\n                            // errors[\"quantity_\" + index] = \" Warning: Stock is only \" + stock + \" in Store: \" + formData.store_name + \" for this product\";\n                            errors[\"quantity_\" + index] = \" Warning: Available stock is \" + stock;\n                            setErrors({ ...errors\n                            });\n                            return;\n                          }\n\n                          selectedProducts[index].quantity = parseFloat(e.target.value);\n                          console.log(\"selectedProducts[index].quantity:\", selectedProducts[index].quantity);\n                          setSelectedProducts([...selectedProducts]);\n                          reCalculate();\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1313,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"input-group-text\",\n                        id: \"basic-addon2\",\n                        children: selectedProducts[index].unit ? selectedProducts[index].unit : \"Units\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1359,\n                        columnNumber: 53\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1312,\n                      columnNumber: 49\n                    }, this), errors[\"quantity_\" + index] && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors[\"quantity_\" + index]\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1362,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1310,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"input-group mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                        type: \"number\",\n                        value: product.unit_price,\n                        className: \"form-control text-end\",\n                        placeholder: \"Unit Price\",\n                        onChange: e => {\n                          errors[\"unit_price_\" + index] = \"\";\n                          setErrors({ ...errors\n                          });\n\n                          if (!e.target.value) {\n                            errors[\"unit_price_\" + index] = \"Invalid Unit Price\";\n                            selectedProducts[index].unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          if (e.target.value === 0) {\n                            errors[\"unit_price_\" + index] = \"Unit Price should be > 0\";\n                            selectedProducts[index].unit_price = parseFloat(e.target.value);\n                            setSelectedProducts([...selectedProducts]);\n                            setErrors({ ...errors\n                            });\n                            console.log(\"errors:\", errors);\n                            return;\n                          }\n\n                          selectedProducts[index].unit_price = parseFloat(e.target.value);\n                          console.log(\"selectedProducts[index].unit_price:\", selectedProducts[index].unit_price);\n                          setSelectedProducts([...selectedProducts]);\n                          reCalculate();\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1371,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"input-group-text\",\n                        id: \"basic-addon2\",\n                        children: \"SAR\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1401,\n                        columnNumber: 53\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1370,\n                      columnNumber: 49\n                    }, this), errors[\"unit_price_\" + index] && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                        className: \"bi bi-x-lg\",\n                        children: \" \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1405,\n                        columnNumber: 57\n                      }, this), errors[\"unit_price_\" + index]]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1404,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1368,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: (product.unit_price * product.quantity).toFixed(2),\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \" SAR\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1412,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1411,\n                    columnNumber: 45\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1286,\n                  columnNumber: 41\n                }, this)).reverse()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1284,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1271,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1270,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"table-responsive\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"table table-striped table-sm table-bordered\",\n              children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: \"Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1431,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    style: {\n                      width: \"200px\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: totalPrice,\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \" SAR\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1433,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1432,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1428,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: \"Shipping & Handling Fees\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1443,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      style: {\n                        width: \"150px\"\n                      },\n                      className: \"text-start\",\n                      value: formData.shipping_handling_fees,\n                      onChange: e => {\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.shipping_handling_fees = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"shipping_handling_fees\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.shipping_handling_fees = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"shipping_handling_fees\"] = \"Shipping / Handling Fees should be > 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.shipping_handling_fees = \"\";\n                          errors[\"shipping_handling_fees\"] = \"Invalid Shipping / Handling Fees\";\n                          setFormData({ ...formData\n                          });\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"shipping_handling_fees\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.shipping_handling_fees = parseFloat(e.target.value);\n                        setFormData({ ...formData\n                        });\n                        reCalculate();\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1447,\n                      columnNumber: 45\n                    }, this), \" SAR\", errors.shipping_handling_fees && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.shipping_handling_fees\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1484,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1446,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1442,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: [\"Discount  \", /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      style: {\n                        width: \"50px\"\n                      },\n                      className: \"text-start\",\n                      value: formData.discount_percent,\n                      onChange: e => {\n                        formData.is_discount_percent = true;\n\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.discount_percent = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount_percent\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.discount_percent = parseFloat(e.target.value);\n                          formData.discount = 0.00;\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount_percent\"] = \"Discount percent should be >= 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.discount_percent = \"\";\n                          formData.discount = 0.00;\n                          errors[\"discount_percent\"] = \"Invalid Discount Percent\";\n                          setFormData({ ...formData\n                          });\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"discount_percent\"] = \"\";\n                        errors[\"discount\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.discount_percent = parseFloat(e.target.value);\n                        setFormData({ ...formData\n                        });\n                        reCalculate();\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1492,\n                      columnNumber: 55\n                    }, this), \"%\", errors.discount_percent && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.discount_percent\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1531,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1491,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      style: {\n                        width: \"150px\"\n                      },\n                      className: \"text-start\",\n                      value: formData.discount,\n                      onChange: e => {\n                        formData.is_discount_percent = false;\n\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.discount = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.discount = parseFloat(e.target.value);\n                          formData.discount_percent = 0.00;\n                          setFormData({ ...formData\n                          });\n                          errors[\"discount\"] = \"Discount should be >= 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.discount = \"\";\n                          formData.discount_percent = 0.00;\n                          errors[\"discount\"] = \"Invalid Discount\";\n                          setFormData({ ...formData\n                          });\n                          reCalculate();\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"discount\"] = \"\";\n                        errors[\"discount_percent\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.discount = parseFloat(e.target.value);\n                        setFormData({ ...formData\n                        });\n                        reCalculate();\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1537,\n                      columnNumber: 45\n                    }, this), \" SAR\", errors.discount && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.discount\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1578,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1536,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1490,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: [\" VAT  \", /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      className: \"text-center\",\n                      style: {\n                        width: \"50px\"\n                      },\n                      value: formData.vat_percent,\n                      onChange: e => {\n                        console.log(\"Inside onchange vat percent\");\n\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.vat_percent = parseFloat(e.target.value);\n                          setFormData({ ...formData\n                          });\n                          errors[\"vat_percent\"] = \"\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.vat_percent = parseFloat(e.target.value);\n                          vatPrice = 0.00;\n                          setVatPrice(vatPrice);\n                          setFormData({ ...formData\n                          });\n                          errors[\"vat_percent\"] = \"Vat percent should be >= 0\";\n                          setErrors({ ...errors\n                          });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.vat_percent = \"\";\n                          vatPrice = 0.00;\n                          setVatPrice(vatPrice); //formData.discount_percent = 0.00;\n\n                          errors[\"vat_percent\"] = \"Invalid vat percent\";\n                          setFormData({ ...formData\n                          });\n                          setErrors({ ...errors\n                          });\n                          return;\n                        }\n\n                        errors[\"vat_percent\"] = \"\";\n                        setErrors({ ...errors\n                        });\n                        formData.vat_percent = e.target.value;\n                        reCalculate();\n                        setFormData({ ...formData\n                        });\n                        console.log(formData);\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1586,\n                      columnNumber: 84\n                    }, this), \"%\", errors.vat_percent && /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        color: \"red\"\n                      },\n                      children: errors.vat_percent\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1627,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1586,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"text-end\",\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: vatPrice,\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \" SAR\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1633,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1632,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1584,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    colSpan: \"8\",\n                    className: \"text-end\",\n                    children: \"Net Total\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1644,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"text-end\",\n                    children: /*#__PURE__*/_jsxDEV(NumberFormat, {\n                      value: netTotal,\n                      displayType: \"text\",\n                      thousandSeparator: true,\n                      suffix: \" SAR\",\n                      renderText: (value, props) => value\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1646,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1645,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1642,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1427,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1426,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1425,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Payments Received\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1900,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"table-responsive\",\n            style: {\n              maxWidth: \"800px\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              class: \"table table-striped table-sm table-bordered\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1904,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1907,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Payment method\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1910,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Action\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1913,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1903,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: formData.payments && formData.payments.map((payment, key) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"200px\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"input\", {\n                      value: formData.payments[key].date_str,\n                      className: \"form-control\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1923,\n                      columnNumber: 53\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1922,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"200px\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      value: formData.payments[key].amount,\n                      className: \"form-control \",\n                      onChange: e => {\n                        //  console.log(\"Inside onchange vat discount\");\n                        if (!e.target.value) {\n                          formData.payments[key].amount = e.target.value;\n                          setFormData({ ...formData\n                          }); //errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n                          //setErrors({ ...errors });\n\n                          return;\n                        } //formData.partial_payment_amount = parseFloat(e.target.value);\n\n\n                        formData.payments[key].amount = parseFloat(e.target.value); //errors[\"partial_payment_amount\"] = \"\";\n\n                        /*\n                        if (!formData.id && formData.partial_payment_amount >= netTotal) {\n                            errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n                            setErrors({ ...errors });\n                            return;\n                        }*/\n                        //setErrors({ ...errors });\n\n                        setFormData({ ...formData\n                        });\n                        console.log(formData);\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1926,\n                      columnNumber: 53\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1925,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"200px\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"select\", {\n                      value: formData.payments[key].method,\n                      className: \"form-control \",\n                      onChange: e => {\n                        if (!e.target.value) {\n                          /* errors[\"payment_method\"] = \"Payment method is required\";\n                           setErrors({ ...errors });\n                           */\n                          formData.payments[key].method = \"\";\n                          setFormData({ ...formData\n                          });\n                          return;\n                        } // errors[\"payment_method\"] = \"\";\n                        //setErrors({ ...errors });\n\n\n                        formData.payments[key].method = e.target.value;\n                        setFormData({ ...formData\n                        });\n                        console.log(formData);\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"\",\n                        children: \"Select\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1972,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"cash\",\n                        children: \"Cash\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1973,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"bank_account\",\n                        children: \"Bank Account / Debit / Credit Card\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1974,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: \"customer_account\",\n                        children: \"Customer Account\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1975,\n                        columnNumber: 57\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1953,\n                      columnNumber: 53\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1952,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    style: {\n                      width: \"200px\"\n                    },\n                    children: formData.payments.length == key + 1 ? /*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"secondary\",\n                      onClick: addNewPayment,\n                      children: \"New payment\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1979,\n                      columnNumber: 88\n                    }, this) : \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1978,\n                    columnNumber: 49\n                  }, this)]\n                }, key, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1921,\n                  columnNumber: 45\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1918,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1902,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1901,\n            columnNumber: 25\n          }, this), !formData.id ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Payment method*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1991,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                value: formData.payment_method,\n                disabled: formData.payment_status == \"not_paid\" ? \"disabled\" : \"\",\n                onChange: e => {\n                  if (!e.target.value) {\n                    errors[\"payment_method\"] = \"Payment method is required\";\n                    setErrors({ ...errors\n                    });\n                    formData.payment_method = \"\";\n                    setFormData({ ...formData\n                    });\n                    return;\n                  }\n\n                  errors[\"payment_method\"] = \"\";\n                  setErrors({ ...errors\n                  });\n                  formData.payment_method = e.target.value;\n                  setFormData({ ...formData\n                  });\n                  console.log(formData);\n                },\n                className: \"form-control\",\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2015,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"cash\",\n                  children: \"Cash\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2016,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"bank_account\",\n                  children: \"Bank Account / Debit / Credit Card\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2017,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"customer_account\",\n                  children: \"Customer Account\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2018,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1994,\n                columnNumber: 33\n              }, this), errors.payment_method && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2022,\n                  columnNumber: 41\n                }, this), errors.payment_method]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2021,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1993,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1990,\n            columnNumber: 41\n          }, this) : \"\", !formData.id ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Payment Status*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2029,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                value: formData.payment_status,\n                onChange: e => {\n                  console.log(\"Inside onchange payment Status\");\n\n                  if (!e.target.value) {\n                    errors[\"payment_status\"] = \"Payment status is required\";\n                    formData.payment_status = \"\";\n                    setFormData({ ...formData\n                    });\n                    setErrors({ ...errors\n                    });\n                    return;\n                  }\n\n                  errors[\"payment_status\"] = \"\";\n                  setErrors({ ...errors\n                  });\n                  formData.payment_status = e.target.value;\n\n                  if (formData.payment_status !== \"paid_partially\") {\n                    formData.partial_payment_amount = 0.00;\n                  }\n\n                  setFormData({ ...formData\n                  });\n\n                  if (formData.payment_status == \"not_paid\") {\n                    formData.payment_method = \"\";\n                    setFormData({ ...formData\n                    });\n                  }\n\n                  console.log(formData);\n                },\n                className: \"form-control\",\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2062,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"paid\",\n                  children: \"Paid\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2063,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"not_paid\",\n                  children: \"Not Paid\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2064,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"paid_partially\",\n                  children: \"Paid Partially\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2065,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2032,\n                columnNumber: 33\n              }, this), errors.payment_status && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2069,\n                  columnNumber: 41\n                }, this), errors.payment_status]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2068,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2031,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2028,\n            columnNumber: 41\n          }, this) : \"\", !formData.id && formData.payment_status === \"paid_partially\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Patial Payment Amount*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2078,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                value: formData.partial_payment_amount,\n                onChange: e => {\n                  console.log(\"Inside onchange vat discount\");\n\n                  if (!e.target.value) {\n                    formData.partial_payment_amount = e.target.value;\n                    errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n                    setErrors({ ...errors\n                    });\n                    return;\n                  }\n\n                  formData.partial_payment_amount = parseFloat(e.target.value);\n                  errors[\"partial_payment_amount\"] = \"\";\n\n                  if (!formData.id && formData.partial_payment_amount >= netTotal) {\n                    errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n                    setErrors({ ...errors\n                    });\n                    return;\n                  }\n\n                  setErrors({ ...errors\n                  });\n                  setFormData({ ...formData\n                  });\n                  console.log(formData);\n                },\n                className: \"form-control\",\n                id: \"validationCustom02\",\n                placeholder: \"Amount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2081,\n                columnNumber: 33\n              }, this), errors.partial_payment_amount && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2110,\n                  columnNumber: 41\n                }, this), errors.partial_payment_amount]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2109,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2080,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2077,\n            columnNumber: 89\n          }, this) : \"\", /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Date*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2118,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"input-group mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(DatePicker, {\n                id: \"date_str\",\n                selected: formData.date_str ? new Date(formData.date_str) : null,\n                value: formData.date_str ? format(new Date(formData.date_str), \"MMMM d, yyyy h:mm aa\") : null,\n                className: \"form-control\",\n                dateFormat: \"MMMM d, yyyy h:mm aa\",\n                showTimeSelect: true,\n                timeIntervals: \"1\",\n                onChange: value => {\n                  console.log(\"Value\", value);\n                  formData.date_str = value; // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n\n                  setFormData({ ...formData\n                  });\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2121,\n                columnNumber: 33\n              }, this), errors.date_str && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  color: \"red\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x-lg\",\n                  children: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2142,\n                  columnNumber: 41\n                }, this), errors.date_str]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2141,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2120,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2117,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              variant: \"secondary\",\n              onClick: handleClose,\n              children: \"Close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2185,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"primary\",\n              onClick: handleCreate,\n              children: isProcessing ? formData.id ? \"Updating....\" : \"Creating..\" : formData.id ? \"Update\" : \"Create\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2188,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2184,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1035,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1025,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1003,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}, \"N9ykb0fpGs9btMdbd1NTqDHJX9g=\", false, function () {\n  return [useImperativeHandle];\n}));\n_c2 = OrderCreate;\nexport default OrderCreate;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"OrderCreate$forwardRef\");\n$RefreshReg$(_c2, \"OrderCreate\");","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/order/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","OrderPreview","Modal","Button","Form","StoreCreate","CustomerCreate","ProductCreate","UserCreate","SignatureCreate","Cookies","Typeahead","NumberFormat","DatePicker","format","Spinner","OrderView","DebounceInput","ProductView","OrderCreate","props","ref","open","id","selectedProducts","setSelectedProducts","selectedStores","setSelectedStores","selectedCustomers","setSelectedCustomers","cookies","get","selectedDeliveredByUsers","name","formData","delivered_by","setFormData","setSelectedDeliveredByUsers","store_id","store_name","vat_percent","parseFloat","console","log","undefined","discount","discount_percent","shipping_handling_fees","partial_payment_amount","status","payment_method","payment_status","code","net_total","date_str","Date","payments","getOrder","reCalculate","setShow","requestOptions","method","headers","fetch","then","response","isJson","includes","data","json","ok","error","errors","Promise","reject","setErrors","result","date","is_discount_percent","discountValue","products","searchLabel","customer_name","customer_id","search_label","catch","setProcessing","listener","event","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","focus","preventDefault","document","addEventListener","removeEventListener","selectedDate","isProcessing","signature_date_str","price_type","useLaserScanner","storeOptions","setStoreOptions","isStoresLoading","setIsStoresLoading","customerOptions","setCustomerOptions","isCustomersLoading","setIsCustomersLoading","productOptions","setProductOptions","selectedProduct","setSelectedProduct","isProductsLoading","setIsProductsLoading","deliveredByUserOptions","setDeliveredByUserOptions","isDeliveredByUsersLoading","setIsDeliveredByUsersLoading","deliveredBySignatureOptions","setDeliveredBySignatureOptions","selectedDeliveredBySignatures","setSelectedDeliveredBySignatures","isDeliveredBySignaturesLoading","setIsDeliveredBySignaturesLoading","show","handleClose","at","window","location","ObjectToSearchQueryParams","object","Object","keys","map","key","encodeURIComponent","join","suggestStores","searchTerm","params","queryString","Authorization","Select","suggestCustomers","GetProductUnitPriceInStore","storeId","productStores","i","length","retail_unit_price","openProductSearchResult","setOpenProductSearchResult","suggestProducts","getProductByBarCode","barcode","slice","product","addProduct","suggestUsers","suggestSignatures","handleCreate","push","product_id","quantity","unit_price","unit","netTotal","endPoint","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","getProductIndex","productID","isProductAdded","GetProductStockInStore","stock","product_stores","alreadyAdded","item_code","part_number","toFixed","removeProduct","splice","totalPrice","setTotalPrice","findTotalPrice","vatPrice","setVatPrice","findVatPrice","setNetTotal","findNetTotal","discountPercent","setDiscountPercent","findDiscountPercent","findDiscount","DetailsViewRef","current","StoreCreateFormRef","openStoreCreateForm","CustomerCreateFormRef","openCustomerCreateForm","ProductCreateFormRef","openProductCreateForm","UserCreateFormRef","openUserCreateForm","SignatureCreateFormRef","openSignatureCreateForm","ProductDetailsViewRef","openProductDetailsView","addNewPayment","openCreateForm","color","e","selectedItems","toString","value","bar_code","overflowX","maxHeight","overflowY","width","cursor","textDecoration","reverse","maxWidth","payment","amount"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport OrderPreview from \"./preview.js\";\nimport { Modal, Button, Form } from \"react-bootstrap\";\nimport StoreCreate from \"../store/create.js\";\nimport CustomerCreate from \"./../customer/create.js\";\nimport ProductCreate from \"./../product/create.js\";\nimport UserCreate from \"./../user/create.js\";\nimport SignatureCreate from \"./../signature/create.js\";\nimport Cookies from \"universal-cookie\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport NumberFormat from \"react-number-format\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\nimport { Spinner } from \"react-bootstrap\";\nimport OrderView from \"./view.js\";\nimport \"./style.css\";\nimport { DebounceInput } from 'react-debounce-input';\n//import BarcodeScannerComponent from \"react-qr-barcode-scanner\";\n//import Quagga from 'quagga';\nimport ProductView from \"./../product/view.js\";\n\nconst OrderCreate = forwardRef((props, ref) => {\n\n\n    useImperativeHandle(ref, () => ({\n        open(id) {\n            selectedProducts = [];\n            setSelectedProducts([]);\n\n            selectedStores = [];\n            setSelectedStores([]);\n\n            selectedCustomers = [];\n            setSelectedCustomers([]);\n\n\n\n            if (cookies.get(\"user_id\")) {\n                selectedDeliveredByUsers = [{\n                    id: cookies.get(\"user_id\"),\n                    name: cookies.get(\"user_name\"),\n                }];\n                formData.delivered_by = cookies.get(\"user_id\");\n                setFormData({ ...formData });\n                setSelectedDeliveredByUsers([...selectedDeliveredByUsers]);\n            }\n\n            if (cookies.get('store_id')) {\n                formData.store_id = cookies.get('store_id');\n                formData.store_name = cookies.get('store_name');\n                formData.vat_percent = parseFloat(cookies.get('vat_percent'));\n                console.log(\"formData.store_id:\", formData.store_id);\n            }\n\n            formData.id = undefined;\n            formData.discount = 0.00;\n            formData.discount_percent = 0.00;\n            formData.shipping_handling_fees = 0.00;\n            formData.partial_payment_amount = 0.00;\n            formData.status = \"delivered\";\n            formData.payment_method = \"\";\n            formData.payment_status = \"\";\n            formData.code = \"\";\n            formData.net_total = 0.00;\n            formData.date_str = new Date();\n            formData.payments=[\n                {\n                    \"date_str\":new Date(),\n                    \"amount\":\"\",\n                    \"method\":\"\",\n                }\n            ];\n            if (id) {\n                getOrder(id);\n            }\n            setFormData({ ...formData });\n            reCalculate();\n            setShow(true);\n\n        },\n    }));\n\n\n    function getOrder(id) {\n        console.log(\"inside get Order\");\n        const requestOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': cookies.get('access_token'),\n            },\n        };\n\n        fetch('/v1/order/' + id, requestOptions)\n            .then(async response => {\n                const isJson = response.headers.get('content-type')?.includes('application/json');\n                const data = isJson && await response.json();\n\n                // check for error response\n                if (!response.ok) {\n                    const error = (data && data.errors);\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n\n                console.log(\"Response:\");\n                console.log(data);\n\n                formData = data.result;\n                formData.date_str = data.result.date;\n                /*\n                let order = data.result;\n                formData = {\n                    id: order.id,\n                    code: order.code,\n                    store_id: purchase.store_id,\n                    vendor_id: purchase.vendor_id,\n                    date_str: purchase.date,\n                    // date: purchase.date,\n                    vat_percent: purchase.vat_percent,\n                    discount: purchase.discount,\n                    discount_percent: purchase.discount_percent,\n                    status: purchase.status,\n                    order_placed_by: purchase.order_placed_by,\n                    order_placed_by_signature_id: purchase.order_placed_by_signature_id,\n                    is_discount_percent: purchase.is_discount_percent,\n                    partial_payment_amount: purchase.partial_payment_amount,\n                    payment_method: purchase.payment_method,\n                    payment_status: purchase.payment_status,\n                    shipping_handling_fees: purchase.shipping_handling_fees,\n                };\n                */\n\n                if (formData.is_discount_percent) {\n                    formData.discountValue = formData.discount_percent;\n                } else {\n                    formData.discountValue = formData.discount;\n                }\n\n                selectedProducts = formData.products;\n                setSelectedProducts([...selectedProducts]);\n\n\n                let selectedStores = [\n                    {\n                        id: formData.store_id,\n                        name: formData.store_name,\n                    }\n                ];\n\n\n                let searchLabel = formData.customer_name;\n\n                let selectedCustomers = [\n                    {\n                        id: formData.customer_id,\n                        name: formData.customer_name,\n                        search_label: searchLabel,\n                    }\n                ];\n\n                /*\n                let selectedOrderPlacedByUsers = [\n                    {\n                        id: formData.created_by,\n                        name: formData.created_by_name\n                    }\n                ];\n\n\n                setSelectedOrderPlacedByUsers([...selectedOrderPlacedByUsers]);\n                */\n\n                setSelectedStores([...selectedStores]);\n                setSelectedCustomers([...selectedCustomers]);\n\n                reCalculate();\n                setFormData({ ...formData });\n\n\n            })\n            .catch(error => {\n                setProcessing(false);\n                setErrors(error);\n            });\n    }\n\n    useEffect(() => {\n        const listener = event => {\n            if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n                console.log(\"Enter key was pressed. Run your function-order.123\");\n                // event.preventDefault();\n\n\n\n                var form = event.target.form;\n                if (form && event.target) {\n                    var index = Array.prototype.indexOf.call(form, event.target);\n                    if (form && form.elements[index + 1]) {\n                        if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n                            form.elements[index].focus();\n                        } else {\n                            form.elements[index + 1].focus();\n                        }\n                        event.preventDefault();\n                    }\n                }\n            }\n        };\n        document.addEventListener(\"keydown\", listener);\n        return () => {\n            document.removeEventListener(\"keydown\", listener);\n        };\n    }, []);\n\n\n    const selectedDate = new Date();\n\n    //const history = useHistory();\n    let [errors, setErrors] = useState({});\n    const [isProcessing, setProcessing] = useState(false);\n    const cookies = new Cookies();\n\n    //fields\n    let [formData, setFormData] = useState({\n        vat_percent: 15.0,\n        discountValue: 0.00,\n        discount: 0.00,\n        discount_percent: 0.0,\n        is_discount_percent: false,\n        date_str: new Date(),\n        signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n        status: \"delivered\",\n        payment_status: \"\",\n        payment_method: \"\",\n        price_type: \"retail\",\n        useLaserScanner: false,\n        store_id: \"\",\n    });\n\n    //Store Auto Suggestion\n    const [storeOptions, setStoreOptions] = useState([]);\n    let [selectedStores, setSelectedStores] = useState([]);\n    const [isStoresLoading, setIsStoresLoading] = useState(false);\n\n    //Customer Auto Suggestion\n    const [customerOptions, setCustomerOptions] = useState([]);\n    let [selectedCustomers, setSelectedCustomers] = useState([]);\n    const [isCustomersLoading, setIsCustomersLoading] = useState(false);\n\n    //Product Auto Suggestion\n    const [productOptions, setProductOptions] = useState([]);\n    let [selectedProduct, setSelectedProduct] = useState([]);\n    let [selectedProducts, setSelectedProducts] = useState([]);\n    const [isProductsLoading, setIsProductsLoading] = useState(false);\n\n    //Delivered By Auto Suggestion\n    let [deliveredByUserOptions, setDeliveredByUserOptions] = useState([]);\n    let [selectedDeliveredByUsers, setSelectedDeliveredByUsers] = useState([]);\n    const [isDeliveredByUsersLoading, setIsDeliveredByUsersLoading] =\n        useState(false);\n\n    //Delivered By Signature Auto Suggestion\n    const [deliveredBySignatureOptions, setDeliveredBySignatureOptions] =\n        useState([]);\n    const [selectedDeliveredBySignatures, setSelectedDeliveredBySignatures] =\n        useState([]);\n    const [isDeliveredBySignaturesLoading, setIsDeliveredBySignaturesLoading] =\n        useState(false);\n\n    const [show, setShow] = useState(false);\n\n    function handleClose() {\n        setShow(false);\n    }\n\n    useEffect(() => {\n        let at = cookies.get(\"access_token\");\n        if (!at) {\n            // history.push(\"/dashboard/orders\");\n            window.location = \"/\";\n        }\n    });\n\n\n    function ObjectToSearchQueryParams(object) {\n        return Object.keys(object)\n            .map(function (key) {\n                return `search[${key}]=` + encodeURIComponent(object[key]);\n            })\n            .join(\"&\");\n    }\n\n    async function suggestStores(searchTerm) {\n        console.log(\"Inside handle suggestStores\");\n        setStoreOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsStoresLoading(true);\n        let result = await fetch(\n            \"/v1/store?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setStoreOptions(data.result);\n        setIsStoresLoading(false);\n    }\n\n    async function suggestCustomers(searchTerm) {\n        console.log(\"Inside handle suggestCustomers\");\n        setCustomerOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name,phone,name_in_arabic,phone_in_arabic,search_label\";\n        setIsCustomersLoading(true);\n        let result = await fetch(\n            \"/v1/customer?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setCustomerOptions(data.result);\n        setIsCustomersLoading(false);\n    }\n\n    function GetProductUnitPriceInStore(storeId, productStores) {\n        if (!productStores) {\n            return \"\";\n        }\n\n        for (var i = 0; i < productStores.length; i++) {\n            console.log(\"productStores[i]:\", productStores[i]);\n            console.log(\"store_id:\", storeId);\n\n            if (productStores[i].store_id === storeId) {\n                console.log(\"macthed\");\n                console.log(\n                    \"productStores[i].retail_unit_price:\",\n                    productStores[i].retail_unit_price\n                );\n                return productStores[i];\n                /*\n                if (formData.price_type === \"retail\") {\n                    return unitPriceListArray[i].retail_unit_price;\n                } else if (formData.price_type === \"wholesale\") {\n                    return unitPriceListArray[i].wholesale_unit_price;\n                } else if (formData.price_type === \"purchase\") {\n                    return unitPriceListArray[i].purchase_unit_price;\n                }\n                */\n\n            } else {\n                console.log(\"not matched\");\n            }\n        }\n        return \"\";\n    }\n\n\n\n    let [openProductSearchResult, setOpenProductSearchResult] = useState(false);\n\n    async function suggestProducts(searchTerm) {\n        console.log(\"Inside handle suggestProducts\");\n        setProductOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            openProductSearchResult = false;\n            setOpenProductSearchResult(false);\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n\n        if (cookies.get(\"store_id\")) {\n            params.store_id = cookies.get(\"store_id\");\n        }\n\n\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,item_code,bar_code,part_number,name,unit,part_number,name_in_arabic,product_stores\";\n        setIsProductsLoading(true);\n        let result = await fetch(\n            \"/v1/product?\" + Select + queryString + \"&limit=200\",\n            requestOptions\n        );\n        let data = await result.json();\n\n        let products = data.result;\n        if (!products || products.length === 0) {\n            openProductSearchResult = false;\n            setOpenProductSearchResult(false);\n            setIsProductsLoading(false);\n            return;\n        }\n\n        openProductSearchResult = true;\n        setOpenProductSearchResult(true);\n        setProductOptions(products);\n        setIsProductsLoading(false);\n\n    }\n\n    async function getProductByBarCode(barcode) {\n        formData.barcode = barcode;\n        setFormData({ ...formData });\n        console.log(\"Inside getProductByBarCode\");\n        errors[\"bar_code\"] = \"\";\n        setErrors({ ...errors });\n\n        console.log(\"barcode:\" + formData.barcode);\n        if (!formData.barcode) {\n            return;\n        }\n\n        if (formData.barcode.length === 13) {\n            formData.barcode = formData.barcode.slice(0, -1);\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n\n        let Select = \"select=id,item_code,bar_code,ean_12,part_number,name,product_stores,unit,part_number,name_in_arabic\";\n        let result = await fetch(\n            \"/v1/product/barcode/\" + formData.barcode + \"?\" + Select,\n            requestOptions\n        );\n        let data = await result.json();\n\n\n        let product = data.result;\n        if (product) {\n            addProduct(product);\n        } else {\n            errors[\"bar_code\"] = \"Invalid Barcode:\" + formData.barcode\n            setErrors({ ...errors });\n        }\n\n        formData.barcode = \"\";\n        setFormData({ ...formData });\n\n    }\n\n    async function suggestUsers(searchTerm) {\n        console.log(\"Inside handle suggestUsers\");\n        setDeliveredByUserOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsDeliveredByUsersLoading(true);\n        let result = await fetch(\n            \"/v1/user?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setDeliveredByUserOptions(data.result);\n        setIsDeliveredByUsersLoading(false);\n    }\n\n    async function suggestSignatures(searchTerm) {\n        console.log(\"Inside handle suggestSignatures\");\n        setDeliveredBySignatureOptions([]);\n\n        console.log(\"searchTerm:\" + searchTerm);\n        if (!searchTerm) {\n            return;\n        }\n\n        var params = {\n            name: searchTerm,\n        };\n        var queryString = ObjectToSearchQueryParams(params);\n        if (queryString !== \"\") {\n            queryString = \"&\" + queryString;\n        }\n\n        const requestOptions = {\n            method: \"GET\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n        };\n\n        let Select = \"select=id,name\";\n        setIsDeliveredBySignaturesLoading(true);\n        let result = await fetch(\n            \"/v1/signature?\" + Select + queryString,\n            requestOptions\n        );\n        let data = await result.json();\n\n        setDeliveredBySignatureOptions(data.result);\n        setIsDeliveredBySignaturesLoading(false);\n    }\n\n    function handleCreate(event) {\n        event.preventDefault();\n\n        formData.products = [];\n        for (var i = 0; i < selectedProducts.length; i++) {\n            formData.products.push({\n                product_id: selectedProducts[i].product_id,\n                quantity: parseFloat(selectedProducts[i].quantity),\n                unit_price: parseFloat(selectedProducts[i].unit_price),\n                unit: selectedProducts[i].unit,\n            });\n        }\n\n\n        if (!formData.shipping_handling_fees && formData.shipping_handling_fees !== 0) {\n            errors[\"shipping_handling_fees\"] = \"Invalid shipping / handling fees\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (formData.payment_status === \"paid_partially\" && !formData.partial_payment_amount && formData.partial_payment_amount !== 0) {\n            errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (formData.payment_status === \"paid_partially\" && formData.partial_payment_amount <= 0) {\n            errors[\"partial_payment_amount\"] = \"Partial payment should be > 0 \";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (!formData.id && formData.payment_status === \"paid_partially\" && formData.partial_payment_amount >= netTotal) {\n            errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n            setErrors({ ...errors });\n            return;\n        }\n\n        errors[\"payment_method\"] = \"\";\n        setErrors({ ...errors });\n        if (!formData.id && formData.payment_status != \"not_paid\" && !formData.payment_method) {\n            errors[\"payment_method\"] = \"Payment method is required\";\n            setErrors({ ...errors });\n            return;\n        }\n\n\n        if (!formData.discount && formData.discount !== 0) {\n            errors[\"discount\"] = \"Invalid discount\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (!formData.discount_percent && formData.discount_percent !== 0) {\n            errors[\"discount_percent\"] = \"Invalid discount percent\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (parseFloat(formData.discount_percent) > 100) {\n            errors[\"discount_percent\"] = \"Discount percent cannot be > 100\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        if (!formData.vat_percent && formData.vat_percent !== 0) {\n            errors[\"vat_percent\"] = \"Invalid vat percent\";\n            setErrors({ ...errors });\n            return;\n        }\n\n\n\n        formData.discount = parseFloat(formData.discount);\n        formData.discount_percent = parseFloat(formData.discount_percent);\n        formData.vat_percent = parseFloat(formData.vat_percent);\n        formData.partial_payment_amount = parseFloat(formData.partial_payment_amount);\n        formData.net_total = parseFloat(netTotal);\n\n        if (cookies.get('store_id')) {\n            formData.store_id = cookies.get('store_id');\n        }\n\n\n        let endPoint = \"/v1/order\";\n        let method = \"POST\";\n        if (formData.id) {\n            endPoint = \"/v1/order/\" + formData.id;\n            method = \"PUT\";\n        }\n\n        const requestOptions = {\n            method: method,\n            headers: {\n                'Accept': 'application/json',\n                \"Content-Type\": \"application/json\",\n                Authorization: cookies.get(\"access_token\"),\n            },\n            body: JSON.stringify(formData),\n        };\n\n        console.log(\"formData:\", formData);\n\n        setProcessing(true);\n        fetch(endPoint, requestOptions)\n            .then(async (response) => {\n                const isJson = response.headers\n                    .get(\"content-type\")\n                    ?.includes(\"application/json\");\n                const data = isJson && (await response.json());\n\n                // check for error response\n                if (!response.ok) {\n                    // get error message from body or default to response status\n                    const error = data && data.errors;\n                    //const error = data.errors\n                    return Promise.reject(error);\n                }\n\n                setErrors({});\n                setProcessing(false);\n\n                console.log(\"Response:\");\n                console.log(data);\n                props.showToastMessage(\"Order Created Successfully!\", \"success\");\n                if (props.refreshList) {\n                    props.refreshList();\n                }\n\n                handleClose();\n                formData.products = [];\n                selectedProducts = [];\n                setSelectedProducts([]);\n                formData.customer_id = \"\";\n                setSelectedCustomers([]);\n                setFormData({ ...formData });\n                reCalculate();\n\n                openDetailsView(data.result.id);\n            })\n            .catch((error) => {\n                setProcessing(false);\n                console.log(\"Inside catch\");\n                console.log(error);\n                setErrors({ ...error });\n                console.error(\"There was an error!\", error);\n                props.showToastMessage(\"Error Creating Order!\", \"danger\");\n            });\n    }\n\n    function getProductIndex(productID) {\n        for (var i = 0; i < selectedProducts.length; i++) {\n            if (selectedProducts[i].product_id === productID) {\n                return i;\n            }\n        }\n        return false;\n    }\n\n\n    function isProductAdded(productID) {\n        for (var i = 0; i < selectedProducts.length; i++) {\n            if (selectedProducts[i].product_id === productID) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    function GetProductStockInStore(storeId, productStores) {\n        if (!productStores) {\n            return 0.0;\n        }\n\n        for (var i = 0; i < productStores.length; i++) {\n            if (productStores[i].store_id === storeId) {\n                return productStores[i].stock;\n            }\n        }\n        return 0.0;\n    }\n\n    function addProduct(product) {\n        console.log(\"Inside Add product\");\n        if (!formData.store_id) {\n            errors.product_id = \"Please Select a Store and try again\";\n            setErrors({ ...errors });\n            return;\n        }\n\n\n        errors.product_id = \"\";\n        if (!product) {\n            errors.product_id = \"Invalid Product\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        /*\n        let productStore = GetProductUnitPriceInStore(\n            formData.store_id,\n            product.stores\n        );\n        */\n        // product.unit_price = productStore.retail_unit_price;\n\n        if (product.product_stores[formData.store_id]) {\n            product.unit_price = product.product_stores[formData.store_id].retail_unit_price;\n        }\n\n\n        errors.unit_price = \"\";\n        if (!product.unit_price) {\n            errors.unit_price = \"Invalid Unit Price\";\n            setErrors({ ...errors });\n            return;\n        }\n\n        let alreadyAdded = false;\n        let index = false;\n        let quantity = 0.00;\n        product.quantity = 1.00;\n\n\n        if (isProductAdded(product.id)) {\n            alreadyAdded = true;\n            index = getProductIndex(product.id);\n            quantity = parseFloat(selectedProducts[index].quantity + product.quantity);\n        } else {\n            quantity = parseFloat(product.quantity);\n        }\n\n        console.log(\"quantity:\", quantity);\n\n        errors.quantity = \"\";\n\n        //let stock = GetProductStockInStore(formData.store_id, product.stores);\n        let stock = 0;\n\n        if (product.product_stores[formData.store_id]) {\n            stock = product.product_stores[formData.store_id].stock;\n        }\n\n        if (stock < quantity) {\n            if (index === false) {\n                index = selectedProducts.length;\n            }\n            // errors[\"quantity_\" + index] = \"Stock is only \" + stock + \" in Store: \" + formData.store_name + \" for product: \" + product.name;\n            errors[\"quantity_\" + index] = \"Warning: Available stock is \" + stock\n            console.log(\"errors:\", errors);\n            setErrors({ ...errors });\n        }\n\n        if (alreadyAdded) {\n            selectedProducts[index].quantity = parseFloat(quantity);\n        }\n\n        if (!alreadyAdded) {\n            selectedProducts.push({\n                product_id: product.id,\n                code: product.item_code,\n                part_number: product.part_number,\n                name: product.name,\n                quantity: product.quantity,\n                product_stores: product.product_stores,\n                unit_price: parseFloat(product.unit_price).toFixed(2),\n                unit: product.unit,\n            });\n        }\n        setSelectedProducts([...selectedProducts]);\n        reCalculate();\n    }\n\n    function removeProduct(product) {\n        const index = selectedProducts.indexOf(product);\n        if (index > -1) {\n            selectedProducts.splice(index, 1);\n        }\n        setSelectedProducts([...selectedProducts]);\n\n        reCalculate();\n    }\n\n    let [totalPrice, setTotalPrice] = useState(0.0);\n\n    function findTotalPrice() {\n        totalPrice = 0.00;\n        for (var i = 0; i < selectedProducts.length; i++) {\n            totalPrice +=\n                parseFloat(selectedProducts[i].unit_price) *\n                parseFloat(selectedProducts[i].quantity);\n        }\n        totalPrice = totalPrice.toFixed(2);\n        setTotalPrice(totalPrice);\n    }\n\n    let [vatPrice, setVatPrice] = useState(0.00);\n\n    function findVatPrice() {\n        vatPrice = 0.00;\n        if (totalPrice > 0) {\n            vatPrice = (parseFloat((parseFloat(formData.vat_percent) / 100)) * (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount))).toFixed(2);;\n            console.log(\"vatPrice:\", vatPrice);\n        }\n        setVatPrice(vatPrice);\n    }\n\n    let [netTotal, setNetTotal] = useState(0.00);\n\n    function findNetTotal() {\n        netTotal = 0.00;\n        if (totalPrice > 0) {\n            netTotal = (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount) + parseFloat(vatPrice)).toFixed(2);\n        }\n        setNetTotal(netTotal);\n\n    }\n\n    let [discountPercent, setDiscountPercent] = useState(0.00);\n\n    function findDiscountPercent() {\n        if (formData.discount >= 0 && totalPrice > 0) {\n            discountPercent = parseFloat(parseFloat(formData.discount / totalPrice) * 100).toFixed(2);\n            setDiscountPercent(discountPercent);\n            formData.discount_percent = discountPercent;\n            setFormData({ ...formData });\n        }\n    }\n\n    function findDiscount() {\n        if (formData.discount_percent >= 0 && totalPrice > 0) {\n            formData.discount = parseFloat(totalPrice * parseFloat(formData.discount_percent / 100)).toFixed(2);\n            setFormData({ ...formData });\n        }\n    }\n\n\n    function reCalculate() {\n        findTotalPrice();\n        if (formData.is_discount_percent) {\n            findDiscount();\n        } else {\n            findDiscountPercent();\n        }\n        findVatPrice();\n        findNetTotal();\n    }\n\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        DetailsViewRef.current.open(id);\n    }\n\n    const StoreCreateFormRef = useRef();\n    function openStoreCreateForm() {\n        StoreCreateFormRef.current.open();\n    }\n\n    const CustomerCreateFormRef = useRef();\n    function openCustomerCreateForm() {\n        CustomerCreateFormRef.current.open();\n    }\n\n    const ProductCreateFormRef = useRef();\n    function openProductCreateForm() {\n        ProductCreateFormRef.current.open();\n    }\n\n\n    const UserCreateFormRef = useRef();\n    function openUserCreateForm() {\n        UserCreateFormRef.current.open();\n    }\n\n\n    const SignatureCreateFormRef = useRef();\n    function openSignatureCreateForm() {\n        SignatureCreateFormRef.current.open();\n    }\n\n\n    const ProductDetailsViewRef = useRef();\n    function openProductDetailsView(id) {\n        ProductDetailsViewRef.current.open(id);\n    }\n\n    function addNewPayment(){\n        formData.payments.push({\n            \"date_str\":new Date(),\n            \"amount\":\"\",\n            \"method\":\"\",\n        });\n        setFormData({ ...formData });\n    }\n\n\n    return (\n        <>\n            {/*\n            <div ref={camref}></div>\n        */}\n\n            {/*\n            <BarcodeScannerComponent\n                width={500}\n                height={500}\n                onUpdate={(err, result) => {\n                    console.log(\"Result:\", result);\n                }}\n            />\n            */}\n\n            <OrderView ref={DetailsViewRef} openCreateForm={props.openCreateForm} />\n            <ProductView ref={ProductDetailsViewRef} />\n            <StoreCreate ref={StoreCreateFormRef} showToastMessage={props.showToastMessage} />\n            <CustomerCreate ref={CustomerCreateFormRef} showToastMessage={props.showToastMessage} />\n            <ProductCreate ref={ProductCreateFormRef} showToastMessage={props.showToastMessage} />\n            <UserCreate ref={UserCreateFormRef} showToastMessage={props.showToastMessage} />\n            <SignatureCreate ref={SignatureCreateFormRef} showToastMessage={props.showToastMessage} />\n\n\n            <Modal show={show} size=\"xl\" fullscreen\n                onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n                <Modal.Header>\n                    <Modal.Title>\n                        {formData.id ? \"Update Sales Order #\" + formData.code : \"Create New Sales Order\"}\n                    </Modal.Title>\n\n                    <div className=\"col align-self-end text-end\">\n                        <OrderPreview />\n                        <Button variant=\"primary\" onClick={handleCreate}>\n                            {isProcessing ? formData.id ? \"Updating....\" : \"Creating..\" : formData.id ? \"Update\" : \"Create\"\n                            }\n                        </Button>\n\n                        <button\n                            type=\"button\"\n                            className=\"btn-close\"\n                            onClick={handleClose}\n                            aria-label=\"Close\"\n                        ></button>\n                    </div>\n                </Modal.Header>\n                <Modal.Body>\n                    {Object.keys(errors).length > 0 ?\n                        <div>\n                            <ul>\n\n                                {errors && Object.keys(errors).map((key, index) => {\n                                    return (errors[key] ? <li style={{ color: \"red\" }}>{errors[key]}</li> : \"\");\n                                })}\n                            </ul></div> : \"\"}\n\n                    <form className=\"row g-3 needs-validation\" onSubmit={e => { e.preventDefault(); handleCreate(e); }} >\n                        {!cookies.get('store_name') ? <div className=\"col-md-6\">\n                            <label className=\"form-label\">Store*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"store_id\"\n                                    labelKey=\"name\"\n                                    isLoading={isStoresLoading}\n                                    isInvalid={errors.store_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.store_id = \"\";\n                                        errors[\"product_id\"] = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.store_id = \"Invalid Store selected\";\n                                            setErrors(errors);\n                                            setFormData({ ...formData });\n                                            setSelectedStores([]);\n                                            return;\n                                        }\n                                        formData.store_id = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        console.log(\"formData.store_id:\", formData.store_id);\n                                        selectedStores = selectedItems;\n                                        setSelectedStores([...selectedItems]);\n\n                                        if (formData.store_id) {\n                                            if (selectedProduct[0] && selectedProduct[0].product_stores && selectedProduct[0].quantity) {\n                                                let stock = 0;\n                                                if (selectedProduct[0].product_stores) {\n                                                    //stock = GetProductStockInStore(formData.store_id, selectedProduct[0].stores);\n                                                    if (selectedProduct[0].product_stores[formData.store_id]) {\n                                                        stock = selectedProduct[0].product_stores[formData.store_id].stock\n                                                    }\n                                                }\n\n                                                if (stock < parseFloat(selectedProduct[0].quantity)) {\n                                                    if (selectedStores[0]) {\n                                                        errors.product_id = \"Stock is only \" + stock + \" in Store: \" + selectedStores[0].name + \" for this product\";\n                                                    } else {\n                                                        errors.product_id = \"Stock is only \" + stock + \" in Selected Store for this product\";\n                                                    }\n\n                                                    setErrors({ ...errors });\n                                                }\n                                            } else if (selectedProduct[0] && selectedProduct[0].product_stores) {\n                                                let stock = 0;\n                                                //stock = GetProductStockInStore(formData.store_id, selectedProduct[0].stores);\n                                                if (selectedProduct[0].product_stores[formData.store_id]) {\n                                                    stock = selectedProduct[0].product_stores[formData.store_id].stock\n                                                }\n\n                                                if (stock === 0) {\n                                                    if (selectedStores[0]) {\n                                                        errors[\"product_id\"] = \"This product is not available in store: \" + selectedStores[0].name;\n                                                    } else {\n                                                        errors[\"product_id\"] = \"This product is not available in selected store.\"\n                                                    }\n                                                    setErrors({ ...errors });\n                                                }\n                                            }\n\n                                            if (selectedProduct[0]) {\n                                                /*\n                                                selectedProduct[0].unit_price = GetProductUnitPriceInStore(\n                                                    formData.store_id,\n                                                    selectedProduct[0].stores\n                                                );\n                                                */\n                                                if (selectedProduct[0].product_stores[formData.store_id]) {\n                                                    selectedProduct[0].unit_price = selectedProduct[0].product_stores[formData.store_id].retail_unit_price;\n                                                }\n\n\n                                                if (!selectedProduct[0].quantity) {\n                                                    selectedProduct[0].quantity = 1;\n                                                }\n                                                setSelectedProduct([...selectedProduct]);\n                                            }\n\n                                        }\n\n                                    }\n                                    }\n                                    options={storeOptions}\n                                    placeholder=\"Select Store\"\n                                    selected={selectedStores}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestStores(searchTerm);\n                                    }}\n                                />\n\n                                <Button hide={true.toString()} onClick={openStoreCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi x-lg\"> </i>\n                                    {errors.store_id}\n                                </div>\n                            </div>\n                        </div> : \"\"}\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Customer*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"customer_id\"\n                                    labelKey=\"search_label\"\n                                    isLoading={isCustomersLoading}\n                                    isInvalid={errors.customer_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.customer_id = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.customer_id = \"Invalid Customer selected\";\n                                            setErrors(errors);\n                                            formData.customer_id = \"\";\n                                            setFormData({ ...formData });\n                                            setSelectedCustomers([]);\n                                            return;\n                                        }\n                                        formData.customer_id = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        setSelectedCustomers(selectedItems);\n                                    }}\n                                    options={customerOptions}\n                                    placeholder=\"Type name or mob\"\n                                    selected={selectedCustomers}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestCustomers(searchTerm);\n                                    }}\n                                />\n                                <Button hide={true.toString()} onClick={openCustomerCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                {errors.customer_id && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.customer_id}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Product Barcode Scan</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DebounceInput\n                                    minLength={3}\n                                    debounceTimeout={100}\n                                    placeholder=\"Scan Barcode\"\n                                    className=\"form-control barcode\"\n                                    value={formData.barcode}\n                                    onChange={event => getProductByBarCode(event.target.value)} />\n                                {errors.bar_code && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.bar_code}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n\n                        <div className=\"col-md-12\">\n                            <label className=\"form-label\">Product Search*</label>\n                            {/*  \n                            <Form.Check\n                                type=\"switch\"\n                                as=\"input\"\n                                id=\"use_laser_scanner\"\n                                label=\"Use Laser Scanner to Read Barcode\"\n                                onChange={(e) => {\n\n                                    formData.useLaserScanner = !formData.useLaserScanner;\n\n                                    if (formData.useLaserScanner) {\n                                        console.log(\"adding keydown event\");\n                                        document.addEventListener(\"keydown\", keyPress);\n                                    } else {\n                                        console.log(\"removing keydown event\");\n                                        document.removeEventListener(\"keydown\", keyPress);\n                                    }\n\n                                    console.log(\"e.target.value:\", formData.useLaserScanner);\n\n                                    setFormData({ ...formData });\n\n                                }}\n                            />\n                            */}\n\n                            <Typeahead\n                                id=\"product_id\"\n                                size=\"lg\"\n                                labelKey=\"search_label\"\n                                emptyLabel=\"\"\n                                clearButton={true}\n                                open={openProductSearchResult}\n                                isLoading={isProductsLoading}\n                                isInvalid={errors.product_id ? true : false}\n                                onChange={(selectedItems) => {\n                                    if (selectedItems.length === 0) {\n                                        errors[\"product_id\"] = \"Invalid Product selected\";\n                                        setErrors(errors);\n                                        return;\n                                    }\n                                    errors[\"product_id\"] = \"\";\n                                    setErrors({ ...errors });\n\n                                    if (formData.store_id) {\n                                        addProduct(selectedItems[0]);\n\n                                    }\n                                    setOpenProductSearchResult(false);\n                                }}\n                                options={productOptions}\n                                selected={selectedProduct}\n                                placeholder=\"Search By Part No. / Name / Name in Arabic\"\n                                highlightOnlyResult={true}\n                                onInputChange={(searchTerm, e) => {\n                                    suggestProducts(searchTerm);\n                                }}\n                            />\n                            <Button hide={true.toString()} onClick={openProductCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                            {errors.product_id ? (\n                                <div style={{ color: \"red\" }}>\n                                    <i className=\"bi bi-x-lg\"> </i>\n                                    {errors.product_id}\n                                </div>\n                            ) : \"\"}\n                        </div>\n\n\n\n                        <div className=\"table-responsive\" style={{ overflowX: \"auto\", maxHeight: \"400px\", overflowY: \"auto\" }}>\n                            <table className=\"table table-striped table-sm table-bordered\">\n                                <thead>\n                                    <tr className=\"text-center\">\n                                        <th style={{ width: \"3%\" }}>Remove</th>\n                                        <th style={{ width: \"5%\" }}>SI No.</th>\n                                        <th style={{ width: \"10%\" }}>Part No.</th>\n                                        <th style={{ width: \"30%\" }} className=\"text-start\">Name</th>\n                                        <th style={{ width: \"15%\" }} >Qty</th>\n                                        <th style={{ width: \"18%\" }}>Unit Price</th>\n                                        <th style={{ width: \"32%\" }}>Price</th>\n\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {selectedProducts.map((product, index) => (\n                                        <tr className=\"text-center\" key={index}>\n                                            <td>\n                                                <div\n                                                    style={{ color: \"red\", cursor: \"pointer\" }}\n                                                    onClick={() => {\n                                                        removeProduct(product);\n                                                    }}\n                                                >\n                                                    <i className=\"bi bi-x-lg\"> </i>\n                                                </div>\n                                            </td>\n                                            <td >{index + 1}</td>\n                                            <td  >{product.part_number}</td>\n                                            <td style={{\n                                                textDecoration: \"underline\",\n                                                color: \"blue\",\n                                                cursor: \"pointer\",\n\n                                            }}\n                                                className=\"text-start\"\n                                                onClick={() => {\n                                                    openProductDetailsView(product.product_id);\n                                                }}>{product.name}\n                                            </td>\n                                            <td >\n\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"number\" value={product.quantity} className=\"form-control text-end\"\n\n                                                        placeholder=\"Quantity\" onChange={(e) => {\n                                                            errors[\"quantity_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n                                                            if (!e.target.value) {\n                                                                errors[\"quantity_\" + index] = \"Invalid Quantity\";\n                                                                selectedProducts[index].quantity = e.target.value;\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            if (e.target.value === 0) {\n                                                                errors[\"quantity_\" + index] = \"Quantity should be > 0\";\n                                                                selectedProducts[index].quantity = e.target.value;\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            product.quantity = parseFloat(e.target.value);\n                                                            selectedProducts[index].quantity = parseFloat(e.target.value);\n                                                            reCalculate();\n\n                                                            let stock = 0;\n                                                            if (selectedProducts[index].product_stores) {\n                                                                stock = selectedProducts[index].product_stores[formData.store_id]?.stock;\n                                                                // stock = GetProductStockInStore(formData.store_id, selectedProducts[index].stores);\n                                                            }\n\n                                                            if (stock < parseFloat(e.target.value) && selectedProducts[index].product_stores) {\n                                                                // errors[\"quantity_\" + index] = \" Warning: Stock is only \" + stock + \" in Store: \" + formData.store_name + \" for this product\";\n                                                                errors[\"quantity_\" + index] = \" Warning: Available stock is \" + stock;\n                                                                setErrors({ ...errors });\n                                                                return;\n                                                            }\n\n                                                            selectedProducts[index].quantity = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].quantity:\", selectedProducts[index].quantity);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                    <span className=\"input-group-text\" id=\"basic-addon2\">{selectedProducts[index].unit ? selectedProducts[index].unit : \"Units\"}</span>\n                                                </div>\n                                                {errors[\"quantity_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        {errors[\"quantity_\" + index]}\n                                                    </div>\n                                                )}\n\n                                            </td>\n                                            <td>\n\n                                                <div className=\"input-group mb-3\">\n                                                    <input type=\"number\" value={product.unit_price} className=\"form-control text-end\"\n\n                                                        placeholder=\"Unit Price\" onChange={(e) => {\n                                                            errors[\"unit_price_\" + index] = \"\";\n                                                            setErrors({ ...errors });\n                                                            if (!e.target.value) {\n                                                                errors[\"unit_price_\" + index] = \"Invalid Unit Price\";\n                                                                selectedProducts[index].unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n                                                            if (e.target.value === 0) {\n                                                                errors[\"unit_price_\" + index] = \"Unit Price should be > 0\";\n                                                                selectedProducts[index].unit_price = parseFloat(e.target.value);\n                                                                setSelectedProducts([...selectedProducts]);\n                                                                setErrors({ ...errors });\n                                                                console.log(\"errors:\", errors);\n                                                                return;\n                                                            }\n\n\n                                                            selectedProducts[index].unit_price = parseFloat(e.target.value);\n                                                            console.log(\"selectedProducts[index].unit_price:\", selectedProducts[index].unit_price);\n                                                            setSelectedProducts([...selectedProducts]);\n                                                            reCalculate();\n\n                                                        }} />\n                                                    <span className=\"input-group-text\" id=\"basic-addon2\">SAR</span>\n                                                </div>\n                                                {errors[\"unit_price_\" + index] && (\n                                                    <div style={{ color: \"red\" }}>\n                                                        <i className=\"bi bi-x-lg\"> </i>\n                                                        {errors[\"unit_price_\" + index]}\n                                                    </div>\n                                                )}\n\n                                            </td>\n                                            <td className=\"text-end\" >\n                                                <NumberFormat\n                                                    value={(product.unit_price * product.quantity).toFixed(2)}\n                                                    displayType={\"text\"}\n                                                    thousandSeparator={true}\n                                                    suffix={\" SAR\"}\n                                                    renderText={(value, props) => value}\n                                                />\n                                            </td>\n                                        </tr>\n                                    )).reverse()}\n                                </tbody>\n                            </table>\n                        </div>\n                        <div className=\"table-responsive\">\n                            <table className=\"table table-striped table-sm table-bordered\">\n                                <tbody>\n                                    <tr>\n\n\n                                        <th colSpan=\"8\" className=\"text-end\">Total</th>\n                                        <td className=\"text-end\" style={{ width: \"200px\" }} >\n                                            <NumberFormat\n                                                value={totalPrice}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\" SAR\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <th colSpan=\"8\" className=\"text-end\">\n                                            Shipping & Handling Fees\n                                        </th>\n                                        <td className=\"text-end\">\n                                            <input type=\"number\" style={{ width: \"150px\" }} className=\"text-start\" value={formData.shipping_handling_fees} onChange={(e) => {\n\n                                                if (parseFloat(e.target.value) === 0) {\n                                                    formData.shipping_handling_fees = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"shipping_handling_fees\"] = \"\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (parseFloat(e.target.value) < 0) {\n                                                    formData.shipping_handling_fees = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"shipping_handling_fees\"] = \"Shipping / Handling Fees should be > 0\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (!e.target.value) {\n                                                    formData.shipping_handling_fees = \"\";\n                                                    errors[\"shipping_handling_fees\"] = \"Invalid Shipping / Handling Fees\";\n                                                    setFormData({ ...formData });\n                                                    setErrors({ ...errors });\n                                                    return;\n                                                }\n\n                                                errors[\"shipping_handling_fees\"] = \"\";\n                                                setErrors({ ...errors });\n\n                                                formData.shipping_handling_fees = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                reCalculate();\n                                            }} />\n                                            {\" SAR\"}\n                                            {errors.shipping_handling_fees && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.shipping_handling_fees}\n                                                </div>\n                                            )}\n                                        </td>\n                                    </tr>\n                                    <tr>\n                                        <th colSpan=\"8\" className=\"text-end\">\n                                            Discount  <input type=\"number\" style={{ width: \"50px\" }} className=\"text-start\" value={formData.discount_percent} onChange={(e) => {\n                                                formData.is_discount_percent = true;\n                                                if (parseFloat(e.target.value) === 0) {\n                                                    formData.discount_percent = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount_percent\"] = \"\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (parseFloat(e.target.value) < 0) {\n                                                    formData.discount_percent = parseFloat(e.target.value);\n                                                    formData.discount = 0.00;\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount_percent\"] = \"Discount percent should be >= 0\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (!e.target.value) {\n                                                    formData.discount_percent = \"\";\n                                                    formData.discount = 0.00;\n                                                    errors[\"discount_percent\"] = \"Invalid Discount Percent\";\n                                                    setFormData({ ...formData });\n                                                    setErrors({ ...errors });\n                                                    return;\n                                                }\n\n                                                errors[\"discount_percent\"] = \"\";\n                                                errors[\"discount\"] = \"\";\n                                                setErrors({ ...errors });\n\n                                                formData.discount_percent = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                reCalculate();\n                                            }} />{\"%\"}\n                                            {errors.discount_percent && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.discount_percent}\n                                                </div>\n                                            )}\n                                        </th>\n                                        <td className=\"text-end\">\n                                            <input type=\"number\" style={{ width: \"150px\" }} className=\"text-start\" value={formData.discount} onChange={(e) => {\n                                                formData.is_discount_percent = false;\n                                                if (parseFloat(e.target.value) === 0) {\n                                                    formData.discount = parseFloat(e.target.value);\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount\"] = \"\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (parseFloat(e.target.value) < 0) {\n                                                    formData.discount = parseFloat(e.target.value);\n                                                    formData.discount_percent = 0.00;\n                                                    setFormData({ ...formData });\n                                                    errors[\"discount\"] = \"Discount should be >= 0\";\n                                                    setErrors({ ...errors });\n                                                    reCalculate();\n                                                    return;\n                                                }\n\n                                                if (!e.target.value) {\n                                                    formData.discount = \"\";\n                                                    formData.discount_percent = 0.00;\n                                                    errors[\"discount\"] = \"Invalid Discount\";\n                                                    setFormData({ ...formData });\n                                                    reCalculate();\n                                                    setErrors({ ...errors });\n                                                    return;\n                                                }\n\n                                                errors[\"discount\"] = \"\";\n                                                errors[\"discount_percent\"] = \"\";\n                                                setErrors({ ...errors });\n\n                                                formData.discount = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                reCalculate();\n                                            }} />\n                                            {\" SAR\"}\n                                            {errors.discount && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.discount}\n                                                </div>\n                                            )}\n                                        </td>\n                                    </tr>\n                                    <tr>\n\n                                        <th colSpan=\"8\" className=\"text-end\"> VAT  <input type=\"number\" className=\"text-center\" style={{ width: \"50px\" }} value={formData.vat_percent} onChange={(e) => {\n                                            console.log(\"Inside onchange vat percent\");\n                                            if (parseFloat(e.target.value) === 0) {\n                                                formData.vat_percent = parseFloat(e.target.value);\n                                                setFormData({ ...formData });\n                                                errors[\"vat_percent\"] = \"\";\n                                                setErrors({ ...errors });\n                                                reCalculate();\n                                                return;\n                                            }\n                                            if (parseFloat(e.target.value) < 0) {\n                                                formData.vat_percent = parseFloat(e.target.value);\n                                                vatPrice = 0.00;\n                                                setVatPrice(vatPrice);\n                                                setFormData({ ...formData });\n                                                errors[\"vat_percent\"] = \"Vat percent should be >= 0\";\n                                                setErrors({ ...errors });\n                                                reCalculate();\n                                                return;\n                                            }\n\n\n                                            if (!e.target.value) {\n                                                formData.vat_percent = \"\";\n                                                vatPrice = 0.00;\n                                                setVatPrice(vatPrice);\n                                                //formData.discount_percent = 0.00;\n                                                errors[\"vat_percent\"] = \"Invalid vat percent\";\n                                                setFormData({ ...formData });\n                                                setErrors({ ...errors });\n                                                return;\n                                            }\n                                            errors[\"vat_percent\"] = \"\";\n                                            setErrors({ ...errors });\n\n                                            formData.vat_percent = e.target.value;\n                                            reCalculate();\n                                            setFormData({ ...formData });\n                                            console.log(formData);\n                                        }} />{\"%\"}\n                                            {errors.vat_percent && (\n                                                <div style={{ color: \"red\" }}>\n                                                    {errors.vat_percent}\n                                                </div>\n                                            )}\n                                        </th>\n                                        <td className=\"text-end\">\n                                            <NumberFormat\n                                                value={vatPrice}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\" SAR\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </td>\n                                    </tr>\n                                    <tr>\n\n                                        <th colSpan=\"8\" className=\"text-end\">Net Total</th>\n                                        <th className=\"text-end\">\n                                            <NumberFormat\n                                                value={netTotal}\n                                                displayType={\"text\"}\n                                                thousandSeparator={true}\n                                                suffix={\" SAR\"}\n                                                renderText={(value, props) => value}\n                                            />\n                                        </th>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n\n                        {/*  \n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Date*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    value={formData.date_str}\n                                    selected={selectedDate}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMM dd yyyy\"\n                                    onChange={(value) => {\n                                        formData.date_str = format(new Date(value), \"MMM dd yyyy\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                                */}\n                        {/*\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">VAT %*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.vat_percent}\n                                    type='number'\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange vat percent\");\n                                        if (isNaN(e.target.value)) {\n                                            errors[\"vat_percent\"] = \"Invalid VAT percentage\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        errors[\"vat_percent\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.vat_percent = e.target.value;\n                                        findVatPrice();\n                                        findNetTotal();\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"validationCustom01\"\n                                    placeholder=\"VAT %\"\n                                    aria-label=\"Select Store\"\n                                    aria-describedby=\"button-addon1\"\n                                />\n                                {errors.vat_percent && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.vat_percent}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                                */}\n                        {/*\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Discount*</label>\n                            <Form.Check\n                                type=\"switch\"\n                                id=\"custom-switch\"\n                                label=\"%\"\n                                value={formData.is_discount_percent}\n                                onChange={(e) => {\n                                    formData.is_discount_percent = !formData.is_discount_percent;\n                                    console.log(\"e.target.value:\", formData.is_discount_percent);\n                                    setFormData({ ...formData });\n                                    reCalculate();\n                                }}\n                            />\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.discountValue}\n                                    type='number'\n                                    onChange={(e) => {\n\n                                        if (parseFloat(e.target.value) === 0) {\n                                            formData.discountValue = parseFloat(e.target.value);\n                                            setFormData({ ...formData });\n                                            errors[\"discount\"] = \"\";\n                                            setErrors({ ...errors });\n                                            reCalculate();\n                                            return;\n                                        }\n\n                                        if (!e.target.value) {\n                                            formData.discountValue = \"\";\n                                            errors[\"discount\"] = \"Invalid Discount\";\n                                            setFormData({ ...formData });\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        errors[\"discount\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.discountValue = e.target.value;\n                                        setFormData({ ...formData });\n                                        reCalculate();\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"validationCustom02\"\n                                    placeholder=\"Discount\"\n                                    aria-label=\"Select Customer\"\n                                    aria-describedby=\"button-addon2\"\n                                />\n                                {errors.discount && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.discount}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                                */}\n\n\n                        {/*  \n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Delivered By*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"delivered_by\"\n                                    labelKey=\"name\"\n                                    isLoading={isDeliveredByUsersLoading}\n                                    isInvalid={errors.delivered_by ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.delivered_by = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.delivered_by = \"Invalid User Selected\";\n                                            setErrors(errors);\n                                            setFormData({ ...formData });\n                                            setSelectedDeliveredByUsers([]);\n                                            return;\n                                        }\n                                        formData.delivered_by = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        setSelectedDeliveredByUsers(selectedItems);\n                                    }}\n                                    options={deliveredByUserOptions}\n                                    placeholder=\"Select User\"\n                                    selected={selectedDeliveredByUsers}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestUsers(searchTerm);\n                                    }}\n                                />\n\n                                <Button hide={true.toString()} onClick={openUserCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                {errors.delivered_by ? (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i> {errors.delivered_by}\n                                    </div>\n                                ) : \"\"}\n                            </div>\n                        </div>\n                                */}\n                        {/*\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">\n                                Delivered By Signature(Optional)\n                            </label>\n\n                            <div className=\"input-group mb-3\">\n                                <Typeahead\n                                    id=\"delivered_by_signature_id\"\n                                    labelKey=\"name\"\n                                    isLoading={isDeliveredBySignaturesLoading}\n                                    isInvalid={errors.delivered_by_signature_id ? true : false}\n                                    onChange={(selectedItems) => {\n                                        errors.delivered_by_signature_id = \"\";\n                                        setErrors(errors);\n                                        if (selectedItems.length === 0) {\n                                            errors.delivered_by_signature_id =\n                                                \"Invalid Signature Selected\";\n                                            setErrors(errors);\n                                            setFormData({ ...formData });\n                                            setSelectedDeliveredBySignatures([]);\n                                            return;\n                                        }\n                                        formData.delivered_by_signature_id = selectedItems[0].id;\n                                        setFormData({ ...formData });\n                                        setSelectedDeliveredBySignatures(selectedItems);\n                                    }}\n                                    options={deliveredBySignatureOptions}\n                                    placeholder=\"Select Signature\"\n                                    selected={selectedDeliveredBySignatures}\n                                    highlightOnlyResult={true}\n                                    onInputChange={(searchTerm, e) => {\n                                        suggestSignatures(searchTerm);\n                                    }}\n                                />\n\n                                <Button hide={true.toString()} onClick={openSignatureCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                                {errors.delivered_by_signature_id ? (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>{\" \"}\n                                        {errors.delivered_by_signature_id}\n                                    </div>\n                                ) : \"\"}\n                            </div>\n                        </div>\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Signature Date(Optional)</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"signature_date_str\"\n                                    value={formData.signature_date_str}\n                                    selected={selectedDate}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMM dd yyyy\"\n                                    onChange={(value) => {\n                                        formData.signature_date_str = format(new Date(value), \"MMM dd yyyy\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.signature_date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.signature_date_str}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                                */}\n                        <h4>Payments Received</h4>\n                        <div class=\"table-responsive\" style={{ maxWidth: \"800px\" }}>\n                            <table class=\"table table-striped table-sm table-bordered\">\n                                <thead>\n                                    <th>\n                                        Date\n                                    </th>\n                                    <th>\n                                        Amount\n                                    </th>\n                                    <th>\n                                        Payment method\n                                    </th>\n                                    <th>\n                                        Action\n                                    </th>\n\n                                </thead>\n                                <tbody>\n                                    {formData.payments &&\n                                        formData.payments.map((payment, key) => (\n                                            <tr key={key}>\n                                                <td style={{ width: \"200px\" }}>\n                                                    <input  value={formData.payments[key].date_str} className=\"form-control\" />\n                                                </td>\n                                                <td style={{ width: \"200px\" }}>\n                                                    <input  type='number' value={formData.payments[key].amount} className=\"form-control \"\n                                                         onChange={(e) => {\n                                                          //  console.log(\"Inside onchange vat discount\");\n                                                            if (!e.target.value) {\n                                                                formData.payments[key].amount = e.target.value;\n                                                                setFormData({ ...formData });\n                                                                //errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n                                                                //setErrors({ ...errors });\n                                                                return;\n                                                            }\n                                                            //formData.partial_payment_amount = parseFloat(e.target.value);\n                                                            formData.payments[key].amount = parseFloat(e.target.value);\n                                                            //errors[\"partial_payment_amount\"] = \"\";\n                    \n                                                            /*\n                                                            if (!formData.id && formData.partial_payment_amount >= netTotal) {\n                                                                errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n                                                                setErrors({ ...errors });\n                                                                return;\n                                                            }*/\n                                                            //setErrors({ ...errors });\n                                                            setFormData({ ...formData });\n                                                            console.log(formData);\n                                                        }}\n                                                    />\n                                                </td>\n                                                <td style={{ width: \"200px\" }}>\n                                                    <select value={formData.payments[key].method} className=\"form-control \"\n                                                       onChange={(e) => {\n                                                        if (!e.target.value) {\n                                                           /* errors[\"payment_method\"] = \"Payment method is required\";\n                                                            setErrors({ ...errors });\n                                                            */\n                                                            formData.payments[key].method = \"\";\n                                                            setFormData({ ...formData });\n                                                            return;\n                                                        }\n                \n                                                       // errors[\"payment_method\"] = \"\";\n                                                        //setErrors({ ...errors });\n                \n                                                        formData.payments[key].method = e.target.value;\n                                                        setFormData({ ...formData });\n                                                        console.log(formData);\n                                                    }}\n                                                    >\n                                                        <option value=\"\">Select</option>\n                                                        <option value=\"cash\">Cash</option>\n                                                        <option value=\"bank_account\">Bank Account / Debit / Credit Card</option>\n                                                        <option value=\"customer_account\">Customer Account</option>\n                                                    </select>\n                                                </td>\n                                                <td style={{ width: \"200px\" }}>\n                                                    {formData.payments.length==(key+1)?<Button variant=\"secondary\"  onClick={addNewPayment}>\n                                                        New payment\n                                                    </Button>:\"\"}\n                                                </td>\n                                            </tr>\n                                             ))}\n                                </tbody>\n                            </table>\n                        </div>\n\n\n                        {!formData.id ? <div className=\"col-md-2\">\n                            <label className=\"form-label\">Payment method*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <select\n                                    value={formData.payment_method}\n                                    disabled={formData.payment_status == \"not_paid\" ? \"disabled\" : \"\"}\n                                    onChange={(e) => {\n                                        if (!e.target.value) {\n                                            errors[\"payment_method\"] = \"Payment method is required\";\n                                            setErrors({ ...errors });\n                                            formData.payment_method = \"\";\n                                            setFormData({ ...formData });\n                                            return;\n                                        }\n\n                                        errors[\"payment_method\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.payment_method = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                >\n                                    <option value=\"\">Select</option>\n                                    <option value=\"cash\">Cash</option>\n                                    <option value=\"bank_account\">Bank Account / Debit / Credit Card</option>\n                                    <option value=\"customer_account\">Customer Account</option>\n                                </select>\n                                {errors.payment_method && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.payment_method}\n                                    </div>\n                                )}\n                            </div>\n                        </div> : \"\"}\n                        {!formData.id ? <div className=\"col-md-2\">\n                            <label className=\"form-label\">Payment Status*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <select\n                                    value={formData.payment_status}\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange payment Status\");\n                                        if (!e.target.value) {\n                                            errors[\"payment_status\"] = \"Payment status is required\";\n                                            formData.payment_status = \"\";\n                                            setFormData({ ...formData });\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n\n                                        errors[\"payment_status\"] = \"\";\n                                        setErrors({ ...errors });\n\n                                        formData.payment_status = e.target.value;\n                                        if (formData.payment_status !== \"paid_partially\") {\n                                            formData.partial_payment_amount = 0.00;\n                                        }\n                                        setFormData({ ...formData });\n\n                                        if (formData.payment_status == \"not_paid\") {\n                                            formData.payment_method = \"\";\n                                            setFormData({ ...formData });\n                                        }\n\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                >\n                                    <option value=\"\">Select</option>\n                                    <option value=\"paid\">Paid</option>\n                                    <option value=\"not_paid\">Not Paid</option>\n                                    <option value=\"paid_partially\">Paid Partially</option>\n                                </select>\n                                {errors.payment_status && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.payment_status}\n                                    </div>\n                                )}\n                            </div>\n                        </div> : \"\"}\n\n\n                        {!formData.id && formData.payment_status === \"paid_partially\" ? <div className=\"col-md-3\">\n                            <label className=\"form-label\">Patial Payment Amount*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    type='number'\n                                    value={formData.partial_payment_amount}\n                                    onChange={(e) => {\n                                        console.log(\"Inside onchange vat discount\");\n                                        if (!e.target.value) {\n                                            formData.partial_payment_amount = e.target.value;\n                                            errors[\"partial_payment_amount\"] = \"Invalid partial payment amount\";\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n                                        formData.partial_payment_amount = parseFloat(e.target.value);\n                                        errors[\"partial_payment_amount\"] = \"\";\n\n                                        if (!formData.id && formData.partial_payment_amount >= netTotal) {\n                                            errors[\"partial_payment_amount\"] = \"Partial payment cannot be >= \" + netTotal;\n                                            setErrors({ ...errors });\n                                            return;\n                                        }\n                                        setErrors({ ...errors });\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"validationCustom02\"\n                                    placeholder=\"Amount\"\n                                />\n                                {errors.partial_payment_amount && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.partial_payment_amount}\n                                    </div>\n                                )}\n                            </div>\n                        </div> : \"\"}\n\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">Date*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    selected={formData.date_str ? new Date(formData.date_str) : null}\n                                    value={formData.date_str ? format(\n                                        new Date(formData.date_str),\n                                        \"MMMM d, yyyy h:mm aa\"\n                                    ) : null}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                    showTimeSelect\n                                    timeIntervals=\"1\"\n                                    onChange={(value) => {\n                                        console.log(\"Value\", value);\n                                        formData.date_str = value;\n                                        // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        {/*\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">ID</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.code ? formData.code : \"\"}\n                                    type='string'\n                                    onChange={(e) => {\n                                        errors[\"code\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.code = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"code\"\n                                    placeholder=\"Code\"\n                                />\n                                {errors.code && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.code}\n                                    </div>\n                                )}\n                                {formData.code && !errors.code && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                                */}\n\n                        <Modal.Footer>\n                            <Button variant=\"secondary\" onClick={handleClose}>\n                                Close\n                            </Button>\n                            <Button variant=\"primary\" onClick={handleCreate}>\n                                {isProcessing ? formData.id ? \"Updating....\" : \"Creating..\" : formData.id ? \"Update\" : \"Create\"\n                                }\n                            </Button>\n                        </Modal.Footer>\n                    </form>\n                </Modal.Body>\n\n            </Modal >\n\n\n        </>\n    );\n});\n\nexport default OrderCreate;\n"]},"metadata":{},"sourceType":"module"}