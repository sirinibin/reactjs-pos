{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _toConsumableArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useState,useEffect,useRef,forwardRef,useImperativeHandle}from\"react\";import QuotationPreview from\"./preview.js\";import{Modal,Button,Form}from\"react-bootstrap\";import StoreCreate from\"../store/create.js\";import CustomerCreate from\"./../customer/create.js\";import ProductCreate from\"./../product/create.js\";import UserCreate from\"./../user/create.js\";import SignatureCreate from\"./../signature/create.js\";import Cookies from\"universal-cookie\";import{Typeahead}from\"react-bootstrap-typeahead\";import NumberFormat from\"react-number-format\";import DatePicker from\"react-datepicker\";import{format}from\"date-fns\";import{Spinner}from\"react-bootstrap\";import QuotationView from\"./view.js\";import ProductView from\"./../product/view.js\";import{DebounceInput}from'react-debounce-input';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var QuotationCreate=/*#__PURE__*/forwardRef(function(props,ref){useImperativeHandle(ref,function(){return{open:function open(id){formData={vat_percent:15.0,discount:0.0,discountValue:0.0,discount_percent:0.0,shipping_handling_fees:0.00,is_discount_percent:false,date_str:format(new Date(),\"MMM dd yyyy\"),signature_date_str:format(new Date(),\"MMM dd yyyy\"),status:\"delivered\",price_type:\"retail\"};selectedProducts=[];setSelectedProducts([]);selectedStores=[];setSelectedStores([]);selectedCustomers=[];setSelectedCustomers([]);selectedDeliveredByUsers=[];setSelectedDeliveredByUsers([]);selectedDeliveredBySignatures=[];setSelectedDeliveredBySignatures([]);reCalculate();if(cookies.get(\"user_id\")){selectedDeliveredByUsers=[{id:cookies.get(\"user_id\"),name:cookies.get(\"user_name\")}];formData.delivered_by=cookies.get(\"user_id\");setFormData(_objectSpread({},formData));setSelectedDeliveredByUsers(_toConsumableArray(selectedDeliveredByUsers));}if(cookies.get('store_id')){formData.store_id=cookies.get('store_id');formData.store_name=cookies.get('store_name');}setFormData(_objectSpread({},formData));if(id){getQuotation(id);}SetShow(true);}};});useEffect(function(){var listener=function listener(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){console.log(\"Enter key was pressed. Run your function-order.123\");// event.preventDefault();\nvar form=event.target.form;if(form&&event.target){var index=Array.prototype.indexOf.call(form,event.target);if(form&&form.elements[index+1]){if(event.target.getAttribute(\"class\").includes(\"barcode\")){form.elements[index].focus();}else{form.elements[index+1].focus();}event.preventDefault();}}}};document.addEventListener(\"keydown\",listener);return function(){document.removeEventListener(\"keydown\",listener);};},[]);var selectedDate=new Date();//const history = useHistory();\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isProcessing=_useState4[0],setProcessing=_useState4[1];var cookies=new Cookies();//fields\nvar _useState5=useState({vat_percent:15.0,discount:0.0,discountValue:0.0,discount_percent:0.0,date_str:format(new Date(),\"MMM dd yyyy\"),signature_date_str:format(new Date(),\"MMM dd yyyy\"),status:\"created\",price_type:\"retail\",is_discount_percent:false}),_useState6=_slicedToArray(_useState5,2),formData=_useState6[0],setFormData=_useState6[1];//Store Auto Suggestion\nvar _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),storeOptions=_useState8[0],setStoreOptions=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),selectedStores=_useState10[0],setSelectedStores=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isStoresLoading=_useState12[0],setIsStoresLoading=_useState12[1];//Customer Auto Suggestion\nvar _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),customerOptions=_useState14[0],setCustomerOptions=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),selectedCustomers=_useState16[0],setSelectedCustomers=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isCustomersLoading=_useState18[0],setIsCustomersLoading=_useState18[1];//Product Auto Suggestion\nvar _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),productOptions=_useState20[0],setProductOptions=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),selectedProduct=_useState22[0],setSelectedProduct=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),selectedProducts=_useState24[0],setSelectedProducts=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),isProductsLoading=_useState26[0],setIsProductsLoading=_useState26[1];//Delivered By Auto Suggestion\nvar _useState27=useState([]),_useState28=_slicedToArray(_useState27,2),deliveredByUserOptions=_useState28[0],setDeliveredByUserOptions=_useState28[1];var _useState29=useState([]),_useState30=_slicedToArray(_useState29,2),selectedDeliveredByUsers=_useState30[0],setSelectedDeliveredByUsers=_useState30[1];var _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),isDeliveredByUsersLoading=_useState32[0],setIsDeliveredByUsersLoading=_useState32[1];//Delivered By Signature Auto Suggestion\nvar _useState33=useState([]),_useState34=_slicedToArray(_useState33,2),deliveredBySignatureOptions=_useState34[0],setDeliveredBySignatureOptions=_useState34[1];var _useState35=useState([]),_useState36=_slicedToArray(_useState35,2),selectedDeliveredBySignatures=_useState36[0],setSelectedDeliveredBySignatures=_useState36[1];var _useState37=useState(false),_useState38=_slicedToArray(_useState37,2),isDeliveredBySignaturesLoading=_useState38[0],setIsDeliveredBySignaturesLoading=_useState38[1];var _useState39=useState(false),_useState40=_slicedToArray(_useState39,2),show=_useState40[0],SetShow=_useState40[1];function handleClose(){SetShow(false);}useEffect(function(){var at=cookies.get(\"access_token\");if(!at){// history.push(\"/dashboard/quotations\");\nwindow.location=\"/\";}});function getQuotation(id){console.log(\"inside get Quotation\");var requestOptions={method:'GET',headers:{'Content-Type':'application/json','Authorization':cookies.get('access_token')}};fetch('/v1/quotation/'+id,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var _response$headers$get;var isJson,data,error,quotation,selectedStores,selectedCustomers,selectedDeliveredByUsers,_selectedDeliveredBySignatures;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isJson=(_response$headers$get=response.headers.get('content-type'))===null||_response$headers$get===void 0?void 0:_response$headers$get.includes('application/json');_context.t0=isJson;if(!_context.t0){_context.next=6;break;}_context.next=5;return response.json();case 5:_context.t0=_context.sent;case 6:data=_context.t0;if(response.ok){_context.next=10;break;}error=data&&data.errors;return _context.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});console.log(\"Response:\");console.log(data);quotation=data.result;formData={id:quotation.id,code:quotation.code,store_id:quotation.store_id,customer_id:quotation.customer_id,// date_str: quotation.date_str,\ndate:quotation.date,vat_percent:quotation.vat_percent,discount:quotation.discount,discount_percent:quotation.discount_percent,status:quotation.status,delivered_by:quotation.delivered_by,delivered_by_signature_id:quotation.delivered_by_signature_id,is_discount_percent:quotation.is_discount_percent,shipping_handling_fees:quotation.shipping_handling_fees};formData.date_str=data.result.date;if(formData.is_discount_percent){formData.discountValue=formData.discount_percent;}else{formData.discountValue=formData.discount;}selectedProducts=quotation.products;setSelectedProducts(_toConsumableArray(selectedProducts));selectedStores=[{id:quotation.store_id,name:quotation.store_name}];selectedCustomers=[{id:quotation.customer_id,name:quotation.customer_name,search_label:quotation.customer_name}];selectedDeliveredByUsers=[{id:quotation.delivered_by,name:quotation.delivered_by_name}];if(quotation.delivered_by_signature_id){_selectedDeliveredBySignatures=[{id:quotation.delivered_by_signature_id,name:quotation.delivered_by_signature_name}];setSelectedDeliveredBySignatures([].concat(_selectedDeliveredBySignatures));}setSelectedDeliveredByUsers([].concat(selectedDeliveredByUsers));setSelectedStores([].concat(selectedStores));setSelectedCustomers([].concat(selectedCustomers));setFormData(_objectSpread({},formData));reCalculate();case 28:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function ObjectToSearchQueryParams(object){return Object.keys(object).map(function(key){return\"search[\".concat(key,\"]=\")+encodeURIComponent(object[key]);}).join(\"&\");}function suggestStores(_x2){return _suggestStores.apply(this,arguments);}function _suggestStores(){_suggestStores=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Inside handle suggestStores\");setStoreOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context3.next=5;break;}return _context3.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";setIsStoresLoading(true);_context3.next=13;return fetch(\"/v1/store?\"+Select+queryString,requestOptions);case 13:result=_context3.sent;_context3.next=16;return result.json();case 16:data=_context3.sent;setStoreOptions(data.result);setIsStoresLoading(false);case 19:case\"end\":return _context3.stop();}}},_callee3);}));return _suggestStores.apply(this,arguments);}function suggestCustomers(_x3){return _suggestCustomers.apply(this,arguments);}function _suggestCustomers(){_suggestCustomers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"Inside handle suggestCustomers\");setCustomerOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context4.next=5;break;}return _context4.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name,phone,name_in_arabic,phone_in_arabic,search_label\";setIsCustomersLoading(true);_context4.next=13;return fetch(\"/v1/customer?\"+Select+queryString,requestOptions);case 13:result=_context4.sent;_context4.next=16;return result.json();case 16:data=_context4.sent;setCustomerOptions(data.result);setIsCustomersLoading(false);case 19:case\"end\":return _context4.stop();}}},_callee4);}));return _suggestCustomers.apply(this,arguments);}function GetProductUnitPriceInStore(storeId,productStores){if(!productStores){return\"\";}for(var i=0;i<productStores.length;i++){console.log(\"productStores[i]:\",productStores[i]);console.log(\"store_id:\",storeId);if(productStores[i].store_id===storeId){console.log(\"macthed\");console.log(\"productStores[i].retail_unit_price:\",productStores[i].retail_unit_price);return productStores[i];}}console.log(\"not matched\");return\"\";}function GetProductPurchaseUnitPriceInStore(storeId,unitPriceListArray){if(!unitPriceListArray){return\"\";}for(var i=0;i<unitPriceListArray.length;i++){console.log(\"unitPriceListArray[i]:\",unitPriceListArray[i]);console.log(\"store_id:\",storeId);if(unitPriceListArray[i].store_id===storeId){return unitPriceListArray[i].purchase_unit_price;}else{console.log(\"not matched\");}}return\"\";}var _useState41=useState(false),_useState42=_slicedToArray(_useState41,2),openProductSearchResult=_useState42[0],setOpenProductSearchResult=_useState42[1];function suggestProducts(_x4){return _suggestProducts.apply(this,arguments);}function _suggestProducts(){_suggestProducts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(searchTerm){var params,queryString,requestOptions,Select,result,data,products;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log(\"Inside handle suggestProducts\");setProductOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context5.next=8;break;}openProductSearchResult=false;setOpenProductSearchResult(false);setIsProductsLoading(false);return _context5.abrupt(\"return\");case 8:params={name:searchTerm};if(cookies.get(\"store_id\")){params.store_id=cookies.get(\"store_id\");}queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,item_code,bar_code,name,stores,unit,part_number,name_in_arabic\";setIsProductsLoading(true);_context5.next=17;return fetch(\"/v1/product?\"+Select+queryString+\"&limit=200\",requestOptions);case 17:result=_context5.sent;_context5.next=20;return result.json();case 20:data=_context5.sent;products=data.result;if(!(!products||products.length===0)){_context5.next=27;break;}openProductSearchResult=false;setOpenProductSearchResult(false);setIsProductsLoading(false);return _context5.abrupt(\"return\");case 27:openProductSearchResult=true;setOpenProductSearchResult(true);setProductOptions(products);setIsProductsLoading(false);case 31:case\"end\":return _context5.stop();}}},_callee5);}));return _suggestProducts.apply(this,arguments);}function getProductByBarCode(_x5){return _getProductByBarCode.apply(this,arguments);}function _getProductByBarCode(){_getProductByBarCode=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(barcode){var requestOptions,Select,result,data,product;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:formData.barcode=barcode;setFormData(_objectSpread({},formData));console.log(\"Inside getProductByBarCode\");errors[\"bar_code\"]=\"\";setErrors(_objectSpread({},errors));console.log(\"barcode:\"+formData.barcode);if(formData.barcode){_context6.next=8;break;}return _context6.abrupt(\"return\");case 8:if(formData.barcode.length===13){formData.barcode=formData.barcode.slice(0,-1);}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,item_code,bar_code,ean_12,part_number,name,stores,unit,part_number,name_in_arabic\";_context6.next=13;return fetch(\"/v1/product/barcode/\"+formData.barcode+\"?\"+Select,requestOptions);case 13:result=_context6.sent;_context6.next=16;return result.json();case 16:data=_context6.sent;product=data.result;if(product){addProduct(product);}else{errors[\"bar_code\"]=\"Invalid Barcode:\"+formData.barcode;setErrors(_objectSpread({},errors));}formData.barcode=\"\";setFormData(_objectSpread({},formData));case 21:case\"end\":return _context6.stop();}}},_callee6);}));return _getProductByBarCode.apply(this,arguments);}function suggestUsers(_x6){return _suggestUsers.apply(this,arguments);}function _suggestUsers(){_suggestUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:console.log(\"Inside handle suggestUsers\");setDeliveredByUserOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context7.next=5;break;}return _context7.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";setIsDeliveredByUsersLoading(true);_context7.next=13;return fetch(\"/v1/user?\"+Select+queryString,requestOptions);case 13:result=_context7.sent;_context7.next=16;return result.json();case 16:data=_context7.sent;setDeliveredByUserOptions(data.result);setIsDeliveredByUsersLoading(false);case 19:case\"end\":return _context7.stop();}}},_callee7);}));return _suggestUsers.apply(this,arguments);}function suggestSignatures(_x7){return _suggestSignatures.apply(this,arguments);}function _suggestSignatures(){_suggestSignatures=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:console.log(\"Inside handle suggestSignatures\");setDeliveredBySignatureOptions([]);console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context8.next=5;break;}return _context8.abrupt(\"return\");case 5:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";setIsDeliveredBySignaturesLoading(true);_context8.next=13;return fetch(\"/v1/signature?\"+Select+queryString,requestOptions);case 13:result=_context8.sent;_context8.next=16;return result.json();case 16:data=_context8.sent;setDeliveredBySignatureOptions(data.result);setIsDeliveredBySignaturesLoading(false);case 19:case\"end\":return _context8.stop();}}},_callee8);}));return _suggestSignatures.apply(this,arguments);}function handleCreate(event){event.preventDefault();console.log(\"Inside handle Create\");console.log(\"selectedProducts:\",selectedProducts);formData.products=[];for(var i=0;i<selectedProducts.length;i++){formData.products.push({product_id:selectedProducts[i].product_id,name:selectedProducts[i].name,name_in_arabic:selectedProducts[i].name_in_arabic,quantity:parseFloat(selectedProducts[i].quantity),unit_price:parseFloat(selectedProducts[i].unit_price),purchase_unit_price:parseFloat(selectedProducts[i].purchase_unit_price),unit:selectedProducts[i].unit,part_number:selectedProducts[i].part_number});}formData.discount=parseFloat(formData.discount);formData.discount_percent=parseFloat(formData.discount_percent);formData.vat_percent=parseFloat(formData.vat_percent);if(cookies.get('store_id')){formData.store_id=cookies.get('store_id');}console.log(\"formData.discount:\",formData.discount);var endPoint=\"/v1/quotation\";var method=\"POST\";if(formData.id){endPoint=\"/v1/quotation/\"+formData.id;method=\"PUT\";}var requestOptions={method:method,headers:{'Accept':'application/json',\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")},body:JSON.stringify(formData)};console.log(\"formData:\",formData);setProcessing(true);fetch(endPoint,requestOptions).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var _response$headers$get2;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isJson=(_response$headers$get2=response.headers.get(\"content-type\"))===null||_response$headers$get2===void 0?void 0:_response$headers$get2.includes(\"application/json\");_context2.t0=isJson;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return response.json();case 5:_context2.t0=_context2.sent;case 6:data=_context2.t0;if(response.ok){_context2.next=10;break;}// get error message from body or default to response status\nerror=data&&data.errors;//const error = data.errors\nreturn _context2.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});setProcessing(false);console.log(\"Response:\");console.log(data);props.showToastMessage(\"Quotation Created Successfully!\",\"success\");if(props.refreshList){props.refreshList();}handleClose();props.openDetailsView(data.result.id);case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x8){return _ref2.apply(this,arguments);};}()).catch(function(error){setProcessing(false);console.log(\"Inside catch\");console.log(error);setErrors(_objectSpread({},error));console.error(\"There was an error!\",error);props.showToastMessage(\"Error Creating Quotation!\",\"danger\");});}function isProductAdded(productID){for(var i=0;i<selectedProducts.length;i++){if(selectedProducts[i].product_id===productID){return true;}}return false;}function addProduct(product){console.log(\"Inside Add product\");if(!formData.store_id){errors.product_id=\"Please Select a Store and try again\";setErrors(_objectSpread({},errors));return;}errors.product_id=\"\";if(!product){errors.product_id=\"Invalid Product\";setErrors(_objectSpread({},errors));return;}var unitPrice=GetProductUnitPriceInStore(formData.store_id,product.stores);product.unit_price=unitPrice.retail_unit_price;product.purchase_unit_price=unitPrice.purchase_unit_price;var alreadyAdded=false;var index=-1;var quantity=0.00;product.quantity=1.00;if(isProductAdded(product.id)){alreadyAdded=true;index=getProductIndex(product.id);quantity=parseFloat(selectedProducts[index].quantity+product.quantity);}else{quantity=parseFloat(product.quantity);}console.log(\"quantity:\",quantity);errors.quantity=\"\";if(alreadyAdded){selectedProducts[index].quantity=parseFloat(quantity);}if(!alreadyAdded){var item={product_id:product.id,code:product.item_code,part_number:product.part_number,name:product.name,quantity:product.quantity,stores:product.stores,unit:product.unit};if(product.unit_price){item.unit_price=parseFloat(product.unit_price);console.log(\"item.unit_price:\",item.unit_price);}if(product.purchase_unit_price){item.purchase_unit_price=parseFloat(product.purchase_unit_price);console.log(\"item.purchase_unit_price\",item.purchase_unit_price);}selectedProducts.push(item);}console.log(\"selectedProducts:\",selectedProducts);setSelectedProducts(_toConsumableArray(selectedProducts));reCalculate();}function getProductIndex(productID){for(var i=0;i<selectedProducts.length;i++){if(selectedProducts[i].product_id===productID){return i;}}return false;}function removeProduct(product){var index=selectedProducts.indexOf(product);if(index>-1){selectedProducts.splice(index,1);}setSelectedProducts(_toConsumableArray(selectedProducts));reCalculate();}var _useState43=useState(0.0),_useState44=_slicedToArray(_useState43,2),totalPrice=_useState44[0],setTotalPrice=_useState44[1];function findTotalPrice(){totalPrice=0.00;for(var i=0;i<selectedProducts.length;i++){totalPrice+=parseFloat(selectedProducts[i].unit_price)*parseFloat(selectedProducts[i].quantity);}totalPrice=totalPrice.toFixed(2);setTotalPrice(totalPrice);}var _useState45=useState(0.00),_useState46=_slicedToArray(_useState45,2),vatPrice=_useState46[0],setVatPrice=_useState46[1];function findVatPrice(){vatPrice=0.00;if(totalPrice>0){vatPrice=(parseFloat(parseFloat(formData.vat_percent)/100)*(parseFloat(totalPrice)+parseFloat(formData.shipping_handling_fees)-parseFloat(formData.discount))).toFixed(2);;console.log(\"vatPrice:\",vatPrice);}setVatPrice(vatPrice);}var _useState47=useState(0.00),_useState48=_slicedToArray(_useState47,2),netTotal=_useState48[0],setNetTotal=_useState48[1];function findNetTotal(){netTotal=0.00;if(totalPrice>0){netTotal=(parseFloat(totalPrice)+parseFloat(formData.shipping_handling_fees)-parseFloat(formData.discount)+parseFloat(vatPrice)).toFixed(2);}setNetTotal(netTotal);}var _useState49=useState(0.00),_useState50=_slicedToArray(_useState49,2),discountPercent=_useState50[0],setDiscountPercent=_useState50[1];function findDiscountPercent(){if(formData.discount>=0&&totalPrice>0){discountPercent=parseFloat(parseFloat(formData.discount/totalPrice)*100).toFixed(2);setDiscountPercent(discountPercent);formData.discount_percent=discountPercent;setFormData(_objectSpread({},formData));}}function findDiscount(){if(formData.discount_percent>=0&&totalPrice>0){formData.discount=parseFloat(totalPrice*parseFloat(formData.discount_percent/100)).toFixed(2);setFormData(_objectSpread({},formData));}}function reCalculate(){findTotalPrice();if(formData.is_discount_percent){findDiscount();}else{findDiscountPercent();}findVatPrice();findNetTotal();}var StoreCreateFormRef=useRef();function openStoreCreateForm(){StoreCreateFormRef.current.open();}var CustomerCreateFormRef=useRef();function openCustomerCreateForm(){CustomerCreateFormRef.current.open();}var ProductCreateFormRef=useRef();function openProductCreateForm(){ProductCreateFormRef.current.open();}function openProductUpdateForm(id){ProductCreateFormRef.current.open(id);}var UserCreateFormRef=useRef();function openUserCreateForm(){UserCreateFormRef.current.open();}var SignatureCreateFormRef=useRef();function openSignatureCreateForm(){SignatureCreateFormRef.current.open();}var ProductDetailsViewRef=useRef();function openProductDetailsView(id){ProductDetailsViewRef.current.open(id);}var PreviewRef=useRef();function openPreview(){var model={};model=JSON.parse(JSON.stringify(formData));model.products=selectedProducts;model.net_total=netTotal;model.vat_price=vatPrice;model.total=totalPrice;//setFormData({ ...formData });\nPreviewRef.current.open(model);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ProductView,{ref:ProductDetailsViewRef,openUpdateForm:openProductUpdateForm,openCreateForm:openProductCreateForm}),/*#__PURE__*/_jsx(ProductCreate,{ref:ProductCreateFormRef,showToastMessage:props.showToastMessage,openDetailsView:openProductDetailsView}),/*#__PURE__*/_jsx(QuotationPreview,{ref:PreviewRef}),/*#__PURE__*/_jsx(StoreCreate,{ref:StoreCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(CustomerCreate,{ref:CustomerCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(UserCreate,{ref:UserCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(SignatureCreate,{ref:SignatureCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsxs(Modal,{show:show,size:\"xl\",fullscreen:true,onHide:handleClose,animation:false,backdrop:\"static\",scrollable:true,children:[/*#__PURE__*/_jsxs(Modal.Header,{children:[/*#__PURE__*/_jsx(Modal.Title,{children:formData.id?\"Update Quotation #\"+formData.code:\"Create New Quotation\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"col align-self-end text-end\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:openPreview,children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-display\"}),\" Preview\"]}),\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:openPreview,children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-display\"}),\" Preview\"]}),\"\\xA0\\xA0 \\xA0\\xA0 \\xA0\\xA0\",formData.id?/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:function onClick(){handleClose();props.openDetailsView(formData.id);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-eye\"}),\" View Detail\"]}):\"\",\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreate,children:[isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":\"\",formData.id?\"Update\":\"Create\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:handleClose,\"aria-label\":\"Close\"})]})]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 needs-validation\",onSubmit:handleCreate,children:[!cookies.get('store_name')?/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Store*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(Typeahead,{id:\"store_id\",labelKey:\"name\",isLoading:isStoresLoading,isInvalid:errors.store_id?true:false,onChange:function onChange(selectedItems){errors.store_id=\"\";setErrors(errors);if(selectedItems.length===0){errors.store_id=\"Invalid Store selected\";setErrors(errors);formData.store_id=\"\";setFormData(_objectSpread({},formData));setSelectedStores([]);return;}formData.store_id=selectedItems[0].id;setFormData(_objectSpread({},formData));setSelectedStores(selectedItems);//SetPriceOfAllProducts(selectedItems[0].id);\n},options:storeOptions,placeholder:\"Select Store\",selected:selectedStores,highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestStores(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:openStoreCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi x-lg\",children:\" \"}),errors.store_id]}),formData.store_id&&!errors.store_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}):\"\",/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Customer*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(Typeahead,{id:\"customer_id\",labelKey:\"search_label\",isLoading:isCustomersLoading,isInvalid:errors.customer_id?true:false,onChange:function onChange(selectedItems){errors.customer_id=\"\";setErrors(errors);if(selectedItems.length===0){errors.customer_id=\"Invalid Customer selected\";setErrors(errors);formData.customer_id=\"\";setFormData(_objectSpread({},formData));setSelectedCustomers([]);return;}formData.customer_id=selectedItems[0].id;setFormData(_objectSpread({},formData));setSelectedCustomers(selectedItems);},options:customerOptions,placeholder:\"Type name or mob\",selected:selectedCustomers,highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestCustomers(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:openCustomerCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),errors.customer_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.customer_id]}),formData.customer_id&&!errors.customer_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Product Barcode Scan\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(DebounceInput,{minLength:3,debounceTimeout:500,placeholder:\"Scan Barcode\",className:\"form-control barcode\",value:formData.barcode,onChange:function onChange(event){return getProductByBarCode(event.target.value);}}),errors.bar_code&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.bar_code]}),formData.bar_code&&!errors.bar_code&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Product*\"}),/*#__PURE__*/_jsx(Typeahead,{id:\"product_id\",size:\"lg\",labelKey:\"search_label\",emptyLabel:\"\",clearButton:true,open:openProductSearchResult,isLoading:isProductsLoading,isInvalid:errors.product_id?true:false,onChange:function onChange(selectedItems){if(selectedItems.length===0){errors[\"product_id\"]=\"Invalid Product selected\";setErrors(errors);return;}errors[\"product_id\"]=\"\";setErrors(_objectSpread({},errors));if(formData.store_id){addProduct(selectedItems[0]);}setOpenProductSearchResult(false);},options:productOptions,selected:selectedProduct,placeholder:\"Search By Part No. / Name / Name in Arabic\",highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestProducts(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:openProductCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),errors.product_id?/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.product_id]}):null,selectedProduct[0]&&selectedProduct[0].id&&!errors.product_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",style:{overflowX:\"auto\",maxHeight:\"400px\",overflowY:\"auto\"},children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped table-sm table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"th\",{style:{width:\"3%\"},children:\"Remove\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"5%\"},children:\"SI No.\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"10%\"},children:\"Part No.\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"34%\"},className:\"text-start\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"11%\"},children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"11%\"},children:\"Purchase Unit Price\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"11%\"},children:\"Unit Price\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:\"15%\"},children:\"Price\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:selectedProducts.map(function(product,index){return/*#__PURE__*/_jsxs(\"tr\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\",cursor:\"pointer\"},onClick:function onClick(){removeProduct(product);},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"})})}),/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:product.part_number}),/*#__PURE__*/_jsx(\"td\",{style:{textDecoration:\"underline\",color:\"blue\",cursor:\"pointer\"},className:\"text-start\",onClick:function onClick(){openProductDetailsView(product.product_id);console.log(\"okk,id:\",product.product_id);},children:product.name}),/*#__PURE__*/_jsxs(\"td\",{style:{width:\"155px\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:product.quantity,className:\"form-control\",placeholder:\"Quantity\",onChange:function onChange(e){errors[\"quantity_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){errors[\"quantity_\"+index]=\"Invalid Quantity\";selectedProducts[index].quantity=e.target.value;setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));console.log(\"errors:\",errors);return;}if(parseFloat(e.target.value)===0){errors[\"quantity_\"+index]=\"Quantity should be > 0\";selectedProducts[index].quantity=e.target.value;setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));console.log(\"errors:\",errors);return;}product.quantity=parseFloat(e.target.value);reCalculate();selectedProducts[index].quantity=parseFloat(e.target.value);console.log(\"selectedProducts[index].quantity:\",selectedProducts[index].quantity);setSelectedProducts(_toConsumableArray(selectedProducts));reCalculate();}}),/*#__PURE__*/_jsxs(\"span\",{className:\"input-group-text\",id:\"basic-addon2\",children:[\" \",selectedProducts[index].unit?selectedProducts[index].unit:\"Units\"]})]}),errors[\"quantity_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"quantity_\"+index]]})]}),/*#__PURE__*/_jsx(\"td\",{style:{width:\"150px\"},children:product.purchase_unit_price?/*#__PURE__*/_jsx(NumberFormat,{value:product.purchase_unit_price.toFixed(2),displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}}):\"\"}),/*#__PURE__*/_jsxs(\"td\",{style:{width:\"180px\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:product.unit_price,className:\"form-control\",placeholder:\"Unit Price\",onChange:function onChange(e){errors[\"unit_price_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){errors[\"unit_price_\"+index]=\"Invalid Unit Price\";selectedProducts[index].unit_price=parseFloat(e.target.value);setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));console.log(\"errors:\",errors);return;}if(parseFloat(e.target.value)===0){errors[\"unit_price_\"+index]=\"Unit Price shoudl be > 0\";selectedProducts[index].unit_price=parseFloat(e.target.value);setSelectedProducts(_toConsumableArray(selectedProducts));setErrors(_objectSpread({},errors));console.log(\"errors:\",errors);return;}selectedProducts[index].unit_price=parseFloat(e.target.value);console.log(\"selectedProducts[index].unit_price:\",selectedProducts[index].unit_price);setSelectedProducts(_toConsumableArray(selectedProducts));reCalculate();}}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text\",id:\"basic-addon2\",children:\"SAR\"})]}),errors[\"unit_price_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"unit_price_\"+index]]})]}),/*#__PURE__*/_jsx(\"td\",{className:\"text-end\",children:/*#__PURE__*/_jsx(NumberFormat,{value:(product.unit_price*product.quantity).toFixed(2),displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]},index);}).reverse()})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsx(\"table\",{className:\"table table-striped table-sm table-bordered\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{colSpan:\"8\",className:\"text-end\",children:\"Total\"}),/*#__PURE__*/_jsx(\"td\",{className:\"text-end\",style:{width:\"200px\"},children:/*#__PURE__*/_jsx(NumberFormat,{value:totalPrice,displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{colSpan:\"8\",className:\"text-end\",children:\"Shipping & Handling Fees\"}),/*#__PURE__*/_jsxs(\"td\",{className:\"text-end\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",style:{width:\"150px\"},className:\"text-start\",value:formData.shipping_handling_fees,onChange:function onChange(e){if(parseFloat(e.target.value)===0){formData.shipping_handling_fees=parseFloat(e.target.value);setFormData(_objectSpread({},formData));errors[\"shipping_handling_fees\"]=\"\";setErrors(_objectSpread({},errors));reCalculate();return;}if(parseFloat(e.target.value)<0){formData.shipping_handling_fees=parseFloat(e.target.value);setFormData(_objectSpread({},formData));errors[\"shipping_handling_fees\"]=\"Shipping / Handling Fees should be > 0\";setErrors(_objectSpread({},errors));reCalculate();return;}if(!e.target.value){formData.shipping_handling_fees=\"\";errors[\"shipping_handling_fees\"]=\"Invalid Shipping / Handling Fees\";setFormData(_objectSpread({},formData));setErrors(_objectSpread({},errors));return;}errors[\"shipping_handling_fees\"]=\"\";setErrors(_objectSpread({},errors));formData.shipping_handling_fees=parseFloat(e.target.value);setFormData(_objectSpread({},formData));reCalculate();}}),\" SAR\",errors.shipping_handling_fees&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\"},children:errors.shipping_handling_fees})]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"th\",{colSpan:\"8\",className:\"text-end\",children:[\"Discount  \",/*#__PURE__*/_jsx(\"input\",{type:\"number\",style:{width:\"50px\"},className:\"text-start\",value:formData.discount_percent,onChange:function onChange(e){formData.is_discount_percent=true;if(parseFloat(e.target.value)===0){formData.discount_percent=parseFloat(e.target.value);setFormData(_objectSpread({},formData));errors[\"discount_percent\"]=\"\";setErrors(_objectSpread({},errors));reCalculate();return;}if(parseFloat(e.target.value)<0){formData.discount_percent=parseFloat(e.target.value);formData.discount=0.00;setFormData(_objectSpread({},formData));errors[\"discount_percent\"]=\"Discount percent should be >= 0\";setErrors(_objectSpread({},errors));reCalculate();return;}if(!e.target.value){formData.discount_percent=\"\";formData.discount=0.00;errors[\"discount_percent\"]=\"Invalid Discount Percent\";setFormData(_objectSpread({},formData));setErrors(_objectSpread({},errors));return;}errors[\"discount_percent\"]=\"\";errors[\"discount\"]=\"\";setErrors(_objectSpread({},errors));formData.discount_percent=parseFloat(e.target.value);setFormData(_objectSpread({},formData));reCalculate();}}),\"%\",errors.discount_percent&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\"},children:errors.discount_percent})]}),/*#__PURE__*/_jsxs(\"td\",{className:\"text-end\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",style:{width:\"150px\"},className:\"text-start\",value:formData.discount,onChange:function onChange(e){formData.is_discount_percent=false;if(parseFloat(e.target.value)===0){formData.discount=parseFloat(e.target.value);setFormData(_objectSpread({},formData));errors[\"discount\"]=\"\";setErrors(_objectSpread({},errors));reCalculate();return;}if(parseFloat(e.target.value)<0){formData.discount=parseFloat(e.target.value);formData.discount_percent=0.00;setFormData(_objectSpread({},formData));errors[\"discount\"]=\"Discount should be >= 0\";setErrors(_objectSpread({},errors));reCalculate();return;}if(!e.target.value){formData.discount=\"\";formData.discount_percent=0.00;errors[\"discount\"]=\"Invalid Discount\";setFormData(_objectSpread({},formData));reCalculate();setErrors(_objectSpread({},errors));return;}errors[\"discount\"]=\"\";errors[\"discount_percent\"]=\"\";setErrors(_objectSpread({},errors));formData.discount=parseFloat(e.target.value);setFormData(_objectSpread({},formData));reCalculate();}}),\" SAR\",errors.discount&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\"},children:errors.discount})]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"th\",{colSpan:\"8\",className:\"text-end\",children:[\" VAT  \",/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"text-center\",style:{width:\"50px\"},value:formData.vat_percent,onChange:function onChange(e){console.log(\"Inside onchange vat percent\");if(parseFloat(e.target.value)===0){formData.vat_percent=parseFloat(e.target.value);setFormData(_objectSpread({},formData));errors[\"vat_percent\"]=\"\";setErrors(_objectSpread({},errors));reCalculate();return;}if(parseFloat(e.target.value)<0){formData.vat_percent=parseFloat(e.target.value);vatPrice=0.00;setVatPrice(vatPrice);setFormData(_objectSpread({},formData));errors[\"vat_percent\"]=\"Vat percent should be >= 0\";setErrors(_objectSpread({},errors));reCalculate();return;}if(!e.target.value){formData.vat_percent=\"\";vatPrice=0.00;setVatPrice(vatPrice);//formData.discount_percent = 0.00;\nerrors[\"vat_percent\"]=\"Invalid vat percent\";setFormData(_objectSpread({},formData));setErrors(_objectSpread({},errors));return;}errors[\"vat_percent\"]=\"\";setErrors(_objectSpread({},errors));formData.vat_percent=e.target.value;reCalculate();setFormData(_objectSpread({},formData));console.log(formData);}}),\"%\",errors.vat_percent&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"red\"},children:errors.vat_percent})]}),/*#__PURE__*/_jsx(\"td\",{className:\"text-end\",children:/*#__PURE__*/_jsx(NumberFormat,{value:vatPrice,displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{colSpan:\"8\",className:\"text-end\",children:\"Net Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-end\",children:/*#__PURE__*/_jsx(NumberFormat,{value:netTotal,displayType:\"text\",thousandSeparator:true,suffix:\" SAR\",renderText:function renderText(value,props){return value;}})})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Status*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:formData.status,onChange:function onChange(e){console.log(\"Inside onchange status\");if(!e.target.value){formData.status=\"\";setFormData(_objectSpread({},formData));errors[\"status\"]=\"Invalid Status\";setErrors(_objectSpread({},errors));return;}errors[\"status\"]=\"\";setErrors(_objectSpread({},errors));formData.status=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"created\",children:\"Created\"}),/*#__PURE__*/_jsx(\"option\",{value:\"delivered\",children:\"Delivered\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"accepted\",children:\"Accepted\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rejected\",children:\"Rejected\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cancelled\",children:\"Cancelled\"})]}),errors.status&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.status]}),formData.status&&!errors.status&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Date*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(DatePicker,{id:\"date_str\",selected:formData.date_str?new Date(formData.date_str):null,value:formData.date_str?format(new Date(formData.date_str),\"MMMM d, yyyy h:mm aa\"):null,className:\"form-control\",dateFormat:\"MMMM d, yyyy h:mm aa\",showTimeSelect:true,timeIntervals:\"1\",onChange:function onChange(value){console.log(\"Value\",value);formData.date_str=value;// formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\nsetFormData(_objectSpread({},formData));}}),errors.date_str&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.date_str]})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleCreate,children:isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Processing...\":formData.id?\"Update\":\"Create\"})]})]})})]})]});});export default QuotationCreate;","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/quotation/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","QuotationPreview","Modal","Button","Form","StoreCreate","CustomerCreate","ProductCreate","UserCreate","SignatureCreate","Cookies","Typeahead","NumberFormat","DatePicker","format","Spinner","QuotationView","ProductView","DebounceInput","QuotationCreate","props","ref","open","id","formData","vat_percent","discount","discountValue","discount_percent","shipping_handling_fees","is_discount_percent","date_str","Date","signature_date_str","status","price_type","selectedProducts","setSelectedProducts","selectedStores","setSelectedStores","selectedCustomers","setSelectedCustomers","selectedDeliveredByUsers","setSelectedDeliveredByUsers","selectedDeliveredBySignatures","setSelectedDeliveredBySignatures","reCalculate","cookies","get","name","delivered_by","setFormData","store_id","store_name","getQuotation","SetShow","listener","event","code","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","preventDefault","document","addEventListener","removeEventListener","selectedDate","errors","setErrors","isProcessing","setProcessing","storeOptions","setStoreOptions","isStoresLoading","setIsStoresLoading","customerOptions","setCustomerOptions","isCustomersLoading","setIsCustomersLoading","productOptions","setProductOptions","selectedProduct","setSelectedProduct","isProductsLoading","setIsProductsLoading","deliveredByUserOptions","setDeliveredByUserOptions","isDeliveredByUsersLoading","setIsDeliveredByUsersLoading","deliveredBySignatureOptions","setDeliveredBySignatureOptions","isDeliveredBySignaturesLoading","setIsDeliveredBySignaturesLoading","show","handleClose","at","window","location","requestOptions","method","headers","fetch","then","response","isJson","json","data","ok","error","Promise","reject","quotation","result","customer_id","date","delivered_by_signature_id","products","customer_name","search_label","delivered_by_name","delivered_by_signature_name","catch","ObjectToSearchQueryParams","object","Object","keys","map","key","encodeURIComponent","join","suggestStores","searchTerm","params","queryString","Authorization","Select","suggestCustomers","GetProductUnitPriceInStore","storeId","productStores","i","length","retail_unit_price","GetProductPurchaseUnitPriceInStore","unitPriceListArray","purchase_unit_price","openProductSearchResult","setOpenProductSearchResult","suggestProducts","getProductByBarCode","barcode","slice","product","addProduct","suggestUsers","suggestSignatures","handleCreate","push","product_id","name_in_arabic","quantity","parseFloat","unit_price","unit","part_number","endPoint","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","isProductAdded","productID","unitPrice","stores","alreadyAdded","getProductIndex","item","item_code","removeProduct","splice","totalPrice","setTotalPrice","findTotalPrice","toFixed","vatPrice","setVatPrice","findVatPrice","netTotal","setNetTotal","findNetTotal","discountPercent","setDiscountPercent","findDiscountPercent","findDiscount","StoreCreateFormRef","openStoreCreateForm","current","CustomerCreateFormRef","openCustomerCreateForm","ProductCreateFormRef","openProductCreateForm","openProductUpdateForm","UserCreateFormRef","openUserCreateForm","SignatureCreateFormRef","openSignatureCreateForm","ProductDetailsViewRef","openProductDetailsView","PreviewRef","openPreview","model","parse","net_total","vat_price","total","selectedItems","e","toString","color","value","bar_code","overflowX","maxHeight","overflowY","width","cursor","textDecoration","reverse"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle } from \"react\";\nimport QuotationPreview from \"./preview.js\";\nimport { Modal, Button, Form } from \"react-bootstrap\";\nimport StoreCreate from \"../store/create.js\";\nimport CustomerCreate from \"./../customer/create.js\";\nimport ProductCreate from \"./../product/create.js\";\nimport UserCreate from \"./../user/create.js\";\nimport SignatureCreate from \"./../signature/create.js\";\nimport Cookies from \"universal-cookie\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport NumberFormat from \"react-number-format\";\nimport DatePicker from \"react-datepicker\";\nimport { format } from \"date-fns\";\nimport { Spinner } from \"react-bootstrap\";\nimport QuotationView from \"./view.js\";\nimport ProductView from \"./../product/view.js\";\nimport { DebounceInput } from 'react-debounce-input';\n\nconst QuotationCreate = forwardRef((props, ref) => {\n\n  useImperativeHandle(ref, () => ({\n    open(id) {\n      formData = {\n        vat_percent: 15.0,\n        discount: 0.0,\n        discountValue: 0.0,\n        discount_percent: 0.0,\n        shipping_handling_fees: 0.00,\n        is_discount_percent: false,\n        date_str: format(new Date(), \"MMM dd yyyy\"),\n        signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n        status: \"delivered\",\n        price_type: \"retail\",\n      };\n\n      selectedProducts = [];\n      setSelectedProducts([]);\n\n      selectedStores = [];\n      setSelectedStores([]);\n\n      selectedCustomers = [];\n      setSelectedCustomers([]);\n\n      selectedDeliveredByUsers = [];\n      setSelectedDeliveredByUsers([]);\n\n      selectedDeliveredBySignatures = [];\n      setSelectedDeliveredBySignatures([]);\n\n      reCalculate();\n\n      if (cookies.get(\"user_id\")) {\n        selectedDeliveredByUsers = [{\n          id: cookies.get(\"user_id\"),\n          name: cookies.get(\"user_name\"),\n        }];\n        formData.delivered_by = cookies.get(\"user_id\");\n        setFormData({ ...formData });\n        setSelectedDeliveredByUsers([...selectedDeliveredByUsers]);\n      }\n      if (cookies.get('store_id')) {\n        formData.store_id = cookies.get('store_id');\n        formData.store_name = cookies.get('store_name');\n      }\n\n      setFormData({ ...formData });\n      if (id) {\n        getQuotation(id);\n      }\n      SetShow(true);\n    },\n\n\n  }));\n\n\n  useEffect(() => {\n    const listener = event => {\n        if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n            console.log(\"Enter key was pressed. Run your function-order.123\");\n            // event.preventDefault();\n\n\n\n            var form = event.target.form;\n            if (form && event.target) {\n                var index = Array.prototype.indexOf.call(form, event.target);\n                if (form && form.elements[index + 1]) {\n                    if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n                        form.elements[index].focus();\n                    } else {\n                        form.elements[index + 1].focus();\n                    }\n                    event.preventDefault();\n                }\n            }\n        }\n    };\n    document.addEventListener(\"keydown\", listener);\n    return () => {\n        document.removeEventListener(\"keydown\", listener);\n    };\n}, []);\n\n\n  const selectedDate = new Date();\n\n  //const history = useHistory();\n  let [errors, setErrors] = useState({});\n  const [isProcessing, setProcessing] = useState(false);\n  const cookies = new Cookies();\n\n  //fields\n  let [formData, setFormData] = useState({\n    vat_percent: 15.0,\n    discount: 0.0,\n    discountValue: 0.0,\n    discount_percent: 0.0,\n    date_str: format(new Date(), \"MMM dd yyyy\"),\n    signature_date_str: format(new Date(), \"MMM dd yyyy\"),\n    status: \"created\",\n    price_type: \"retail\",\n    is_discount_percent: false,\n  });\n\n\n  //Store Auto Suggestion\n  const [storeOptions, setStoreOptions] = useState([]);\n  let [selectedStores, setSelectedStores] = useState([]);\n  const [isStoresLoading, setIsStoresLoading] = useState(false);\n\n  //Customer Auto Suggestion\n  const [customerOptions, setCustomerOptions] = useState([]);\n  let [selectedCustomers, setSelectedCustomers] = useState([]);\n  const [isCustomersLoading, setIsCustomersLoading] = useState(false);\n\n  //Product Auto Suggestion\n  let [productOptions, setProductOptions] = useState([]);\n  let [selectedProduct, setSelectedProduct] = useState([]);\n  let [selectedProducts, setSelectedProducts] = useState([]);\n  const [isProductsLoading, setIsProductsLoading] = useState(false);\n\n  //Delivered By Auto Suggestion\n  const [deliveredByUserOptions, setDeliveredByUserOptions] = useState([]);\n  let [selectedDeliveredByUsers, setSelectedDeliveredByUsers] = useState([]);\n  const [isDeliveredByUsersLoading, setIsDeliveredByUsersLoading] =\n    useState(false);\n\n  //Delivered By Signature Auto Suggestion\n  const [deliveredBySignatureOptions, setDeliveredBySignatureOptions] =\n    useState([]);\n  let [selectedDeliveredBySignatures, setSelectedDeliveredBySignatures] =\n    useState([]);\n  const [isDeliveredBySignaturesLoading, setIsDeliveredBySignaturesLoading] =\n    useState(false);\n\n  const [show, SetShow] = useState(false);\n\n  function handleClose() {\n    SetShow(false);\n  }\n\n\n  useEffect(() => {\n    let at = cookies.get(\"access_token\");\n    if (!at) {\n      // history.push(\"/dashboard/quotations\");\n      window.location = \"/\";\n    }\n  });\n\n\n  function getQuotation(id) {\n    console.log(\"inside get Quotation\");\n    const requestOptions = {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': cookies.get('access_token'),\n      },\n    };\n\n    fetch('/v1/quotation/' + id, requestOptions)\n      .then(async response => {\n        const isJson = response.headers.get('content-type')?.includes('application/json');\n        const data = isJson && await response.json();\n\n        // check for error response\n        if (!response.ok) {\n          const error = (data && data.errors);\n          return Promise.reject(error);\n        }\n\n        setErrors({});\n\n        console.log(\"Response:\");\n        console.log(data);\n\n        let quotation = data.result;\n        formData = {\n          id: quotation.id,\n          code: quotation.code,\n          store_id: quotation.store_id,\n          customer_id: quotation.customer_id,\n         // date_str: quotation.date_str,\n          date: quotation.date,\n          vat_percent: quotation.vat_percent,\n          discount: quotation.discount,\n          discount_percent: quotation.discount_percent,\n          status: quotation.status,\n          delivered_by: quotation.delivered_by,\n          delivered_by_signature_id: quotation.delivered_by_signature_id,\n          is_discount_percent: quotation.is_discount_percent,\n          shipping_handling_fees: quotation.shipping_handling_fees,\n        };\n        formData.date_str = data.result.date;\n\n        if (formData.is_discount_percent) {\n          formData.discountValue = formData.discount_percent;\n        } else {\n          formData.discountValue = formData.discount;\n        }\n\n        selectedProducts = quotation.products;\n        setSelectedProducts([...selectedProducts]);\n\n\n        let selectedStores = [\n          {\n            id: quotation.store_id,\n            name: quotation.store_name,\n          }\n        ];\n\n        let selectedCustomers = [\n          {\n            id: quotation.customer_id,\n            name: quotation.customer_name,\n            search_label: quotation.customer_name,\n          }\n        ];\n\n        let selectedDeliveredByUsers = [\n          {\n            id: quotation.delivered_by,\n            name: quotation.delivered_by_name\n          }\n        ];\n\n        if (quotation.delivered_by_signature_id) {\n          let selectedDeliveredBySignatures = [\n            {\n              id: quotation.delivered_by_signature_id,\n              name: quotation.delivered_by_signature_name,\n            }\n          ];\n          setSelectedDeliveredBySignatures([...selectedDeliveredBySignatures]);\n        }\n\n        setSelectedDeliveredByUsers([...selectedDeliveredByUsers]);\n\n        setSelectedStores([...selectedStores]);\n        setSelectedCustomers([...selectedCustomers]);\n\n\n        setFormData({ ...formData });\n\n        reCalculate();\n      })\n      .catch(error => {\n        setProcessing(false);\n        setErrors(error);\n      });\n  }\n\n  function ObjectToSearchQueryParams(object) {\n    return Object.keys(object)\n      .map(function (key) {\n        return `search[${key}]=` + encodeURIComponent(object[key]);\n      })\n      .join(\"&\");\n  }\n\n  async function suggestStores(searchTerm) {\n    console.log(\"Inside handle suggestStores\");\n    setStoreOptions([]);\n\n    console.log(\"searchTerm:\" + searchTerm);\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm,\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,name\";\n    setIsStoresLoading(true);\n    let result = await fetch(\n      \"/v1/store?\" + Select + queryString,\n      requestOptions\n    );\n    let data = await result.json();\n\n    setStoreOptions(data.result);\n    setIsStoresLoading(false);\n  }\n\n  async function suggestCustomers(searchTerm) {\n    console.log(\"Inside handle suggestCustomers\");\n    setCustomerOptions([]);\n\n    console.log(\"searchTerm:\" + searchTerm);\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm,\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,name,phone,name_in_arabic,phone_in_arabic,search_label\";\n    setIsCustomersLoading(true);\n    let result = await fetch(\n      \"/v1/customer?\" + Select + queryString,\n      requestOptions\n    );\n    let data = await result.json();\n\n    setCustomerOptions(data.result);\n    setIsCustomersLoading(false);\n  }\n\n  function GetProductUnitPriceInStore(storeId, productStores) {\n    if (!productStores) {\n      return \"\";\n    }\n\n    for (var i = 0; i < productStores.length; i++) {\n      console.log(\"productStores[i]:\", productStores[i]);\n      console.log(\"store_id:\", storeId);\n\n      if (productStores[i].store_id === storeId) {\n        console.log(\"macthed\");\n        console.log(\n          \"productStores[i].retail_unit_price:\",\n          productStores[i].retail_unit_price\n        );\n        return productStores[i];\n      }\n    }\n    console.log(\"not matched\");\n    return \"\";\n  }\n\n  function GetProductPurchaseUnitPriceInStore(storeId, unitPriceListArray) {\n    if (!unitPriceListArray) {\n      return \"\";\n    }\n\n    for (var i = 0; i < unitPriceListArray.length; i++) {\n      console.log(\"unitPriceListArray[i]:\", unitPriceListArray[i]);\n      console.log(\"store_id:\", storeId);\n\n      if (unitPriceListArray[i].store_id === storeId) {\n        return unitPriceListArray[i].purchase_unit_price;\n      } else {\n        console.log(\"not matched\");\n      }\n    }\n    return \"\";\n  }\n\n\n\n\n  let [openProductSearchResult, setOpenProductSearchResult] = useState(false);\n\n  async function suggestProducts(searchTerm) {\n    console.log(\"Inside handle suggestProducts\");\n    setProductOptions([]);\n\n    console.log(\"searchTerm:\" + searchTerm);\n    if (!searchTerm) {\n      openProductSearchResult = false;\n      setOpenProductSearchResult(false);\n      setIsProductsLoading(false);\n      return;\n    }\n\n    var params = {\n      name: searchTerm,\n    };\n\n    if (cookies.get(\"store_id\")) {\n      params.store_id = cookies.get(\"store_id\");\n    }\n\n    var queryString = ObjectToSearchQueryParams(params);\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,item_code,bar_code,name,stores,unit,part_number,name_in_arabic\";\n    setIsProductsLoading(true);\n    let result = await fetch(\n      \"/v1/product?\" + Select + queryString + \"&limit=200\",\n      requestOptions\n    );\n    let data = await result.json();\n\n    let products = data.result;\n    if (!products || products.length === 0) {\n      openProductSearchResult = false;\n      setOpenProductSearchResult(false);\n      setIsProductsLoading(false);\n      return;\n    }\n\n    openProductSearchResult = true;\n    setOpenProductSearchResult(true);\n    setProductOptions(products);\n    setIsProductsLoading(false);\n  }\n\n  async function getProductByBarCode(barcode) {\n    formData.barcode = barcode;\n    setFormData({ ...formData });\n    console.log(\"Inside getProductByBarCode\");\n    errors[\"bar_code\"] = \"\";\n    setErrors({ ...errors });\n\n    console.log(\"barcode:\" + formData.barcode);\n    if (!formData.barcode) {\n      return;\n    }\n\n    if (formData.barcode.length === 13) {\n      formData.barcode = formData.barcode.slice(0, -1);\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n\n    let Select = \"select=id,item_code,bar_code,ean_12,part_number,name,stores,unit,part_number,name_in_arabic\";\n    let result = await fetch(\n      \"/v1/product/barcode/\" + formData.barcode + \"?\" + Select,\n      requestOptions\n    );\n    let data = await result.json();\n\n\n    let product = data.result;\n    if (product) {\n      addProduct(product);\n    } else {\n      errors[\"bar_code\"] = \"Invalid Barcode:\" + formData.barcode\n      setErrors({ ...errors });\n    }\n\n    formData.barcode = \"\";\n    setFormData({ ...formData });\n\n  }\n\n  async function suggestUsers(searchTerm) {\n    console.log(\"Inside handle suggestUsers\");\n    setDeliveredByUserOptions([]);\n\n    console.log(\"searchTerm:\" + searchTerm);\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm,\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,name\";\n    setIsDeliveredByUsersLoading(true);\n    let result = await fetch(\n      \"/v1/user?\" + Select + queryString,\n      requestOptions\n    );\n    let data = await result.json();\n\n    setDeliveredByUserOptions(data.result);\n    setIsDeliveredByUsersLoading(false);\n  }\n\n  async function suggestSignatures(searchTerm) {\n    console.log(\"Inside handle suggestSignatures\");\n    setDeliveredBySignatureOptions([]);\n\n    console.log(\"searchTerm:\" + searchTerm);\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm,\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,name\";\n    setIsDeliveredBySignaturesLoading(true);\n    let result = await fetch(\n      \"/v1/signature?\" + Select + queryString,\n      requestOptions\n    );\n    let data = await result.json();\n\n    setDeliveredBySignatureOptions(data.result);\n    setIsDeliveredBySignaturesLoading(false);\n  }\n\n  function handleCreate(event) {\n    event.preventDefault();\n    console.log(\"Inside handle Create\");\n    console.log(\"selectedProducts:\", selectedProducts);\n\n    formData.products = [];\n    for (var i = 0; i < selectedProducts.length; i++) {\n      formData.products.push({\n        product_id: selectedProducts[i].product_id,\n        name: selectedProducts[i].name,\n        name_in_arabic: selectedProducts[i].name_in_arabic,\n        quantity: parseFloat(selectedProducts[i].quantity),\n        unit_price: parseFloat(selectedProducts[i].unit_price),\n        purchase_unit_price: parseFloat(selectedProducts[i].purchase_unit_price),\n        unit: selectedProducts[i].unit,\n        part_number: selectedProducts[i].part_number,\n      });\n    }\n\n    formData.discount = parseFloat(formData.discount);\n    formData.discount_percent = parseFloat(formData.discount_percent);\n    formData.vat_percent = parseFloat(formData.vat_percent);\n\n    if (cookies.get('store_id')) {\n      formData.store_id = cookies.get('store_id');\n    }\n\n    console.log(\"formData.discount:\", formData.discount);\n\n    let endPoint = \"/v1/quotation\";\n    let method = \"POST\";\n    if (formData.id) {\n      endPoint = \"/v1/quotation/\" + formData.id;\n      method = \"PUT\";\n    }\n\n\n    const requestOptions = {\n      method: method,\n      headers: {\n        'Accept': 'application/json',\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n      body: JSON.stringify(formData),\n    };\n\n    console.log(\"formData:\", formData);\n\n    setProcessing(true);\n    fetch(endPoint, requestOptions)\n      .then(async (response) => {\n        const isJson = response.headers\n          .get(\"content-type\")\n          ?.includes(\"application/json\");\n        const data = isJson && (await response.json());\n\n        // check for error response\n        if (!response.ok) {\n          // get error message from body or default to response status\n          const error = data && data.errors;\n          //const error = data.errors\n          return Promise.reject(error);\n        }\n\n        setErrors({});\n        setProcessing(false);\n\n        console.log(\"Response:\");\n        console.log(data);\n        props.showToastMessage(\"Quotation Created Successfully!\", \"success\");\n        if (props.refreshList) {\n          props.refreshList();\n        }\n        handleClose();\n        props.openDetailsView(data.result.id);\n      })\n      .catch((error) => {\n        setProcessing(false);\n        console.log(\"Inside catch\");\n        console.log(error);\n        setErrors({ ...error });\n        console.error(\"There was an error!\", error);\n        props.showToastMessage(\"Error Creating Quotation!\", \"danger\");\n      });\n  }\n\n  function isProductAdded(productID) {\n    for (var i = 0; i < selectedProducts.length; i++) {\n      if (selectedProducts[i].product_id === productID) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function addProduct(product) {\n    console.log(\"Inside Add product\");\n    if (!formData.store_id) {\n      errors.product_id = \"Please Select a Store and try again\";\n      setErrors({ ...errors });\n      return;\n    }\n\n\n    errors.product_id = \"\";\n    if (!product) {\n      errors.product_id = \"Invalid Product\";\n      setErrors({ ...errors });\n      return;\n    }\n\n    let unitPrice = GetProductUnitPriceInStore(\n      formData.store_id,\n      product.stores\n    );\n    product.unit_price = unitPrice.retail_unit_price;\n    product.purchase_unit_price = unitPrice.purchase_unit_price;\n\n    let alreadyAdded = false;\n    let index = -1;\n    let quantity = 0.00;\n    product.quantity = 1.00;\n\n    if (isProductAdded(product.id)) {\n      alreadyAdded = true;\n      index = getProductIndex(product.id);\n      quantity = parseFloat(selectedProducts[index].quantity + product.quantity);\n    } else {\n      quantity = parseFloat(product.quantity);\n    }\n\n    console.log(\"quantity:\", quantity);\n\n    errors.quantity = \"\";\n\n    if (alreadyAdded) {\n      selectedProducts[index].quantity = parseFloat(quantity);\n    }\n\n    if (!alreadyAdded) {\n      let item = {\n        product_id: product.id,\n        code: product.item_code,\n        part_number: product.part_number,\n        name: product.name,\n        quantity: product.quantity,\n        stores: product.stores,\n        unit: product.unit,\n      };\n\n      if (product.unit_price) {\n        item.unit_price = parseFloat(product.unit_price);\n        console.log(\"item.unit_price:\", item.unit_price);\n      }\n\n      if (product.purchase_unit_price) {\n        item.purchase_unit_price = parseFloat(product.purchase_unit_price);\n        console.log(\"item.purchase_unit_price\", item.purchase_unit_price);\n      }\n\n      selectedProducts.push(item);\n\n    }\n    console.log(\"selectedProducts:\", selectedProducts);\n    setSelectedProducts([...selectedProducts]);\n    reCalculate();\n  }\n\n  function getProductIndex(productID) {\n    for (var i = 0; i < selectedProducts.length; i++) {\n      if (selectedProducts[i].product_id === productID) {\n        return i;\n      }\n    }\n    return false;\n  }\n\n  function removeProduct(product) {\n    const index = selectedProducts.indexOf(product);\n    if (index > -1) {\n      selectedProducts.splice(index, 1);\n    }\n    setSelectedProducts([...selectedProducts]);\n\n    reCalculate();\n  }\n\n  let [totalPrice, setTotalPrice] = useState(0.0);\n\n  function findTotalPrice() {\n    totalPrice = 0.00;\n    for (var i = 0; i < selectedProducts.length; i++) {\n      totalPrice +=\n        parseFloat(selectedProducts[i].unit_price) *\n        parseFloat(selectedProducts[i].quantity);\n    }\n    totalPrice = totalPrice.toFixed(2);\n    setTotalPrice(totalPrice);\n  }\n\n  let [vatPrice, setVatPrice] = useState(0.00);\n\n  function findVatPrice() {\n    vatPrice = 0.00;\n    if (totalPrice > 0) {\n      vatPrice = (parseFloat((parseFloat(formData.vat_percent) / 100)) * (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount))).toFixed(2);;\n      console.log(\"vatPrice:\", vatPrice);\n    }\n    setVatPrice(vatPrice);\n  }\n\n  let [netTotal, setNetTotal] = useState(0.00);\n\n  function findNetTotal() {\n    netTotal = 0.00;\n    if (totalPrice > 0) {\n      netTotal = (parseFloat(totalPrice) + parseFloat(formData.shipping_handling_fees) - parseFloat(formData.discount) + parseFloat(vatPrice)).toFixed(2);\n    }\n    setNetTotal(netTotal);\n  }\n\n  let [discountPercent, setDiscountPercent] = useState(0.00);\n\n  function findDiscountPercent() {\n    if (formData.discount >= 0 && totalPrice > 0) {\n      discountPercent = parseFloat(parseFloat(formData.discount / totalPrice) * 100).toFixed(2);\n      setDiscountPercent(discountPercent);\n      formData.discount_percent = discountPercent;\n      setFormData({ ...formData });\n    }\n  }\n\n  function findDiscount() {\n    if (formData.discount_percent >= 0 && totalPrice > 0) {\n      formData.discount = parseFloat(totalPrice * parseFloat(formData.discount_percent / 100)).toFixed(2);\n      setFormData({ ...formData });\n    }\n  }\n\n\n  function reCalculate() {\n    findTotalPrice();\n    if (formData.is_discount_percent) {\n      findDiscount();\n    } else {\n      findDiscountPercent();\n    }\n    findVatPrice();\n    findNetTotal();\n  }\n\n  const StoreCreateFormRef = useRef();\n  function openStoreCreateForm() {\n    StoreCreateFormRef.current.open();\n  }\n\n  const CustomerCreateFormRef = useRef();\n  function openCustomerCreateForm() {\n    CustomerCreateFormRef.current.open();\n  }\n\n\n  const ProductCreateFormRef = useRef();\n  function openProductCreateForm() {\n    ProductCreateFormRef.current.open();\n  }\n\n  function openProductUpdateForm(id) {\n    ProductCreateFormRef.current.open(id);\n  }\n\n  const UserCreateFormRef = useRef();\n  function openUserCreateForm() {\n    UserCreateFormRef.current.open();\n  }\n\n\n  const SignatureCreateFormRef = useRef();\n  function openSignatureCreateForm() {\n    SignatureCreateFormRef.current.open();\n  }\n\n\n  const ProductDetailsViewRef = useRef();\n  function openProductDetailsView(id) {\n    ProductDetailsViewRef.current.open(id);\n  }\n\n  const PreviewRef = useRef();\n  function openPreview() {\n    let model = {};\n    model = JSON.parse(JSON.stringify(formData));\n    model.products = selectedProducts;\n    model.net_total = netTotal;\n    model.vat_price = vatPrice;\n    model.total = totalPrice;\n\n    //setFormData({ ...formData });\n    PreviewRef.current.open(model);\n  }\n\n  return (\n    <>\n      <ProductView ref={ProductDetailsViewRef} openUpdateForm={openProductUpdateForm} openCreateForm={openProductCreateForm} />\n      <ProductCreate ref={ProductCreateFormRef} showToastMessage={props.showToastMessage} openDetailsView={openProductDetailsView} />\n\n      <QuotationPreview ref={PreviewRef} />\n\n      <StoreCreate ref={StoreCreateFormRef} showToastMessage={props.showToastMessage} />\n      <CustomerCreate ref={CustomerCreateFormRef} showToastMessage={props.showToastMessage} />\n      <UserCreate ref={UserCreateFormRef} showToastMessage={props.showToastMessage} />\n      <SignatureCreate ref={SignatureCreateFormRef} showToastMessage={props.showToastMessage} />\n      <Modal show={show} size=\"xl\" fullscreen onHide={handleClose} animation={false} backdrop=\"static\" scrollable={true}>\n        <Modal.Header>\n          <Modal.Title>\n            {formData.id ? \"Update Quotation #\" + formData.code : \"Create New Quotation\"}\n          </Modal.Title>\n\n\n          <div className=\"col align-self-end text-end\">\n            <Button variant=\"primary\" onClick={openPreview}>\n              <i className=\"bi bi-display\"></i> Preview\n            </Button>\n            &nbsp;&nbsp;\n            <Button variant=\"primary\" onClick={openPreview}>\n              <i className=\"bi bi-display\"></i> Preview\n            </Button>\n            &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;\n            {formData.id ? <Button variant=\"primary\" onClick={() => {\n              handleClose();\n              props.openDetailsView(formData.id);\n            }}>\n              <i className=\"bi bi-eye\"></i> View Detail\n            </Button> : \"\"}\n            &nbsp;&nbsp;\n            <Button variant=\"primary\" onClick={handleCreate} >\n              {isProcessing ?\n                <Spinner\n                  as=\"span\"\n                  animation=\"border\"\n                  size=\"sm\"\n                  role=\"status\"\n                  aria-hidden={true}\n                /> + \" Creating...\"\n\n                : \"\"\n              }\n              {formData.id ? \"Update\" : \"Create\"}\n\n            </Button>\n            <button\n              type=\"button\"\n              className=\"btn-close\"\n              onClick={handleClose}\n              aria-label=\"Close\"\n            ></button>\n          </div>\n        </Modal.Header>\n        <Modal.Body>\n          <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n            {!cookies.get('store_name') ? <div className=\"col-md-6\">\n              <label className=\"form-label\">Store*</label>\n\n              <div className=\"input-group mb-3\">\n                <Typeahead\n                  id=\"store_id\"\n                  labelKey=\"name\"\n                  isLoading={isStoresLoading}\n                  isInvalid={errors.store_id ? true : false}\n                  onChange={(selectedItems) => {\n                    errors.store_id = \"\";\n                    setErrors(errors);\n                    if (selectedItems.length === 0) {\n                      errors.store_id = \"Invalid Store selected\";\n                      setErrors(errors);\n                      formData.store_id = \"\";\n                      setFormData({ ...formData });\n                      setSelectedStores([]);\n                      return;\n                    }\n                    formData.store_id = selectedItems[0].id;\n                    setFormData({ ...formData });\n                    setSelectedStores(selectedItems);\n                    //SetPriceOfAllProducts(selectedItems[0].id);\n                  }}\n                  options={storeOptions}\n                  placeholder=\"Select Store\"\n                  selected={selectedStores}\n                  highlightOnlyResult={true}\n                  onInputChange={(searchTerm, e) => {\n                    suggestStores(searchTerm);\n                  }}\n                />\n\n                <Button hide={true.toString()} onClick={openStoreCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                <div style={{ color: \"red\" }}>\n                  <i className=\"bi x-lg\"> </i>\n                  {errors.store_id}\n                </div>\n                {formData.store_id && !errors.store_id && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div> : \"\"}\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Customer*</label>\n\n              <div className=\"input-group mb-3\">\n                <Typeahead\n                  id=\"customer_id\"\n                  labelKey=\"search_label\"\n                  isLoading={isCustomersLoading}\n                  isInvalid={errors.customer_id ? true : false}\n                  onChange={(selectedItems) => {\n                    errors.customer_id = \"\";\n                    setErrors(errors);\n                    if (selectedItems.length === 0) {\n                      errors.customer_id = \"Invalid Customer selected\";\n                      setErrors(errors);\n                      formData.customer_id = \"\";\n                      setFormData({ ...formData });\n                      setSelectedCustomers([]);\n                      return;\n                    }\n                    formData.customer_id = selectedItems[0].id;\n                    setFormData({ ...formData });\n                    setSelectedCustomers(selectedItems);\n                  }}\n                  options={customerOptions}\n                  placeholder=\"Type name or mob\"\n                  selected={selectedCustomers}\n                  highlightOnlyResult={true}\n                  onInputChange={(searchTerm, e) => {\n                    suggestCustomers(searchTerm);\n                  }}\n                />\n                <Button hide={true.toString()} onClick={openCustomerCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n                {errors.customer_id && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.customer_id}\n                  </div>\n                )}\n                {formData.customer_id && !errors.customer_id && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Product Barcode Scan</label>\n\n              <div className=\"input-group mb-3\">\n                <DebounceInput\n                  minLength={3}\n                  debounceTimeout={500}\n                  placeholder=\"Scan Barcode\"\n                  className=\"form-control barcode\"\n                  value={formData.barcode}\n                  onChange={event => getProductByBarCode(event.target.value)} />\n                {errors.bar_code && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.bar_code}\n                  </div>\n                )}\n                {formData.bar_code && !errors.bar_code && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"col-md-12\">\n              <label className=\"form-label\">Product*</label>\n              <Typeahead\n                id=\"product_id\"\n                size=\"lg\"\n                labelKey=\"search_label\"\n                emptyLabel=\"\"\n                clearButton={true}\n                open={openProductSearchResult}\n                isLoading={isProductsLoading}\n                isInvalid={errors.product_id ? true : false}\n                onChange={(selectedItems) => {\n                  if (selectedItems.length === 0) {\n                    errors[\"product_id\"] = \"Invalid Product selected\";\n                    setErrors(errors);\n                    return;\n                  }\n                  errors[\"product_id\"] = \"\";\n                  setErrors({ ...errors });\n\n                  if (formData.store_id) {\n                    addProduct(selectedItems[0]);\n\n                  }\n                  setOpenProductSearchResult(false);\n                }}\n                options={productOptions}\n                selected={selectedProduct}\n                placeholder=\"Search By Part No. / Name / Name in Arabic\"\n                highlightOnlyResult={true}\n                onInputChange={(searchTerm, e) => {\n                  suggestProducts(searchTerm);\n                }}\n              />\n              <Button hide={true.toString()} onClick={openProductCreateForm} className=\"btn btn-outline-secondary btn-primary btn-sm\" type=\"button\" id=\"button-addon1\"> <i className=\"bi bi-plus-lg\"></i> New</Button>\n              {errors.product_id ? (\n                <div style={{ color: \"red\" }}>\n                  <i className=\"bi bi-x-lg\"> </i>\n                  {errors.product_id}\n                </div>\n              ) : null}\n              {selectedProduct[0] &&\n                selectedProduct[0].id &&\n                !errors.product_id && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n            </div>\n\n            <div className=\"table-responsive\" style={{ overflowX: \"auto\", maxHeight: \"400px\", overflowY: \"auto\" }}>\n              <table className=\"table table-striped table-sm table-bordered\">\n                <thead>\n                  <tr className=\"text-center\">\n                    <th style={{ width: \"3%\" }}>Remove</th>\n                    <th style={{ width: \"5%\" }}>SI No.</th>\n                    <th style={{ width: \"10%\" }}>Part No.</th>\n                    <th style={{ width: \"34%\" }} className=\"text-start\">Name</th>\n                    <th style={{ width: \"11%\" }}>Qty</th>\n                    <th style={{ width: \"11%\" }} >Purchase Unit Price</th>\n                    <th style={{ width: \"11%\" }}>Unit Price</th>\n                    <th style={{ width: \"15%\" }}>Price</th>\n\n                  </tr>\n                </thead>\n                <tbody>\n                  {selectedProducts.map((product, index) => (\n                    <tr key={index} className=\"text-center\">\n                      <td>\n                        <div\n                          style={{ color: \"red\", cursor: \"pointer\" }}\n                          onClick={() => {\n                            removeProduct(product);\n                          }}\n                        >\n                          <i className=\"bi bi-x-lg\"> </i>\n                        </div>\n                      </td>\n                      <td>{index + 1}</td>\n                      <td>{product.part_number}</td>\n                      <td style={{\n                        textDecoration: \"underline\",\n                        color: \"blue\",\n                        cursor: \"pointer\",\n                      }}\n                        className=\"text-start\"\n                        onClick={() => {\n                          openProductDetailsView(product.product_id);\n                          console.log(\"okk,id:\", product.product_id);\n                        }}>{product.name}\n                      </td>\n                      <td style={{ width: \"155px\" }}>\n\n                        <div className=\"input-group mb-3\">\n                          <input type=\"number\" value={product.quantity} className=\"form-control\"\n\n                            placeholder=\"Quantity\" onChange={(e) => {\n                              errors[\"quantity_\" + index] = \"\";\n                              setErrors({ ...errors });\n                              if (!e.target.value) {\n                                errors[\"quantity_\" + index] = \"Invalid Quantity\";\n                                selectedProducts[index].quantity = e.target.value;\n                                setSelectedProducts([...selectedProducts]);\n                                setErrors({ ...errors });\n                                console.log(\"errors:\", errors);\n                                return;\n                              }\n\n                              if (parseFloat(e.target.value) === 0) {\n                                errors[\"quantity_\" + index] = \"Quantity should be > 0\";\n                                selectedProducts[index].quantity = e.target.value;\n                                setSelectedProducts([...selectedProducts]);\n                                setErrors({ ...errors });\n                                console.log(\"errors:\", errors);\n                                return;\n                              }\n\n                              product.quantity = parseFloat(e.target.value);\n                              reCalculate();\n\n                              selectedProducts[index].quantity = parseFloat(e.target.value);\n                              console.log(\"selectedProducts[index].quantity:\", selectedProducts[index].quantity);\n                              setSelectedProducts([...selectedProducts]);\n                              reCalculate();\n\n                            }} />\n                          <span className=\"input-group-text\" id=\"basic-addon2\"> {selectedProducts[index].unit ? selectedProducts[index].unit : \"Units\"}</span>\n                        </div>\n                        {errors[\"quantity_\" + index] && (\n                          <div style={{ color: \"red\" }}>\n                            <i className=\"bi bi-x-lg\"> </i>\n                            {errors[\"quantity_\" + index]}\n                          </div>\n                        )}\n\n                      </td>\n                      <td style={{ width: \"150px\" }}>\n                        {product.purchase_unit_price ? <NumberFormat\n                          value={(product.purchase_unit_price).toFixed(2)}\n                          displayType={\"text\"}\n                          thousandSeparator={true}\n                          suffix={\" SAR\"}\n                          renderText={(value, props) => value}\n                        /> : \"\"}\n                      </td>\n                      <td style={{ width: \"180px\" }}>\n\n                        <div className=\"input-group mb-3\">\n                          <input type=\"number\" value={product.unit_price} className=\"form-control\"\n\n                            placeholder=\"Unit Price\" onChange={(e) => {\n                              errors[\"unit_price_\" + index] = \"\";\n                              setErrors({ ...errors });\n                              if (!e.target.value) {\n                                errors[\"unit_price_\" + index] = \"Invalid Unit Price\";\n                                selectedProducts[index].unit_price = parseFloat(e.target.value);\n                                setSelectedProducts([...selectedProducts]);\n                                setErrors({ ...errors });\n                                console.log(\"errors:\", errors);\n                                return;\n                              }\n\n                              if (parseFloat(e.target.value) === 0) {\n                                errors[\"unit_price_\" + index] = \"Unit Price shoudl be > 0\";\n                                selectedProducts[index].unit_price = parseFloat(e.target.value);\n                                setSelectedProducts([...selectedProducts]);\n                                setErrors({ ...errors });\n                                console.log(\"errors:\", errors);\n                                return;\n                              }\n\n                              selectedProducts[index].unit_price = parseFloat(e.target.value);\n                              console.log(\"selectedProducts[index].unit_price:\", selectedProducts[index].unit_price);\n                              setSelectedProducts([...selectedProducts]);\n                              reCalculate();\n\n                            }} />\n                          <span className=\"input-group-text\" id=\"basic-addon2\">SAR</span>\n                        </div>\n                        {errors[\"unit_price_\" + index] && (\n                          <div style={{ color: \"red\" }}>\n                            <i className=\"bi bi-x-lg\"> </i>\n                            {errors[\"unit_price_\" + index]}\n\n                          </div>\n                        )}\n                      </td>\n                      <td className=\"text-end\">\n                        <NumberFormat\n                          value={(product.unit_price * product.quantity).toFixed(2)}\n                          displayType={\"text\"}\n                          thousandSeparator={true}\n                          suffix={\" SAR\"}\n                          renderText={(value, props) => value}\n                        />\n                      </td>\n\n                    </tr>\n                  )).reverse()}\n                </tbody>\n              </table>\n            </div>\n            <div className=\"table-responsive\">\n              <table className=\"table table-striped table-sm table-bordered\">\n                <tbody>\n                  <tr>\n\n\n                    <th colSpan=\"8\" className=\"text-end\">Total</th>\n                    <td className=\"text-end\" style={{ width: \"200px\" }} >\n                      <NumberFormat\n                        value={totalPrice}\n                        displayType={\"text\"}\n                        thousandSeparator={true}\n                        suffix={\" SAR\"}\n                        renderText={(value, props) => value}\n                      />\n                    </td>\n                  </tr>\n                  <tr>\n                    <th colSpan=\"8\" className=\"text-end\">\n                      Shipping & Handling Fees\n                    </th>\n                    <td className=\"text-end\">\n                      <input type=\"number\" style={{ width: \"150px\" }} className=\"text-start\" value={formData.shipping_handling_fees} onChange={(e) => {\n\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.shipping_handling_fees = parseFloat(e.target.value);\n                          setFormData({ ...formData });\n                          errors[\"shipping_handling_fees\"] = \"\";\n                          setErrors({ ...errors });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.shipping_handling_fees = parseFloat(e.target.value);\n                          setFormData({ ...formData });\n                          errors[\"shipping_handling_fees\"] = \"Shipping / Handling Fees should be > 0\";\n                          setErrors({ ...errors });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.shipping_handling_fees = \"\";\n                          errors[\"shipping_handling_fees\"] = \"Invalid Shipping / Handling Fees\";\n                          setFormData({ ...formData });\n                          setErrors({ ...errors });\n                          return;\n                        }\n\n                        errors[\"shipping_handling_fees\"] = \"\";\n                        setErrors({ ...errors });\n\n                        formData.shipping_handling_fees = parseFloat(e.target.value);\n                        setFormData({ ...formData });\n                        reCalculate();\n                      }} />\n                      {\" SAR\"}\n                      {errors.shipping_handling_fees && (\n                        <div style={{ color: \"red\" }}>\n                          {errors.shipping_handling_fees}\n                        </div>\n                      )}\n                    </td>\n                  </tr>\n                  <tr>\n                    <th colSpan=\"8\" className=\"text-end\">\n                      Discount  <input type=\"number\" style={{ width: \"50px\" }} className=\"text-start\" value={formData.discount_percent} onChange={(e) => {\n                        formData.is_discount_percent = true;\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.discount_percent = parseFloat(e.target.value);\n                          setFormData({ ...formData });\n                          errors[\"discount_percent\"] = \"\";\n                          setErrors({ ...errors });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.discount_percent = parseFloat(e.target.value);\n                          formData.discount = 0.00;\n                          setFormData({ ...formData });\n                          errors[\"discount_percent\"] = \"Discount percent should be >= 0\";\n                          setErrors({ ...errors });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.discount_percent = \"\";\n                          formData.discount = 0.00;\n                          errors[\"discount_percent\"] = \"Invalid Discount Percent\";\n                          setFormData({ ...formData });\n                          setErrors({ ...errors });\n                          return;\n                        }\n\n                        errors[\"discount_percent\"] = \"\";\n                        errors[\"discount\"] = \"\";\n                        setErrors({ ...errors });\n\n                        formData.discount_percent = parseFloat(e.target.value);\n                        setFormData({ ...formData });\n                        reCalculate();\n                      }} />{\"%\"}\n                      {errors.discount_percent && (\n                        <div style={{ color: \"red\" }}>\n                          {errors.discount_percent}\n                        </div>\n                      )}\n                    </th>\n                    <td className=\"text-end\">\n                      <input type=\"number\" style={{ width: \"150px\" }} className=\"text-start\" value={formData.discount} onChange={(e) => {\n                        formData.is_discount_percent = false;\n                        if (parseFloat(e.target.value) === 0) {\n                          formData.discount = parseFloat(e.target.value);\n                          setFormData({ ...formData });\n                          errors[\"discount\"] = \"\";\n                          setErrors({ ...errors });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (parseFloat(e.target.value) < 0) {\n                          formData.discount = parseFloat(e.target.value);\n                          formData.discount_percent = 0.00;\n                          setFormData({ ...formData });\n                          errors[\"discount\"] = \"Discount should be >= 0\";\n                          setErrors({ ...errors });\n                          reCalculate();\n                          return;\n                        }\n\n                        if (!e.target.value) {\n                          formData.discount = \"\";\n                          formData.discount_percent = 0.00;\n                          errors[\"discount\"] = \"Invalid Discount\";\n                          setFormData({ ...formData });\n                          reCalculate();\n                          setErrors({ ...errors });\n                          return;\n                        }\n\n                        errors[\"discount\"] = \"\";\n                        errors[\"discount_percent\"] = \"\";\n                        setErrors({ ...errors });\n\n                        formData.discount = parseFloat(e.target.value);\n                        setFormData({ ...formData });\n                        reCalculate();\n                      }} />\n                      {\" SAR\"}\n                      {errors.discount && (\n                        <div style={{ color: \"red\" }}>\n                          {errors.discount}\n                        </div>\n                      )}\n                    </td>\n                  </tr>\n                  <tr>\n\n                    <th colSpan=\"8\" className=\"text-end\"> VAT  <input type=\"number\" className=\"text-center\" style={{ width: \"50px\" }} value={formData.vat_percent} onChange={(e) => {\n                      console.log(\"Inside onchange vat percent\");\n                      if (parseFloat(e.target.value) === 0) {\n                        formData.vat_percent = parseFloat(e.target.value);\n                        setFormData({ ...formData });\n                        errors[\"vat_percent\"] = \"\";\n                        setErrors({ ...errors });\n                        reCalculate();\n                        return;\n                      }\n                      if (parseFloat(e.target.value) < 0) {\n                        formData.vat_percent = parseFloat(e.target.value);\n                        vatPrice = 0.00;\n                        setVatPrice(vatPrice);\n                        setFormData({ ...formData });\n                        errors[\"vat_percent\"] = \"Vat percent should be >= 0\";\n                        setErrors({ ...errors });\n                        reCalculate();\n                        return;\n                      }\n\n\n                      if (!e.target.value) {\n                        formData.vat_percent = \"\";\n                        vatPrice = 0.00;\n                        setVatPrice(vatPrice);\n                        //formData.discount_percent = 0.00;\n                        errors[\"vat_percent\"] = \"Invalid vat percent\";\n                        setFormData({ ...formData });\n                        setErrors({ ...errors });\n                        return;\n                      }\n                      errors[\"vat_percent\"] = \"\";\n                      setErrors({ ...errors });\n\n                      formData.vat_percent = e.target.value;\n                      reCalculate();\n                      setFormData({ ...formData });\n                      console.log(formData);\n                    }} />{\"%\"}\n                      {errors.vat_percent && (\n                        <div style={{ color: \"red\" }}>\n                          {errors.vat_percent}\n                        </div>\n                      )}\n                    </th>\n                    <td className=\"text-end\">\n                      <NumberFormat\n                        value={vatPrice}\n                        displayType={\"text\"}\n                        thousandSeparator={true}\n                        suffix={\" SAR\"}\n                        renderText={(value, props) => value}\n                      />\n                    </td>\n                  </tr>\n                  <tr>\n\n                    <th colSpan=\"8\" className=\"text-end\">Net Total</th>\n                    <th className=\"text-end\">\n                      <NumberFormat\n                        value={netTotal}\n                        displayType={\"text\"}\n                        thousandSeparator={true}\n                        suffix={\" SAR\"}\n                        renderText={(value, props) => value}\n                      />\n                    </th>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n\n\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Status*</label>\n\n              <div className=\"input-group mb-3\">\n                <select\n                  value={formData.status}\n                  onChange={(e) => {\n                    console.log(\"Inside onchange status\");\n                    if (!e.target.value) {\n                      formData.status = \"\";\n                      setFormData({ ...formData });\n                      errors[\"status\"] = \"Invalid Status\";\n                      setErrors({ ...errors });\n                      return;\n                    }\n\n                    errors[\"status\"] = \"\";\n                    setErrors({ ...errors });\n\n                    formData.status = e.target.value;\n                    setFormData({ ...formData });\n                    console.log(formData);\n                  }}\n                  className=\"form-control\"\n                >\n                  <option value=\"created\">Created</option>\n                  <option value=\"delivered\">Delivered</option>\n                  <option value=\"pending\">Pending</option>\n                  <option value=\"accepted\">Accepted</option>\n                  <option value=\"rejected\">Rejected</option>\n                  <option value=\"cancelled\">Cancelled</option>\n                </select>\n                {errors.status && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.status}\n                  </div>\n                )}\n                {formData.status && !errors.status && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"col-md-6\">\n                            <label className=\"form-label\">Date*</label>\n\n                            <div className=\"input-group mb-3\">\n                                <DatePicker\n                                    id=\"date_str\"\n                                    selected={formData.date_str ? new Date(formData.date_str) : null}\n                                    value={formData.date_str ? format(\n                                        new Date(formData.date_str),\n                                        \"MMMM d, yyyy h:mm aa\"\n                                    ) : null}\n                                    className=\"form-control\"\n                                    dateFormat=\"MMMM d, yyyy h:mm aa\"\n                                    showTimeSelect\n                                    timeIntervals=\"1\"\n                                    onChange={(value) => {\n                                        console.log(\"Value\", value);\n                                        formData.date_str = value;\n                                        // formData.date_str = format(new Date(value), \"MMMM d yyyy h:mm aa\");\n                                        setFormData({ ...formData });\n                                    }}\n                                />\n\n                                {errors.date_str && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.date_str}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n            <Modal.Footer>\n              <Button variant=\"secondary\" onClick={handleClose}>\n                Close\n              </Button>\n              <Button variant=\"primary\" onClick={handleCreate} >\n                {isProcessing ?\n                  <Spinner\n                    as=\"span\"\n                    animation=\"border\"\n                    size=\"sm\"\n                    role=\"status\"\n                    aria-hidden={true}\n                  /> + \" Processing...\"\n\n                  : formData.id ? \"Update\" : \"Create\"\n                }\n              </Button>\n            </Modal.Footer>\n          </form>\n        </Modal.Body>\n\n      </Modal>\n\n\n    </>\n  );\n});\n\nexport default QuotationCreate;\n"]},"metadata":{},"sourceType":"module"}