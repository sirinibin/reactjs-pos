{"ast":null,"code":"/**\n * Use the ImageData from a Canvas and flatten the image on a solid background\n */\nclass CanvasFlatten {\n  /**\n     * Change the image to grayscale\n     *\n     * @param  {object}   image         The imageData of a Canvas 2d context\n     * @param  {array}    background    Three values consisting of the r, g, b of the background\n     * @return {object}                 The resulting imageData\n     *\n     */\n  flatten(image, background) {\n    for (let i = 0; i < image.data.length; i += 4) {\n      const alpha = image.data[i + 3];\n      const invAlpha = 255 - alpha;\n      image.data[i] = (alpha * image.data[i] + invAlpha * background[0]) / 255;\n      image.data[i + 1] = (alpha * image.data[i + 1] + invAlpha * background[1]) / 255;\n      image.data[i + 2] = (alpha * image.data[i + 2] + invAlpha * background[2]) / 255;\n      image.data[i + 3] = 0xff;\n    }\n\n    return image;\n  }\n\n}\n\nmodule.exports = new CanvasFlatten();","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/canvas-flatten/src/canvas-flatten.js"],"names":["CanvasFlatten","flatten","image","background","i","data","length","alpha","invAlpha","module","exports"],"mappings":"AAAA;AACA;AACA;AACA,MAAMA,aAAN,CAAoB;AAClB;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,EAAAA,OAAO,CAACC,KAAD,EAAQC,UAAR,EAAoB;AACzB,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,KAAK,CAACG,IAAN,CAAWC,MAA/B,EAAuCF,CAAC,IAAI,CAA5C,EAA+C;AAC7C,YAAMG,KAAK,GAAGL,KAAK,CAACG,IAAN,CAAWD,CAAC,GAAG,CAAf,CAAd;AACA,YAAMI,QAAQ,GAAG,MAAMD,KAAvB;AAEAL,MAAAA,KAAK,CAACG,IAAN,CAAWD,CAAX,IAAgB,CAACG,KAAK,GAAGL,KAAK,CAACG,IAAN,CAAWD,CAAX,CAAR,GAAwBI,QAAQ,GAAGL,UAAU,CAAC,CAAD,CAA9C,IAAqD,GAArE;AACAD,MAAAA,KAAK,CAACG,IAAN,CAAWD,CAAC,GAAG,CAAf,IAAoB,CAACG,KAAK,GAAGL,KAAK,CAACG,IAAN,CAAWD,CAAC,GAAG,CAAf,CAAR,GAA4BI,QAAQ,GAAGL,UAAU,CAAC,CAAD,CAAlD,IAAyD,GAA7E;AACAD,MAAAA,KAAK,CAACG,IAAN,CAAWD,CAAC,GAAG,CAAf,IAAoB,CAACG,KAAK,GAAGL,KAAK,CAACG,IAAN,CAAWD,CAAC,GAAG,CAAf,CAAR,GAA4BI,QAAQ,GAAGL,UAAU,CAAC,CAAD,CAAlD,IAAyD,GAA7E;AACAD,MAAAA,KAAK,CAACG,IAAN,CAAWD,CAAC,GAAG,CAAf,IAAoB,IAApB;AACD;;AAED,WAAOF,KAAP;AACD;;AArBiB;;AAwBpBO,MAAM,CAACC,OAAP,GAAiB,IAAIV,aAAJ,EAAjB","sourcesContent":["/**\n * Use the ImageData from a Canvas and flatten the image on a solid background\n */\nclass CanvasFlatten {\n  /**\n     * Change the image to grayscale\n     *\n     * @param  {object}   image         The imageData of a Canvas 2d context\n     * @param  {array}    background    Three values consisting of the r, g, b of the background\n     * @return {object}                 The resulting imageData\n     *\n     */\n  flatten(image, background) {\n    for (let i = 0; i < image.data.length; i += 4) {\n      const alpha = image.data[i + 3];\n      const invAlpha = 255 - alpha;\n\n      image.data[i] = (alpha * image.data[i] + invAlpha * background[0]) / 255;\n      image.data[i + 1] = (alpha * image.data[i + 1] + invAlpha * background[1]) / 255;\n      image.data[i + 2] = (alpha * image.data[i + 2] + invAlpha * background[2]) / 255;\n      image.data[i + 3] = 0xff;\n    }\n\n    return image;\n  }\n}\n\nmodule.exports = new CanvasFlatten();\n"]},"metadata":{},"sourceType":"script"}