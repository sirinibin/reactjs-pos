{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef,forwardRef,useImperativeHandle}from\"react\";import{Modal,Button}from\"react-bootstrap\";import Cookies from\"universal-cookie\";import{Spinner}from\"react-bootstrap\";import ProductView from\"./view.js\";import{Typeahead}from\"react-bootstrap-typeahead\";import StoreCreate from\"../store/create.js\";import ProductCategoryCreate from\"../product_category/create.js\";import Resizer from\"react-image-file-resizer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ProductCreate=/*#__PURE__*/forwardRef(function(props,ref){useImperativeHandle(ref,function(){return{open:function open(id){selectedCategories=[];setSelectedCategories(selectedCategories);formData={images_content:[],unit:\"\",item_code:\"\"};setFormData({formData:formData});getAllStores();if(id){getProduct(id);}else{//getAllStores();\n}SetShow(true);}};});useEffect(function(){var listener=function listener(event){if(event.code===\"Enter\"||event.code===\"NumpadEnter\"){console.log(\"Enter key was pressed. Run your function-product.\");// event.preventDefault();\nvar form=event.target.form;if(form&&event.target){var index=Array.prototype.indexOf.call(form,event.target);if(form&&form.elements[index+1]){if(event.target.getAttribute(\"class\").includes(\"barcode\")){form.elements[index].focus();}else{form.elements[index+1].focus();}event.preventDefault();}}}};document.addEventListener(\"keydown\",listener);return function(){document.removeEventListener(\"keydown\",listener);};},[]);function resizeFIle(file,w,h,cb){Resizer.imageFileResizer(file,w,h,\"JPEG\",100,0,function(uri){cb(uri);},\"base64\");}var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),selectedImage=_useState2[0],setSelectedImage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),productStores=_useState4[0],setProductStores=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),storeOptions=_useState6[0],setStoreOptions=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),selectedCategories=_useState8[0],setSelectedCategories=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),categoryOptions=_useState10[0],setCategoryOptions=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),errors=_useState12[0],setErrors=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isProcessing=_useState14[0],setProcessing=_useState14[1];var cookies=new Cookies();//fields\nvar _useState15=useState({images_content:[],unit:\"\",item_code:\"\"}),_useState16=_slicedToArray(_useState15,2),formData=_useState16[0],setFormData=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),show=_useState18[0],SetShow=_useState18[1];function handleClose(){SetShow(false);}function getProduct(id){console.log(\"inside get Product\");var requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};fetch(\"/v1/product/\"+id,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var _response$headers$get;var isJson,data,error,categoryIds,categoryNames,i,_i,key;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isJson=(_response$headers$get=response.headers.get(\"content-type\"))===null||_response$headers$get===void 0?void 0:_response$headers$get.includes(\"application/json\");_context.t0=isJson;if(!_context.t0){_context.next=6;break;}_context.next=5;return response.json();case 5:_context.t0=_context.sent;case 6:data=_context.t0;if(response.ok){_context.next=10;break;}error=data&&data.errors;return _context.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});console.log(\"Response:\");console.log(data);categoryIds=data.result.category_id;categoryNames=data.result.category_name;selectedCategories=[];if(categoryIds&&categoryNames){for(i=0;i<categoryIds.length;i++){selectedCategories.push({id:categoryIds[i],name:categoryNames[i]});}}setSelectedCategories(selectedCategories);if(data.result.product_stores){console.log(\"data.result.product_stores-ok:\",data.result.product_stores);// productStores.push(data.result.stores);\n_i=0;for(key in data.result.product_stores){console.log(\"key: \",key);if(productStores[_i].store_id==data.result.product_stores[key].store_id){productStores[_i].purchase_unit_price=data.result.product_stores[key].purchase_unit_price;productStores[_i].wholesale_unit_price=data.result.product_stores[key].wholesale_unit_price;productStores[_i].retail_unit_price=data.result.product_stores[key].retail_unit_price;productStores[_i].stock=data.result.product_stores[key].stock;_i++;}}setProductStores(_toConsumableArray(productStores));console.log(\"productStores-ok:\",productStores);}/*\n    if(cookies.get('store_id')){\n         //let stores1 = data.result.stores.filter((store)=>store.store_id==cookies.get('store_id'));\n        // let stores1 = data.result.stores;\n        if(data.result.stores.length>0){\n            productStores= data.result.stores;\n            setProductStores([...productStores]);\n        }\n    }else {\n        console.log(\"data.result.stores:\",data.result.stores);\n       // productStores.push(data.result.stores);\n\n        let i=0;\n        for(let store of data.result.stores){\n            if(productStores[i].store_id == store.store_id){\n                productStores[i].purchase_unit_price= store.purchase_unit_price;\n                productStores[i].wholesale_unit_price= store.wholesale_unit_price;\n                productStores[i].retail_unit_price= store.retail_unit_price;\n                productStores[i].stock= store.stock;\n                i++;\n            }\n        }\n        setProductStores([...productStores]);\n        console.log(\"productStores:\",productStores);\n        */formData=data.result;formData.name=data.result.name;if(!formData.unit){formData.unit=\"\";}formData.images_content=[];formData.useLaserScanner=false;setFormData(_objectSpread({},formData));case 25:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){setProcessing(false);setErrors(error);});}function suggestCategories(_x2){return _suggestCategories.apply(this,arguments);}function _suggestCategories(){_suggestCategories=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Inside handle suggest Categories\");console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context3.next=4;break;}return _context3.abrupt(\"return\");case 4:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";_context3.next=11;return fetch(\"/v1/product-category?\"+Select+queryString,requestOptions);case 11:result=_context3.sent;_context3.next=14;return result.json();case 14:data=_context3.sent;setCategoryOptions(data.result);case 16:case\"end\":return _context3.stop();}}},_callee3);}));return _suggestCategories.apply(this,arguments);}var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),stores=_useState20[0],setStores=_useState20[1];function getAllStores(){return _getAllStores.apply(this,arguments);}function _getAllStores(){_getAllStores=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var requestOptions,Select,result,data,i;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"fetching all stores\");requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";_context4.next=5;return fetch(\"/v1/store?\"+Select,requestOptions);case 5:result=_context4.sent;_context4.next=8;return result.json();case 8:data=_context4.sent;stores=data.result;setStores(data.result);productStores=[];for(i=0;i<stores.length;i++){productStores.push({store_id:stores[i].id,store_name:stores[i].name,purchase_unit_price:\"\",retail_unit_price:\"\",wholesale_unit_price:\"\",stock:\"\"});}setProductStores(_toConsumableArray(productStores));console.log(\"productStores:\",productStores);case 15:case\"end\":return _context4.stop();}}},_callee4);}));return _getAllStores.apply(this,arguments);}function suggestStores(_x3){return _suggestStores.apply(this,arguments);}function _suggestStores(){_suggestStores=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(searchTerm){var params,queryString,requestOptions,Select,result,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log(\"Inside handle suggest Stores\");console.log(\"searchTerm:\"+searchTerm);if(searchTerm){_context5.next=4;break;}return _context5.abrupt(\"return\");case 4:params={name:searchTerm};queryString=ObjectToSearchQueryParams(params);if(queryString!==\"\"){queryString=\"&\"+queryString;}requestOptions={method:\"GET\",headers:{\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")}};Select=\"select=id,name\";_context5.next=11;return fetch(\"/v1/store?\"+Select+queryString,requestOptions);case 11:result=_context5.sent;_context5.next=14;return result.json();case 14:data=_context5.sent;setStoreOptions(data.result);case 16:case\"end\":return _context5.stop();}}},_callee5);}));return _suggestStores.apply(this,arguments);}useEffect(function(){var at=cookies.get(\"access_token\");if(!at){window.location=\"/\";}});function ObjectToSearchQueryParams(object){return Object.keys(object).map(function(key){return\"search[\".concat(key,\"]=\").concat(object[key]);}).join(\"&\");}function handleCreate(event){event.preventDefault();console.log(\"Inside handle Create\");formData.category_id=[];for(var i=0;i<selectedCategories.length;i++){formData.category_id.push(selectedCategories[i].id);}console.log(\"productStores:\",productStores);var storesData={};for(var _i2=0;_i2<productStores.length;_i2++){storesData[productStores[_i2].store_id]={\"store_id\":productStores[_i2].store_id,\"store_name\":productStores[_i2].store_name,\"retail_unit_price\":productStores[_i2].retail_unit_price?productStores[_i2].retail_unit_price:0,\"wholesale_unit_price\":productStores[_i2].wholesale_unit_price?productStores[_i2].wholesale_unit_price:0,\"purchase_unit_price\":productStores[_i2].purchase_unit_price?productStores[_i2].purchase_unit_price:0,\"stock\":productStores[_i2].stock?productStores[_i2].stock:0};/*\n          storesData.push({\n              \"store_id\": productStores[i].store_id,\n              \"store_name\": productStores[i].store_name,\n              \"retail_unit_price\": productStores[i].retail_unit_price?productStores[i].retail_unit_price:0,\n              \"wholesale_unit_price\": productStores[i].wholesale_unit_price?productStores[i].wholesale_unit_price:0,\n              \"purchase_unit_price\": productStores[i].purchase_unit_price?productStores[i].purchase_unit_price:0,\n              \"stock\": productStores[i].stock?productStores[i].stock:0,\n          });\n          */}formData.product_stores=storesData;if(cookies.get(\"store_id\")){formData.store_id=cookies.get(\"store_id\");}console.log(\"Formdata:\",formData);var endPoint=\"/v1/product\";var method=\"POST\";if(formData.id){endPoint=\"/v1/product/\"+formData.id;method=\"PUT\";}var requestOptions={method:method,headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",Authorization:cookies.get(\"access_token\")},body:JSON.stringify(formData)};setProcessing(true);fetch(endPoint,requestOptions).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){var _response$headers$get2;var isJson,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isJson=(_response$headers$get2=response.headers.get(\"content-type\"))===null||_response$headers$get2===void 0?void 0:_response$headers$get2.includes(\"application/json\");_context2.t0=isJson;if(!_context2.t0){_context2.next=6;break;}_context2.next=5;return response.json();case 5:_context2.t0=_context2.sent;case 6:data=_context2.t0;if(response.ok){_context2.next=10;break;}// get error message from body or default to response status\nerror=data&&data.errors;//const error = data.errors\nreturn _context2.abrupt(\"return\",Promise.reject(error));case 10:setErrors({});setProcessing(false);console.log(\"Response:\");console.log(data);props.showToastMessage(\"Product Created Successfully!\",\"success\");if(props.refreshList){props.refreshList();}handleClose();props.openDetailsView(data.result.id);case 18:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x4){return _ref2.apply(this,arguments);};}()).catch(function(error){setProcessing(false);console.log(\"Inside catch\");console.log(error);setErrors(_objectSpread({},error));console.error(\"There was an error!\",error);props.showToastMessage(\"Error Creating Product!\",\"danger\");});}function isStockAddedToStore(storeID){for(var i=0;i<productStores.length;i++){if(productStores[i].store_id===storeID){return true;}}return false;}function findStockIndexByStoreID(storeID){for(var i=0;i<productStores.length;i++){if(productStores[i].store_id===storeID){return i;}}return-1;}function isUnitPriceAddedToStore(storeID){for(var i=0;i<productStores.length;i++){if(productStores[i].store_id===storeID){return true;}}return false;}function removeStock(productStore){var index=productStores.indexOf(productStore);if(index>-1){productStores.splice(index,1);}setProductStores(_toConsumableArray(productStores));}function getTargetDimension(originaleWidth,originalHeight,targetWidth,targetHeight){var ratio=parseFloat(originaleWidth/originalHeight);targetWidth=parseInt(targetHeight*ratio);targetHeight=parseInt(targetWidth*ratio);return{targetWidth:targetWidth,targetHeight:targetHeight};}/*\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        console.log(\"id:\", id);\n        DetailsViewRef.current.open(id);\n    }\n    */var StoreCreateFormRef=useRef();function openStoreCreateForm(){StoreCreateFormRef.current.open();}var ProductCategoryCreateFormRef=useRef();function openProductCategoryCreateForm(){ProductCategoryCreateFormRef.current.open();}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(StoreCreate,{ref:StoreCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsx(ProductCategoryCreate,{ref:ProductCategoryCreateFormRef,showToastMessage:props.showToastMessage}),/*#__PURE__*/_jsxs(Modal,{show:show,size:\"xl\",onHide:handleClose,animation:false,backdrop:\"static\",scrollable:true,children:[/*#__PURE__*/_jsxs(Modal.Header,{children:[/*#__PURE__*/_jsx(Modal.Title,{children:formData.id?\"Update Product #\"+formData.name:\"Create New Product\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"col align-self-end text-end\",children:[formData.id?/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:function onClick(){handleClose();props.openDetailsView(formData.id);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-eye\"}),\" View Detail\"]}):\"\",\"\\xA0\\xA0\",/*#__PURE__*/_jsxs(Button,{variant:\"primary\",onClick:handleCreate,children:[isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"border\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Creating...\":\"\",formData.id?\"Update\":\"Create\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:handleClose,\"aria-label\":\"Close\"})]})]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(\"form\",{className:\"row g-3 needs-validation\",onSubmit:handleCreate,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Name*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.name?formData.name:\"\",type:\"string\",onChange:function onChange(e){errors[\"name\"]=\"\";setErrors(_objectSpread({},errors));formData.name=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"name\",placeholder:\"Name\"}),errors.name&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.name]}),formData.name&&!errors.name&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Name In Arabic (Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.name_in_arabic?formData.name_in_arabic:\"\",type:\"string\",onChange:function onChange(e){errors[\"v\"]=\"\";setErrors(_objectSpread({},errors));formData.name_in_arabic=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"name_in_arabic\",placeholder:\"Name In Arabic\"}),errors.name_in_arabic&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.name_in_arabic]}),formData.name_in_arabic&&!errors.name_in_arabic&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Part Number(Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.part_number?formData.part_number:\"\",type:\"string\",onChange:function onChange(e){errors[\"part_number\"]=\"\";setErrors(_objectSpread({},errors));formData.part_number=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"part_number\",placeholder:\"Part Number\"}),errors.part_number&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.part_number]}),formData.part_number&&!errors.part_number&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Rack / Location (Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:formData.rack?formData.rack:\"\",type:\"string\",onChange:function onChange(e){errors[\"rack\"]=\"\";setErrors(_objectSpread({},errors));formData.rack=e.target.value;setFormData(_objectSpread({},formData));console.log(formData);},className:\"form-control\",id:\"rack\",placeholder:\"Rack/Location\"}),errors.rack&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.rack]}),formData.rack&&!errors.rack&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Categories*\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(Typeahead,{id:\"category_id\",labelKey:\"name\",isInvalid:errors.category_id?true:false,onChange:function onChange(selectedItems){errors.category_id=\"\";setErrors(errors);if(selectedItems.length===0){errors.category_id=\"Invalid Category selected\";setErrors(errors);setFormData(_objectSpread({},formData));setSelectedCategories([]);return;}setFormData(_objectSpread({},formData));setSelectedCategories(selectedItems);},options:categoryOptions,placeholder:\"Select Categories\",selected:selectedCategories,highlightOnlyResult:true,onInputChange:function onInputChange(searchTerm,e){suggestCategories(searchTerm);}}),/*#__PURE__*/_jsxs(Button,{hide:true.toString(),onClick:openProductCategoryCreateForm,className:\"btn btn-outline-secondary btn-primary btn-sm\",type:\"button\",id:\"button-addon1\",children:[\" \",/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-lg\"}),\" New\"]}),errors.category_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.category_id]}),formData.category_id&&!errors.category_id&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Unit\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",value:formData.unit,onChange:function onChange(e){formData.unit=e.target.value;console.log(\"Inside onchange price type:\",formData.unit);setFormData(_objectSpread({},formData));},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"PC\"}),/*#__PURE__*/_jsx(\"option\",{value:\"drum\",children:\"Drum\"}),/*#__PURE__*/_jsx(\"option\",{value:\"set\",children:\"Set\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Kg\",children:\"Kg\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Meter(s)\",children:\"Meter(s)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Gm\",children:\"Gm\"}),/*#__PURE__*/_jsx(\"option\",{value:\"L\",children:\"Liter (L)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Gm\",children:\"Gm\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Mg\",children:\"Mg\"})]})]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Unit Price & Stock\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",style:{overflowX:\"auto\"},children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped table-sm table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-center\",children:[!cookies.get('store_id')?/*#__PURE__*/_jsx(\"th\",{children:\"Store Name\"}):\"\",/*#__PURE__*/_jsx(\"th\",{children:\"Purchase Unit Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Wholesale Unit Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Retail Unit Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Stock\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:stores.map(function(store,index){var _productStores$index,_productStores$index2,_productStores$index3,_productStores$index4,_productStores$index5,_productStores$index6,_productStores$index7,_productStores$index8,_productStores$index9,_productStores$index10,_productStores$index11,_productStores$index12,_productStores$index13,_productStores$index14,_productStores$index15,_productStores$index16,_productStores$index17,_productStores$index18,_productStores$index19;return!cookies.get('store_id')||store.id==cookies.get('store_id')?/*#__PURE__*/_jsxs(\"tr\",{className:\"text-center\",children:[!cookies.get('store_id')?/*#__PURE__*/_jsx(\"td\",{style:{width:\"150px\"},children:store.name}):\"\",/*#__PURE__*/_jsxs(\"td\",{style:{width:\"150px\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_productStores$index=productStores[index])===null||_productStores$index===void 0?void 0:_productStores$index.purchase_unit_price)||((_productStores$index2=productStores[index])===null||_productStores$index2===void 0?void 0:_productStores$index2.purchase_unit_price)==0?(_productStores$index3=productStores[index])===null||_productStores$index3===void 0?void 0:_productStores$index3.purchase_unit_price:\"\",className:\"form-control\",placeholder:\"Purchase Unit Price\",onChange:function onChange(e){errors[\"purchase_unit_price_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){productStores[index].purchase_unit_price=\"\";setProductStores(_toConsumableArray(productStores));// setErrors({ ...errors });\nconsole.log(\"errors:\",errors);return;}if(parseFloat(e.target.value)<0){productStores[index].purchase_unit_price=\"\";setProductStores(_toConsumableArray(productStores));errors[\"purchase_unit_price_\"+index]=\"Purchase Unit Price should not be < 0\";setErrors(_objectSpread({},errors));return;}productStores[index].purchase_unit_price=parseFloat(e.target.value);setProductStores(_toConsumableArray(productStores));}}),\" \",errors[\"purchase_unit_price_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"purchase_unit_price_\"+index]]}),(((_productStores$index4=productStores[index])===null||_productStores$index4===void 0?void 0:_productStores$index4.purchase_unit_price)||((_productStores$index5=productStores[index])===null||_productStores$index5===void 0?void 0:_productStores$index5.purchase_unit_price)===0)&&!errors[\"purchase_unit_price_\"+index]?/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]}):null]}),/*#__PURE__*/_jsxs(\"td\",{style:{width:\"150px\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_productStores$index6=productStores[index])===null||_productStores$index6===void 0?void 0:_productStores$index6.wholesale_unit_price)||((_productStores$index7=productStores[index])===null||_productStores$index7===void 0?void 0:_productStores$index7.wholesale_unit_price)===0?(_productStores$index8=productStores[index])===null||_productStores$index8===void 0?void 0:_productStores$index8.wholesale_unit_price:\"\",className:\"form-control\",placeholder:\"Wholesale Unit Price\",onChange:function onChange(e){errors[\"wholesale_unit_price_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){productStores[index].wholesale_unit_price=\"\";setProductStores(_toConsumableArray(productStores));return;}if(parseFloat(e.target.value)<0){productStores[index].wholesale_unit_price=\"\";setProductStores(_toConsumableArray(productStores));errors[\"wholesale_unit_price_\"+index]=\"Wholesale unit price should not be < 0\";setErrors(_objectSpread({},errors));return;}productStores[index].wholesale_unit_price=parseFloat(e.target.value);setProductStores(_toConsumableArray(productStores));}}),errors[\"wholesale_unit_price_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"wholesale_unit_price_\"+index]]}),(((_productStores$index9=productStores[index])===null||_productStores$index9===void 0?void 0:_productStores$index9.wholesale_unit_price)||((_productStores$index10=productStores[index])===null||_productStores$index10===void 0?void 0:_productStores$index10.wholesale_unit_price)===0)&&!errors[\"wholesale_unit_price_\"+index]?/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]}):null]}),/*#__PURE__*/_jsxs(\"td\",{style:{width:\"150px\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_productStores$index11=productStores[index])===null||_productStores$index11===void 0?void 0:_productStores$index11.retail_unit_price)||((_productStores$index12=productStores[index])===null||_productStores$index12===void 0?void 0:_productStores$index12.retail_unit_price)===0?(_productStores$index13=productStores[index])===null||_productStores$index13===void 0?void 0:_productStores$index13.retail_unit_price:\"\",className:\"form-control\",placeholder:\"Retail Unit Price\",onChange:function onChange(e){errors[\"retail_unit_price_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){productStores[index].retail_unit_price=\"\";setProductStores(_toConsumableArray(productStores));return;}if(parseFloat(e.target.value)<0){errors[\"retail_unit_price_\"+index]=\"Retail Unit Price should not be < 0\";productStores[index].retail_unit_price=\"\";setProductStores(_toConsumableArray(productStores));setErrors(_objectSpread({},errors));console.log(\"errors:\",errors);return;}console.log(\"e.target.value:\",e.target.value);productStores[index].retail_unit_price=parseFloat(e.target.value);console.log(\"productStores[index].retail_unit_price:\",productStores[index].retail_unit_price);setProductStores(_toConsumableArray(productStores));}}),\" \",errors[\"retail_unit_price_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"retail_unit_price_\"+index]]}),(((_productStores$index14=productStores[index])===null||_productStores$index14===void 0?void 0:_productStores$index14.retail_unit_price)||((_productStores$index15=productStores[index])===null||_productStores$index15===void 0?void 0:_productStores$index15.retail_unit_price)===0)&&!errors[\"retail_unit_price_\"+index]?/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]}):null]}),/*#__PURE__*/_jsxs(\"td\",{style:{width:\"150px\"},children:[/*#__PURE__*/_jsx(\"input\",{value:((_productStores$index16=productStores[index])===null||_productStores$index16===void 0?void 0:_productStores$index16.stock)||((_productStores$index17=productStores[index])===null||_productStores$index17===void 0?void 0:_productStores$index17.stock)===0?productStores[index].stock:\"\",type:\"number\",onChange:function onChange(e){errors[\"stock_\"+index]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){productStores[index].stock=\"\";setProductStores(_toConsumableArray(productStores));//errors[\"stock_\" + index] = \"Invalid Stock value\";\n//setErrors({ ...errors });\nreturn;}productStores[index].stock=parseFloat(e.target.value);},className:\"form-control\",id:\"stock\",placeholder:\"Stock\"}),errors[\"stock_\"+index]&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors[\"stock_\"+index]]}),(((_productStores$index18=productStores[index])===null||_productStores$index18===void 0?void 0:_productStores$index18.stock)||((_productStores$index19=productStores[index])===null||_productStores$index19===void 0?void 0:_productStores$index19.stock)===0)&&!errors[\"stock_\"+index]?/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]}):null]})]},index):'';})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Image(Optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{value:selectedImage?selectedImage:\"\",type:\"file\",onChange:function onChange(e){errors[\"image\"]=\"\";setErrors(_objectSpread({},errors));if(!e.target.value){errors[\"image\"]=\"Invalid Image File\";setErrors(_objectSpread({},errors));return;}selectedImage=e.target.value;setSelectedImage(selectedImage);var file=document.querySelector(\"#image\").files[0];var targetHeight=400;var targetWidth=400;var url=URL.createObjectURL(file);var img=new Image();img.onload=function(){var originaleWidth=img.width;var originalHeight=img.height;var targetDimensions=getTargetDimension(originaleWidth,originalHeight,targetWidth,targetHeight);targetWidth=targetDimensions.targetWidth;targetHeight=targetDimensions.targetHeight;resizeFIle(file,targetWidth,targetHeight,function(result){formData.images_content[0]=result;setFormData(_objectSpread({},formData));console.log(\"formData.images_content[0]:\",formData.images_content[0]);});};img.src=url;/*\n                                        resizeFIle(file, (result) => {\n                                            if (!formData.images_content) {\n                                                formData.images_content = [];\n                                            }\n                                            formData.images_content[0] = result;\n                                            setFormData({ ...formData });\n     \n                                            console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                        });\n                                        */},className:\"form-control\",id:\"image\"}),errors.image&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"red\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-lg\",children:\" \"}),errors.image]}),formData.image&&!errors.image&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"green\"},children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-lg\",children:\" \"}),\"Looks good!\"]})]})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleCreate,children:isProcessing?/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"bproduct\",size:\"sm\",role:\"status\",\"aria-hidden\":true})+\" Processing...\":formData.id?\"Update\":\"Create\"})]})]})})]})]});});export default ProductCreate;","map":{"version":3,"sources":["/Users/sirin/go/src/github.com/sirinibin/reactjs-pos/src/product/create.js"],"names":["React","useState","useEffect","useRef","forwardRef","useImperativeHandle","Modal","Button","Cookies","Spinner","ProductView","Typeahead","StoreCreate","ProductCategoryCreate","Resizer","ProductCreate","props","ref","open","id","selectedCategories","setSelectedCategories","formData","images_content","unit","item_code","setFormData","getAllStores","getProduct","SetShow","listener","event","code","console","log","form","target","index","Array","prototype","indexOf","call","elements","getAttribute","includes","focus","preventDefault","document","addEventListener","removeEventListener","resizeFIle","file","w","h","cb","imageFileResizer","uri","selectedImage","setSelectedImage","productStores","setProductStores","storeOptions","setStoreOptions","categoryOptions","setCategoryOptions","errors","setErrors","isProcessing","setProcessing","cookies","show","handleClose","requestOptions","method","headers","Authorization","get","fetch","then","response","isJson","json","data","ok","error","Promise","reject","categoryIds","result","category_id","categoryNames","category_name","i","length","push","name","product_stores","key","store_id","purchase_unit_price","wholesale_unit_price","retail_unit_price","stock","useLaserScanner","catch","suggestCategories","searchTerm","params","queryString","ObjectToSearchQueryParams","Select","stores","setStores","store_name","suggestStores","at","window","location","object","Object","keys","map","join","handleCreate","storesData","endPoint","Accept","body","JSON","stringify","showToastMessage","refreshList","openDetailsView","isStockAddedToStore","storeID","findStockIndexByStoreID","isUnitPriceAddedToStore","removeStock","productStore","splice","getTargetDimension","originaleWidth","originalHeight","targetWidth","targetHeight","ratio","parseFloat","parseInt","StoreCreateFormRef","openStoreCreateForm","current","ProductCategoryCreateFormRef","openProductCategoryCreateForm","e","value","color","name_in_arabic","part_number","rack","selectedItems","toString","overflowX","store","width","querySelector","files","url","URL","createObjectURL","img","Image","onload","height","targetDimensions","src","image"],"mappings":"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","sourcesContent":["import React, {\n  useState,\n  useEffect,\n  useRef,\n  forwardRef,\n  useImperativeHandle,\n} from \"react\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport Cookies from \"universal-cookie\";\nimport { Spinner } from \"react-bootstrap\";\nimport ProductView from \"./view.js\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport StoreCreate from \"../store/create.js\";\nimport ProductCategoryCreate from \"../product_category/create.js\";\nimport Resizer from \"react-image-file-resizer\";\n\nconst ProductCreate = forwardRef((props, ref) => {\n  useImperativeHandle(ref, () => ({\n    open(id) {\n      selectedCategories = [];\n      setSelectedCategories(selectedCategories);\n\n\n\n      formData = {\n        images_content: [],\n        unit: \"\",\n        item_code: \"\",\n      };\n      setFormData({ formData });\n      getAllStores();\n\n      if (id) {\n        getProduct(id);\n      } else {\n        //getAllStores();\n      }\n\n      SetShow(true);\n    },\n  }));\n\n  useEffect(() => {\n    const listener = (event) => {\n      if (event.code === \"Enter\" || event.code === \"NumpadEnter\") {\n        console.log(\"Enter key was pressed. Run your function-product.\");\n        // event.preventDefault();\n\n        var form = event.target.form;\n        if (form && event.target) {\n          var index = Array.prototype.indexOf.call(form, event.target);\n          if (form && form.elements[index + 1]) {\n            if (event.target.getAttribute(\"class\").includes(\"barcode\")) {\n              form.elements[index].focus();\n            } else {\n              form.elements[index + 1].focus();\n            }\n            event.preventDefault();\n          }\n        }\n      }\n    };\n    document.addEventListener(\"keydown\", listener);\n    return () => {\n      document.removeEventListener(\"keydown\", listener);\n    };\n  }, []);\n\n  function resizeFIle(file, w, h, cb) {\n    Resizer.imageFileResizer(\n      file,\n      w,\n      h,\n      \"JPEG\",\n      100,\n      0,\n      (uri) => {\n        cb(uri);\n      },\n      \"base64\"\n    );\n  }\n\n  let [selectedImage, setSelectedImage] = useState(\"\");\n  let [productStores, setProductStores] = useState([]);\n\n  let [storeOptions, setStoreOptions] = useState([]);\n\n  let [selectedCategories, setSelectedCategories] = useState([]);\n  let [categoryOptions, setCategoryOptions] = useState([]);\n\n  let [errors, setErrors] = useState({});\n  const [isProcessing, setProcessing] = useState(false);\n  const cookies = new Cookies();\n\n  //fields\n  let [formData, setFormData] = useState({\n    images_content: [],\n    unit: \"\",\n    item_code: \"\",\n  });\n\n  const [show, SetShow] = useState(false);\n\n  function handleClose() {\n    SetShow(false);\n  }\n\n  function getProduct(id) {\n    console.log(\"inside get Product\");\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    fetch(\"/v1/product/\" + id, requestOptions)\n      .then(async (response) => {\n        const isJson = response.headers\n          .get(\"content-type\")\n          ?.includes(\"application/json\");\n        const data = isJson && (await response.json());\n\n        // check for error response\n        if (!response.ok) {\n          const error = data && data.errors;\n          return Promise.reject(error);\n        }\n\n        setErrors({});\n\n        console.log(\"Response:\");\n        console.log(data);\n        let categoryIds = data.result.category_id;\n        let categoryNames = data.result.category_name;\n\n        selectedCategories = [];\n        if (categoryIds && categoryNames) {\n          for (var i = 0; i < categoryIds.length; i++) {\n            selectedCategories.push({\n              id: categoryIds[i],\n              name: categoryNames[i],\n            });\n          }\n        }\n        setSelectedCategories(selectedCategories);\n\n        if (data.result.product_stores) {\n          console.log(\"data.result.product_stores-ok:\", data.result.product_stores);\n          // productStores.push(data.result.stores);\n\n          let i = 0;\n          for (const key in data.result.product_stores) {\n            console.log(\"key: \", key);\n            if (productStores[i].store_id == data.result.product_stores[key].store_id) {\n              productStores[i].purchase_unit_price = data.result.product_stores[key].purchase_unit_price;\n              productStores[i].wholesale_unit_price = data.result.product_stores[key].wholesale_unit_price;\n              productStores[i].retail_unit_price = data.result.product_stores[key].retail_unit_price;\n              productStores[i].stock = data.result.product_stores[key].stock;\n              i++;\n            }\n          }\n          setProductStores([...productStores]);\n          console.log(\"productStores-ok:\", productStores);\n        }\n        /*\n    if(cookies.get('store_id')){\n         //let stores1 = data.result.stores.filter((store)=>store.store_id==cookies.get('store_id'));\n        // let stores1 = data.result.stores;\n        if(data.result.stores.length>0){\n            productStores= data.result.stores;\n            setProductStores([...productStores]);\n        }\n    }else {\n        console.log(\"data.result.stores:\",data.result.stores);\n       // productStores.push(data.result.stores);\n\n        let i=0;\n        for(let store of data.result.stores){\n            if(productStores[i].store_id == store.store_id){\n                productStores[i].purchase_unit_price= store.purchase_unit_price;\n                productStores[i].wholesale_unit_price= store.wholesale_unit_price;\n                productStores[i].retail_unit_price= store.retail_unit_price;\n                productStores[i].stock= store.stock;\n                i++;\n            }\n        }\n        setProductStores([...productStores]);\n        console.log(\"productStores:\",productStores);\n        */\n\n\n\n        formData = data.result;\n        formData.name = data.result.name;\n        if (!formData.unit) {\n          formData.unit = \"\";\n        }\n        formData.images_content = [];\n        formData.useLaserScanner = false;\n        setFormData({ ...formData });\n      })\n      .catch((error) => {\n        setProcessing(false);\n        setErrors(error);\n      });\n  }\n\n  async function suggestCategories(searchTerm) {\n    console.log(\"Inside handle suggest Categories\");\n\n    console.log(\"searchTerm:\" + searchTerm);\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm,\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,name\";\n    let result = await fetch(\n      \"/v1/product-category?\" + Select + queryString,\n      requestOptions\n    );\n    let data = await result.json();\n\n    setCategoryOptions(data.result);\n  }\n\n  let [stores, setStores] = useState([]);\n\n  async function getAllStores() {\n    console.log(\"fetching all stores\");\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,name\";\n    let result = await fetch(\"/v1/store?\" + Select, requestOptions);\n    let data = await result.json();\n\n    stores = data.result;\n    setStores(data.result);\n    productStores = [];\n    for (let i = 0; i < stores.length; i++) {\n      productStores.push({\n        store_id: stores[i].id,\n        store_name: stores[i].name,\n        purchase_unit_price: \"\",\n        retail_unit_price: \"\",\n        wholesale_unit_price: \"\",\n        stock: \"\",\n      });\n    }\n\n    setProductStores([...productStores]);\n    console.log(\"productStores:\", productStores);\n  }\n\n  async function suggestStores(searchTerm) {\n    console.log(\"Inside handle suggest Stores\");\n\n    console.log(\"searchTerm:\" + searchTerm);\n    if (!searchTerm) {\n      return;\n    }\n\n    var params = {\n      name: searchTerm,\n    };\n    var queryString = ObjectToSearchQueryParams(params);\n    if (queryString !== \"\") {\n      queryString = \"&\" + queryString;\n    }\n\n    const requestOptions = {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n    };\n\n    let Select = \"select=id,name\";\n    let result = await fetch(\n      \"/v1/store?\" + Select + queryString,\n      requestOptions\n    );\n    let data = await result.json();\n\n    setStoreOptions(data.result);\n  }\n\n  useEffect(() => {\n    let at = cookies.get(\"access_token\");\n    if (!at) {\n      window.location = \"/\";\n    }\n  });\n\n  function ObjectToSearchQueryParams(object) {\n    return Object.keys(object)\n      .map(function (key) {\n        return `search[${key}]=${object[key]}`;\n      })\n      .join(\"&\");\n  }\n\n  function handleCreate(event) {\n    event.preventDefault();\n    console.log(\"Inside handle Create\");\n\n    formData.category_id = [];\n    for (var i = 0; i < selectedCategories.length; i++) {\n      formData.category_id.push(selectedCategories[i].id);\n    }\n\n    console.log(\"productStores:\", productStores);\n\n\n    let storesData = {};\n    for (let i = 0; i < productStores.length; i++) {\n      storesData[productStores[i].store_id] = {\n        \"store_id\": productStores[i].store_id,\n        \"store_name\": productStores[i].store_name,\n        \"retail_unit_price\": productStores[i].retail_unit_price ? productStores[i].retail_unit_price : 0,\n        \"wholesale_unit_price\": productStores[i].wholesale_unit_price ? productStores[i].wholesale_unit_price : 0,\n        \"purchase_unit_price\": productStores[i].purchase_unit_price ? productStores[i].purchase_unit_price : 0,\n        \"stock\": productStores[i].stock ? productStores[i].stock : 0,\n      };\n      /*\n          storesData.push({\n              \"store_id\": productStores[i].store_id,\n              \"store_name\": productStores[i].store_name,\n              \"retail_unit_price\": productStores[i].retail_unit_price?productStores[i].retail_unit_price:0,\n              \"wholesale_unit_price\": productStores[i].wholesale_unit_price?productStores[i].wholesale_unit_price:0,\n              \"purchase_unit_price\": productStores[i].purchase_unit_price?productStores[i].purchase_unit_price:0,\n              \"stock\": productStores[i].stock?productStores[i].stock:0,\n          });\n          */\n    }\n\n    formData.product_stores = storesData;\n\n    if (cookies.get(\"store_id\")) {\n      formData.store_id = cookies.get(\"store_id\");\n    }\n\n    console.log(\"Formdata:\", formData);\n\n    let endPoint = \"/v1/product\";\n    let method = \"POST\";\n    if (formData.id) {\n      endPoint = \"/v1/product/\" + formData.id;\n      method = \"PUT\";\n    }\n\n    const requestOptions = {\n      method: method,\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        Authorization: cookies.get(\"access_token\"),\n      },\n      body: JSON.stringify(formData),\n    };\n\n    setProcessing(true);\n    fetch(endPoint, requestOptions)\n      .then(async (response) => {\n        const isJson = response.headers\n          .get(\"content-type\")\n          ?.includes(\"application/json\");\n        const data = isJson && (await response.json());\n\n        // check for error response\n        if (!response.ok) {\n          // get error message from body or default to response status\n          const error = data && data.errors;\n          //const error = data.errors\n          return Promise.reject(error);\n        }\n\n        setErrors({});\n        setProcessing(false);\n\n        console.log(\"Response:\");\n        console.log(data);\n        props.showToastMessage(\"Product Created Successfully!\", \"success\");\n        if (props.refreshList) {\n          props.refreshList();\n        }\n\n        handleClose();\n        props.openDetailsView(data.result.id);\n      })\n      .catch((error) => {\n        setProcessing(false);\n        console.log(\"Inside catch\");\n        console.log(error);\n        setErrors({ ...error });\n        console.error(\"There was an error!\", error);\n        props.showToastMessage(\"Error Creating Product!\", \"danger\");\n      });\n  }\n\n  function isStockAddedToStore(storeID) {\n    for (var i = 0; i < productStores.length; i++) {\n      if (productStores[i].store_id === storeID) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function findStockIndexByStoreID(storeID) {\n    for (var i = 0; i < productStores.length; i++) {\n      if (productStores[i].store_id === storeID) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  function isUnitPriceAddedToStore(storeID) {\n    for (var i = 0; i < productStores.length; i++) {\n      if (productStores[i].store_id === storeID) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  function removeStock(productStore) {\n    const index = productStores.indexOf(productStore);\n    if (index > -1) {\n      productStores.splice(index, 1);\n    }\n    setProductStores([...productStores]);\n  }\n\n\n  function getTargetDimension(\n    originaleWidth,\n    originalHeight,\n    targetWidth,\n    targetHeight\n  ) {\n    let ratio = parseFloat(originaleWidth / originalHeight);\n\n    targetWidth = parseInt(targetHeight * ratio);\n    targetHeight = parseInt(targetWidth * ratio);\n\n    return { targetWidth: targetWidth, targetHeight: targetHeight };\n  }\n\n  /*\n    const DetailsViewRef = useRef();\n    function openDetailsView(id) {\n        console.log(\"id:\", id);\n        DetailsViewRef.current.open(id);\n    }\n    */\n\n  const StoreCreateFormRef = useRef();\n  function openStoreCreateForm() {\n    StoreCreateFormRef.current.open();\n  }\n\n  const ProductCategoryCreateFormRef = useRef();\n  function openProductCategoryCreateForm() {\n    ProductCategoryCreateFormRef.current.open();\n  }\n\n  return (\n    <>\n      <StoreCreate\n        ref={StoreCreateFormRef}\n        showToastMessage={props.showToastMessage}\n      />\n      {/*\n            <ProductView ref={DetailsViewRef} />\n            */}\n      <ProductCategoryCreate\n        ref={ProductCategoryCreateFormRef}\n        showToastMessage={props.showToastMessage}\n      />\n\n      <Modal\n        show={show}\n        size=\"xl\"\n        onHide={handleClose}\n        animation={false}\n        backdrop=\"static\"\n        scrollable={true}\n      >\n        <Modal.Header>\n          <Modal.Title>\n            {formData.id\n              ? \"Update Product #\" + formData.name\n              : \"Create New Product\"}\n          </Modal.Title>\n\n          <div className=\"col align-self-end text-end\">\n            {formData.id ? (\n              <Button\n                variant=\"primary\"\n                onClick={() => {\n                  handleClose();\n                  props.openDetailsView(formData.id);\n                }}\n              >\n                <i className=\"bi bi-eye\"></i> View Detail\n              </Button>\n            ) : (\n              \"\"\n            )}\n            &nbsp;&nbsp;\n            <Button variant=\"primary\" onClick={handleCreate}>\n              {isProcessing\n                ? (\n                  <Spinner\n                    as=\"span\"\n                    animation=\"border\"\n                    size=\"sm\"\n                    role=\"status\"\n                    aria-hidden={true}\n                  />\n                ) + \" Creating...\"\n                : \"\"}\n              {formData.id ? \"Update\" : \"Create\"}\n            </Button>\n            <button\n              type=\"button\"\n              className=\"btn-close\"\n              onClick={handleClose}\n              aria-label=\"Close\"\n            ></button>\n          </div>\n        </Modal.Header>\n        <Modal.Body>\n          <form className=\"row g-3 needs-validation\" onSubmit={handleCreate}>\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Name*</label>\n\n              <div className=\"input-group mb-3\">\n                <input\n                  value={formData.name ? formData.name : \"\"}\n                  type=\"string\"\n                  onChange={(e) => {\n                    errors[\"name\"] = \"\";\n                    setErrors({ ...errors });\n                    formData.name = e.target.value;\n                    setFormData({ ...formData });\n                    console.log(formData);\n                  }}\n                  className=\"form-control\"\n                  id=\"name\"\n                  placeholder=\"Name\"\n                />\n                {errors.name && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.name}\n                  </div>\n                )}\n                {formData.name && !errors.name && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/*\n                        <div className=\"col-md-6\">\n                            <label className=\"form-label\">ean_12</label>\n\n                            <div className=\"input-group mb-3\">\n                                <input\n                                    value={formData.ean_12 ? formData.ean_12 : \"\"}\n                                    type='string'\n                                    onChange={(e) => {\n                                        errors[\"name\"] = \"\";\n                                        setErrors({ ...errors });\n                                        formData.ean_12 = e.target.value;\n                                        setFormData({ ...formData });\n                                        console.log(formData);\n                                    }}\n                                    className=\"form-control\"\n                                    id=\"ean_12\"\n                                    placeholder=\"ean_12\"\n                                />\n                                {errors.ean_12 && (\n                                    <div style={{ color: \"red\" }}>\n                                        <i className=\"bi bi-x-lg\"> </i>\n                                        {errors.ean_12}\n                                    </div>\n                                )}\n                                {formData.ean_12 && !errors.ean_12 && (\n                                    <div style={{ color: \"green\" }}>\n                                        <i className=\"bi bi-check-lg\"> </i>\n                                        Looks good!\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                                */}\n\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Name In Arabic (Optional)</label>\n\n              <div className=\"input-group mb-3\">\n                <input\n                  value={formData.name_in_arabic ? formData.name_in_arabic : \"\"}\n                  type=\"string\"\n                  onChange={(e) => {\n                    errors[\"v\"] = \"\";\n                    setErrors({ ...errors });\n                    formData.name_in_arabic = e.target.value;\n                    setFormData({ ...formData });\n                    console.log(formData);\n                  }}\n                  className=\"form-control\"\n                  id=\"name_in_arabic\"\n                  placeholder=\"Name In Arabic\"\n                />\n                {errors.name_in_arabic && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.name_in_arabic}\n                  </div>\n                )}\n                {formData.name_in_arabic && !errors.name_in_arabic && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Part Number(Optional)</label>\n\n              <div className=\"input-group mb-3\">\n                <input\n                  value={formData.part_number ? formData.part_number : \"\"}\n                  type=\"string\"\n                  onChange={(e) => {\n                    errors[\"part_number\"] = \"\";\n                    setErrors({ ...errors });\n                    formData.part_number = e.target.value;\n                    setFormData({ ...formData });\n                    console.log(formData);\n                  }}\n                  className=\"form-control\"\n                  id=\"part_number\"\n                  placeholder=\"Part Number\"\n                />\n                {errors.part_number && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.part_number}\n                  </div>\n                )}\n                {formData.part_number && !errors.part_number && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Rack / Location (Optional)</label>\n\n              <div className=\"input-group mb-3\">\n                <input\n                  value={formData.rack ? formData.rack : \"\"}\n                  type=\"string\"\n                  onChange={(e) => {\n                    errors[\"rack\"] = \"\";\n                    setErrors({ ...errors });\n                    formData.rack = e.target.value;\n                    setFormData({ ...formData });\n                    console.log(formData);\n                  }}\n                  className=\"form-control\"\n                  id=\"rack\"\n                  placeholder=\"Rack/Location\"\n                />\n                {errors.rack && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.rack}\n                  </div>\n                )}\n                {formData.rack && !errors.rack && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Categories*</label>\n\n              <div className=\"input-group mb-3\">\n                <Typeahead\n                  id=\"category_id\"\n                  labelKey=\"name\"\n                  isInvalid={errors.category_id ? true : false}\n                  onChange={(selectedItems) => {\n                    errors.category_id = \"\";\n                    setErrors(errors);\n                    if (selectedItems.length === 0) {\n                      errors.category_id = \"Invalid Category selected\";\n                      setErrors(errors);\n                      setFormData({ ...formData });\n                      setSelectedCategories([]);\n                      return;\n                    }\n                    setFormData({ ...formData });\n                    setSelectedCategories(selectedItems);\n                  }}\n                  options={categoryOptions}\n                  placeholder=\"Select Categories\"\n                  selected={selectedCategories}\n                  highlightOnlyResult={true}\n                  onInputChange={(searchTerm, e) => {\n                    suggestCategories(searchTerm);\n                  }}\n                />\n                <Button\n                  hide={true.toString()}\n                  onClick={openProductCategoryCreateForm}\n                  className=\"btn btn-outline-secondary btn-primary btn-sm\"\n                  type=\"button\"\n                  id=\"button-addon1\"\n                >\n                  {\" \"}\n                  <i className=\"bi bi-plus-lg\"></i> New\n                </Button>\n                {errors.category_id && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.category_id}\n                  </div>\n                )}\n                {formData.category_id && !errors.category_id && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"col-md-2\">\n              <label className=\"form-label\">Unit</label>\n              <select\n                className=\"form-control\"\n                value={formData.unit}\n                onChange={(e) => {\n                  formData.unit = e.target.value;\n                  console.log(\"Inside onchange price type:\", formData.unit);\n                  setFormData({ ...formData });\n                }}\n              >\n                <option value=\"\">PC</option>\n                <option value=\"drum\">Drum</option>\n                <option value=\"set\">Set</option>\n                <option value=\"Kg\">Kg</option>\n                <option value=\"Meter(s)\">Meter(s)</option>\n                <option value=\"Gm\">Gm</option>\n                <option value=\"L\">Liter (L)</option>\n                <option value=\"Gm\">Gm</option>\n                <option value=\"Mg\">Mg</option>\n              </select>\n            </div>\n\n            <h4>Unit Price & Stock</h4>\n            <div className=\"table-responsive\" style={{ overflowX: \"auto\" }}>\n              <table className=\"table table-striped table-sm table-bordered\">\n                <thead>\n                  <tr className=\"text-center\">\n                    {!cookies.get('store_id') ? <th>Store Name</th> : \"\"}\n                    <th>Purchase Unit Price</th>\n                    <th>Wholesale Unit Price</th>\n                    <th>Retail Unit Price</th>\n                    <th>Stock</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {stores.map((store, index) => (\n                    !cookies.get('store_id') || store.id == cookies.get('store_id') ? <tr key={index} className=\"text-center\">\n                      {!cookies.get('store_id') ? <td style={{ width: \"150px\" }}>{store.name}</td> : \"\"}\n                      <td style={{ width: \"150px\" }}>\n                        <input\n                          type=\"number\"\n                          value={\n                            productStores[index]?.purchase_unit_price || productStores[index]?.purchase_unit_price == 0\n                              ? productStores[index]?.purchase_unit_price\n                              : \"\"\n                          }\n                          className=\"form-control\"\n                          placeholder=\"Purchase Unit Price\"\n                          onChange={(e) => {\n                            errors[\"purchase_unit_price_\" + index] = \"\";\n                            setErrors({ ...errors });\n\n                            if (!e.target.value) {\n                              productStores[index].purchase_unit_price = \"\";\n                              setProductStores([...productStores]);\n                              // setErrors({ ...errors });\n                              console.log(\"errors:\", errors);\n                              return;\n                            }\n                            if (parseFloat(e.target.value) < 0) {\n                              productStores[index].purchase_unit_price = \"\";\n                              setProductStores([...productStores]);\n\n                              errors[\"purchase_unit_price_\" + index] =\n                                \"Purchase Unit Price should not be < 0\";\n                              setErrors({ ...errors });\n                              return;\n                            }\n\n                            productStores[index].purchase_unit_price = parseFloat(e.target.value);\n                            setProductStores([...productStores]);\n                          }}\n                        />{\" \"}\n                        {errors[\"purchase_unit_price_\" + index] && (\n                          <div style={{ color: \"red\" }}>\n                            <i className=\"bi bi-x-lg\"> </i>\n                            {errors[\"purchase_unit_price_\" + index]}\n                          </div>\n                        )}\n                        {(productStores[index]?.purchase_unit_price || productStores[index]?.purchase_unit_price === 0) &&\n                          !errors[\"purchase_unit_price_\" + index] ? (\n                          <div style={{ color: \"green\" }}>\n                            <i className=\"bi bi-check-lg\"> </i>\n                            Looks good!\n                          </div>\n                        ) : null}\n                      </td>\n                      <td style={{ width: \"150px\" }}>\n                        <input\n                          type=\"number\"\n                          value={\n                            productStores[index]?.wholesale_unit_price || productStores[index]?.wholesale_unit_price === 0\n                              ? productStores[index]?.wholesale_unit_price\n                              : \"\"\n                          }\n                          className=\"form-control\"\n                          placeholder=\"Wholesale Unit Price\"\n                          onChange={(e) => {\n                            errors[\"wholesale_unit_price_\" + index] = \"\";\n                            setErrors({ ...errors });\n\n                            if (!e.target.value) {\n                              productStores[index].wholesale_unit_price = \"\";\n                              setProductStores([...productStores]);\n                              return;\n                            }\n\n                            if (parseFloat(e.target.value) < 0) {\n                              productStores[index].wholesale_unit_price = \"\";\n                              setProductStores([...productStores]);\n\n                              errors[\"wholesale_unit_price_\" + index] =\n                                \"Wholesale unit price should not be < 0\";\n                              setErrors({ ...errors });\n                              return;\n                            }\n\n                            productStores[index].wholesale_unit_price = parseFloat(e.target.value);\n\n                            setProductStores([...productStores]);\n                          }}\n                        />\n                        {errors[\"wholesale_unit_price_\" + index] && (\n                          <div style={{ color: \"red\" }}>\n                            <i className=\"bi bi-x-lg\"> </i>\n                            {errors[\"wholesale_unit_price_\" + index]}\n                          </div>\n                        )}\n                        {(productStores[index]?.wholesale_unit_price || productStores[index]?.wholesale_unit_price === 0) &&\n                          !errors[\"wholesale_unit_price_\" + index] ? (\n                          <div style={{ color: \"green\" }}>\n                            <i className=\"bi bi-check-lg\"> </i>\n                            Looks good!\n                          </div>\n                        ) : null}\n                      </td>\n                      <td style={{ width: \"150px\" }}>\n                        <input\n                          type=\"number\"\n                          value={\n                            productStores[index]?.retail_unit_price || productStores[index]?.retail_unit_price === 0\n                              ? productStores[index]?.retail_unit_price\n                              : \"\"\n                          }\n                          className=\"form-control\"\n                          placeholder=\"Retail Unit Price\"\n                          onChange={(e) => {\n                            errors[\"retail_unit_price_\" + index] = \"\";\n                            setErrors({ ...errors });\n                            if (!e.target.value) {\n                              productStores[index].retail_unit_price = \"\";\n                              setProductStores([...productStores]);\n                              return;\n                            }\n\n                            if (parseFloat(e.target.value) < 0) {\n                              errors[\"retail_unit_price_\" + index] =\n                                \"Retail Unit Price should not be < 0\";\n                              productStores[index].retail_unit_price = \"\";\n\n                              setProductStores([...productStores]);\n                              setErrors({ ...errors });\n                              console.log(\"errors:\", errors);\n                              return;\n                            }\n\n                            console.log(\"e.target.value:\", e.target.value);\n\n                            productStores[index].retail_unit_price = parseFloat(\n                              e.target.value\n                            );\n                            console.log(\"productStores[index].retail_unit_price:\", productStores[index].retail_unit_price);\n                            setProductStores([...productStores]);\n                          }}\n                        />{\" \"}\n                        {errors[\"retail_unit_price_\" + index] && (\n                          <div style={{ color: \"red\" }}>\n                            <i className=\"bi bi-x-lg\"> </i>\n                            {errors[\"retail_unit_price_\" + index]}\n                          </div>\n                        )}\n                        {(productStores[index]?.retail_unit_price || productStores[index]?.retail_unit_price === 0) &&\n                          !errors[\"retail_unit_price_\" + index] ? (\n                          <div style={{ color: \"green\" }}>\n                            <i className=\"bi bi-check-lg\"> </i>\n                            Looks good!\n                          </div>\n                        ) : null}\n                      </td>\n\n                      <td style={{ width: \"150px\" }}>\n                        <input\n                          value={productStores[index]?.stock || productStores[index]?.stock === 0\n                            ? productStores[index].stock\n                            : \"\"\n                          }\n                          type=\"number\"\n                          onChange={(e) => {\n                            errors[\"stock_\" + index] = \"\";\n                            setErrors({ ...errors });\n\n                            if (!e.target.value) {\n                              productStores[index].stock = \"\";\n                              setProductStores([...productStores]);\n                              //errors[\"stock_\" + index] = \"Invalid Stock value\";\n                              //setErrors({ ...errors });\n                              return;\n                            }\n\n                            productStores[index].stock = parseFloat(e.target.value);\n                          }}\n                          className=\"form-control\"\n                          id=\"stock\"\n                          placeholder=\"Stock\"\n                        />\n                        {errors[\"stock_\" + index] && (\n                          <div style={{ color: \"red\" }}>\n                            <i className=\"bi bi-x-lg\"> </i>\n                            {errors[\"stock_\" + index]}\n                          </div>\n                        )}\n                        {(productStores[index]?.stock || productStores[index]?.stock === 0) &&\n                          !errors[\"stock_\" + index] ? (\n                          <div style={{ color: \"green\" }}>\n                            <i className=\"bi bi-check-lg\"> </i>\n                            Looks good!\n                          </div>\n                        ) : null}\n                      </td>\n                    </tr> : ''\n                  ))}\n                </tbody>\n              </table>\n            </div>\n\n            <div className=\"col-md-6\">\n              <label className=\"form-label\">Image(Optional)</label>\n\n              <div className=\"input-group mb-3\">\n                <input\n                  value={selectedImage ? selectedImage : \"\"}\n                  type=\"file\"\n                  onChange={(e) => {\n                    errors[\"image\"] = \"\";\n                    setErrors({ ...errors });\n\n                    if (!e.target.value) {\n                      errors[\"image\"] = \"Invalid Image File\";\n                      setErrors({ ...errors });\n                      return;\n                    }\n\n                    selectedImage = e.target.value;\n                    setSelectedImage(selectedImage);\n\n                    let file = document.querySelector(\"#image\").files[0];\n\n                    let targetHeight = 400;\n                    let targetWidth = 400;\n\n                    let url = URL.createObjectURL(file);\n                    let img = new Image();\n\n                    img.onload = function () {\n                      let originaleWidth = img.width;\n                      let originalHeight = img.height;\n\n                      let targetDimensions = getTargetDimension(\n                        originaleWidth,\n                        originalHeight,\n                        targetWidth,\n                        targetHeight\n                      );\n                      targetWidth = targetDimensions.targetWidth;\n                      targetHeight = targetDimensions.targetHeight;\n\n                      resizeFIle(file, targetWidth, targetHeight, (result) => {\n                        formData.images_content[0] = result;\n                        setFormData({ ...formData });\n\n                        console.log(\n                          \"formData.images_content[0]:\",\n                          formData.images_content[0]\n                        );\n                      });\n                    };\n                    img.src = url;\n\n                    /*\n                                        resizeFIle(file, (result) => {\n                                            if (!formData.images_content) {\n                                                formData.images_content = [];\n                                            }\n                                            formData.images_content[0] = result;\n                                            setFormData({ ...formData });\n     \n                                            console.log(\"formData.images_content[0]:\", formData.images_content[0]);\n                                        });\n                                        */\n                  }}\n                  className=\"form-control\"\n                  id=\"image\"\n                />\n                {errors.image && (\n                  <div style={{ color: \"red\" }}>\n                    <i className=\"bi bi-x-lg\"> </i>\n                    {errors.image}\n                  </div>\n                )}\n                {formData.image && !errors.image && (\n                  <div style={{ color: \"green\" }}>\n                    <i className=\"bi bi-check-lg\"> </i>\n                    Looks good!\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <Modal.Footer>\n              <Button variant=\"secondary\" onClick={handleClose}>\n                Close\n              </Button>\n              <Button variant=\"primary\" onClick={handleCreate}>\n                {isProcessing\n                  ? (\n                    <Spinner\n                      as=\"span\"\n                      animation=\"bproduct\"\n                      size=\"sm\"\n                      role=\"status\"\n                      aria-hidden={true}\n                    />\n                  ) + \" Processing...\"\n                  : formData.id\n                    ? \"Update\"\n                    : \"Create\"}\n              </Button>\n            </Modal.Footer>\n          </form>\n        </Modal.Body>\n      </Modal>\n    </>\n  );\n});\n\nexport default ProductCreate;\n"]},"metadata":{},"sourceType":"module"}